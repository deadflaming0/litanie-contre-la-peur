(ns litanie-contre-la-peur.building-blocks.key-derivation-test
  {:clj-kondo/config '{:linters {:refer-all {:level :off}}}}
  (:require [clojure.test :refer :all]
            [litanie-contre-la-peur.building-blocks.key-derivation :as key-derivation]))

(def L 112)

(deftest dkm
  (testing "with sha224, taking 112 msb"
    (is (= "960c57ca0be8d23820d7b14b8eff"
           (key-derivation/dkm :sha224
                               "7c0afe78a0767607d3574f4d7c2fb4ce926c5c0fa444b5bdfa81aa54797f59f2e88fc1406e3745ebb5908fb1940db1346d135307aaee4a37e915b6c144a780650778479acef6dda2b57a125f9031c02eb050283654dcd6ac3d4256acdf22244d5e97d096b9d584d15588a0ff1f50ef8bcbb1c61caa0d8814e7c946598755ea2e3c635af371bbc336cb9a672677c7490068428cd7589584d1fa62968a73b431eae9f12ac3fd9e877017b8b132e2b88c733972720eaa9368e90e8d455b75ecad474ae289b5ce542ca7cf1b779141bce7969b44abedb1a4c403eb1f2a3c73d14e095c3c04b9456ce2b2536918a9c0e46b9b0b921a0dd3fef91e4d3fe76a1f564d62"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964acc52fc4b92d85568b602fcc0e6c963a14a34f"})))

    (is (= "11f4f1eddc6d37d44898e47f53ed"
           (key-derivation/dkm :sha224
                               "07cbadaa75f997184bc3549b40c9ef16d7f623cb70a9a29ae458e65c11f16fe6b935a4ca471dfc1a95ec7e7c96522402fb7836d8aac4ce7b8fa97f9b089ea231e9999794184aaad6c822249d35787e5ff25f56b12d29040a58df278ac9c4c648bc3415853db86066112fa8777c6e780fc0b5b4b38ddaf61e050a08139075962197ef9061ab2b706859b04e7532bd683b2015035351052d7b5cce682cd1f238f09043cf512633bc0de8fd811a969c13cf0815727dd2af0bfc7a169594491acb9d266212ef4760a65a2e553dde630270db615a6264aff1e5e52a92af87b8680752d07bce62ce67e6171e15733a195831cc55e08b38ccb19aedaccbf001e319b2f8"
                               {:L L
                                :fixed-info "a1b2c3d4e543415653696454b352ada4966a60da4c898912cada73fd50af"})))

    (is (not= "cb4e85c396fda4b128c15cb7e33c" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha224
                                  "2d5af14556673bc628cb9f5ef92f212894fbeab9362ca72bebe59e1df05f625d610ac8ba0a11fe2c535cb2454ecac5592bd1b76eaeb2de5ca11eeb4f39d0e5fb20b712bd898ec63e3704db968bdb6f4137daeeb856c46ee59c077e1e62af6bd63059c63b88cae6c51eb41036c6812580f3a49e856dc9307a7e5e1d66c97bd8bcc4250710e990c7e9e8db7a4fcc46d5848bcd23fd61645fdeff5652ca4e0fcffa4ec97838d9550fbde2a0aa4167fb0ea70ead3a3328e8c2d59225e1e68be33858bb3305d14e3fc4da68960657e12aa8fd5a0b4d294b59ace80a12fd03598e087096cdea770a790a1ad7da3afdb0c585e7a0706e87104a4b426aec4c1e327cc219"
                                  {:L L
                                   :fixed-info "a1b2c3d4e54341565369644ec2ee3d87f5f685d4e002377affb04f0fe459"})))

    (is (= "9d339cb73c61260369061c96fbbf"
           (key-derivation/dkm :sha224
                               "2fd9c8fad6ef4b77fa50151b0b382b3d0733f28aad04eddb404a13b1a8de287b08863e49ceae10b4662510a3b57306282b982169991e3ddf9c7c7d92c71b6d522a4e95441088196f5ff45a87b297c45312e323cf4d0db7dcbc31f0a062974ff2c934f8c9aab4204525432846b54f31cf0329c5c6a7b903e941ede98d38b28dd057deafca4bd85ae4865b7b9469370725bc71267da3bb4d8be0490830ee3705a62ddc79ed71914e1f651666a3173094b07bbfe0315fc62c9f2a75dc5fcaedd68f9f2db5f927c8cf3d40143a8d4491e509303a71a0a280dc95da0e21a9993369716e5c1c3374b732c3d27d3eff2239e434ea1f209b20c896628456994275f08a76"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964d68f32d48132a5a7c4710a5564d55259fe552e"})))

    (is (not= "de2f2a16e216297004a2e9e1eec4" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha224
                                  "2d5617589672e41eea39a83219715128d5f50c689b793bf8ebbde916427e17b96856c92649db5873881b982165da8fab50b0f1c8216e3f4cf22cff75b50dd47d2147d91053ada7bd12f33142eca91566cdb6c757df74c82badab1964dc81ef907d92c1fe887b60720807070c1f1a28bcd0e0022526171598d1a791323b83972ea645afc7664aebb520e478da1925baeae2dcc3af0e055e07a825143cb3af7a2e36566852309d5f85e3cc81d184d763b3ea3687f9b0827a200bf188d8bd0ccf0cd133e1c8d3e038c92368663f1d968840cdc211d0c4c4c05fe4e26aaad8c48e22cd834479ee4ad775c5bc20659555f4048f5ec4c97202e8402042d1dbb9d2258b"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156556964c0525e228ecf70957c7180b94f7b1df4a79a8b"})))

    (is (= "034e80c8417f598aa4997b317ccc"
           (key-derivation/dkm :sha224
                               "688ff6fbdeba8998f2e1a5f0e9178928124fe60f725273acd1e7035f6163d697c11f47881b8dedc1d305b730fcd95b11d346c59945ca74d27be635cca68343cc04becdc1bfc9c83bf14241df0431abd20ca4fc9f229c1dc82c4001c5a60c1aceeeb28f9ba9d872346d7a1adc5341d003632df028d3af0edd0f54623fde9a48eea0bbf026d5790b4335e662a1b4fa20407503a51762728714639b9deacf3741ba14aaa68f5e993a062f847cb26889dc96dd44dcb8472d5a2b38fdf19c8f63e0aa6e270bca27d9cb1180ed472cf336ed756901e603dc077614ce82bee268b3a6f5d93ac1da9d9a1adfc83fb0d497bb40cf5d87964f5ea1701c6c46f51363e32d98"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369646725e955d8252df7e3772681254d0bde30078d"})))

    (is (= "015a6f56d547465d3320304a36f4"
           (key-derivation/dkm :sha224
                               "0102cac3468811c0704cfbce43775fc42058d43ee2e42cbb9631f8ce977df74d30fee779a2ab4ca7a946c575cf74f47212e04c9c7c938551194431753b0a9a8dd79028ac967076bbb84df23a5d2562232d42f19f8d8533fa15d20d5ac0c03a4ee46b0609ae35a0dc0a2b7aba3de21c51d2dbc53ee91dac7e30d603517777e76eb6c18592337c374fe014d42c3e950878ca4115a163fe0995fca2f9f8d64dbabb96a9984fd10cde9fae6dcb1f223993ad019157015b8de4612abe2d9dd39487e1de7c6f456b02e2c905f795d506373ef5bab3405ea0e67e8db4d5b2c9733effb49a5bd6e0ecdeba678ccfc7b07a77bad59ba09b7ac2f70f38c8fd073802389c12"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964e2fc977d57181ab4b43a45ba49c7ffaf467b20"})))

    (is (not= "2255f9a45280143cbba3ce47436c" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha224
                                  "6779fabfff47e84f1bc99522b7e786e05e1e60d69624bb6d26dfc24ef87fa57d1d62bc608064687a00aa9b1b2b7d98c2aeebc34b616c0dcdbc01abb8a157808d57e2004817c47d4fd4d0cea3d165d679164b7ab9e5e9c4e2c858545bfb05d50ed939cd0b46235906b7cb69f4d29b06977e3e938c7fbb6e6600c6722ce18eb87b357818e29dd77763bed7f9efd8d0fec59020739dfb2e561bb5c2aab1ef3e76187ae10e5720640879d52e627f840d7c7f60ef7ba1bed42d52f4092d3720a076272147072c4bd9947741c33a66511b28c5edec73e9bc84f7d4ae8eab150cdb12042ebf5c25ac68dc957688f2c632b7affb91e478cebc49e146902bf69752f51af6"
                                  {:L L
                                   :fixed-info "a1b2c3d4e543415653696432afaa98a1bdaf3213e5fb462fc5008d9ef24d"})))

    (is (= "e1ce500b29c34633568af95e4cc0"
           (key-derivation/dkm :sha224
                               "06ca444a819dd96a8ff2aaefd540cee712b986a7b7a1dd9fed6c280116f095557e42f70b3d145921645c2f712c03b083273ae68a1641a4606b0f8d62da0310262783a4a0ccb3d3db53b84b3109e0385699a2a6da669a24eba48c9063da97ec890bcdbd53a7b7c62429a56b2c64fae5d1cd666a1b733a7106712c15ee269fad0337af9cbcdacc0c4839753cc1dd37c300f81e0c9e0a47fc7689d329aac24ede716de36683ebe523fad7da8010452186986cea8d1123e89db304c344116c3e9b2ae973d46e8fcf6151f6268ae52d3a3fbd23fe9bd7384f7fc651a4211d50977fdb9f7024af8b46253983bdeb4142a20454b00c5127e09b1cbab392d4e9a5855a68"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369648ca5be75c0408d6de2f45e6dc7d54b38f7dbba"})))

    (is (= "f757283514df4766f04be7d6542d"
           (key-derivation/dkm :sha224
                               "90b7df6f18eca1a3e98a3b7c0f2cb19ddcdc5e5ad3cc514f8e797da39c17ce118bf160b80a50ca66450dafcaae73f175190f9ef63bf1d398fe76e6d8e2fff2551c984a9ba01251be9e80ee4118287968a7a948ce21983f079fd180bcb7bf48cb85250b136b50f3d29464c01c3e53a478e1c09d2b1ca8ddfac626df9ef3f4050ba5de6b03b426cfc1bc55d9b1f8fc4cbc0f726a4f09c5bab2ebd77d0d99f71e565bb74fc753ef9707d5d70fa22d41d65fee8f6506c7793b01fbc4689200593a17c42879d29637019412a54482b1e8c5cd30058c47707760db9ccdfe063ad10d404deda55f50ba8671ee9d10b91d76ed61f843aa99f5ad336049f91baecc75106f"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369648d5d83029bc1f02d07f52949a39917294141d4"}))))
  (testing "with sha256, taking 112 msb"
    (is (not= "ae6dacfedd75234df7823c3fb055" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha256
                                  "6c72d1f53de4e77d370e86d4880ecf4b63f912cbf2c40a615ac3d35ae25c7094da9b596e23a7f5ffd10ff262fed3fb34b661b31bd08be5897e9ea0bc83b7c47fb34e52251223799810c7cf52c72b9afb8c2c9b44fbb5000315de59b6458e2f6ab8d74af35b76180620165a5b6199b829cac57136fc57d8ce1881747177df4421d1a3ea072bdff3f8bacc261f4fbb138b94e37a337c34f3315992e31aabd5c7ee800371c2b7fa60a73f9a3941d7872cf7c312ec0043630647b3c4b77e7729f4aaf79c53d7b74c2c49c2d4b8b9cc90ef6de2f291e35ea94780243b97d8edc1340573ae7e3b863c4b878056ca97d5078fadace15f8a2586451b6449eee28600d419"
                                  {:L L
                                   :fixed-info "a1b2c3d4e54341565369643516ea36674936e5e66a38ede17b3b80975113"})))

    (is (= "0a042bf6885acbfdc28924df0a37"
           (key-derivation/dkm :sha256
                               "aefb41e860887fcd4a3aa16f1a1d82136397b14f8fbdebf68787e04751caa4b1a0ce57946918592c25c8261b80a7a85c3f2e6c1e3288e005093134c212d3797f11fe77963a6c7c9c93a33149db1219d0744fc0702b56b29e8c1b7e94305aa8d3c68401cae1d31ec6c727cd2b5c58e6adacc65850e4ac320952ca31402344e361d5abb282e78e396f3a89efa416392fa99a12834e02e1ff5601bdde48c333405ae40daec3814246221378af3d2413626b53777409ccbe706bcb4dcf50208b2e4c895503f3ebb534b197e17abbd9db2e85b8137c7f4928b884ea5cbe3a25d3483cebe252caeda0004aeb5b32721841ed4eb7c794246c03f6ca0907575215c27955"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964cdad953679a8e2d06304c39232993cbc36483d"})))

    (is (not= "61c48619e4ae53fa0234562114a7" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha256
                                  "85f9bbe0082ab3d1693651c93ba583450ea3080afd3f1d00bdbbfc6868ecd1d208f6b1744f1a8f11c7b4b33071f41e46461cdd5630f57082d2327c65f5b1ebd0a4ab13e9c7270cc78d0eebac6542586a4915b115ffe2a866473e3b95a1198adf7411e40cc4bbe8a4690d29ee556337bbcb50a832d0c3a8c4051c3c5600b268f657834cf8d4e2515deaf547f70af7d9027f40d2b7c95a16fe0888a3558cdad60bb0dd5057348ebb74865f70ce56a8e4262eba8e866ca6975f32b603ee8d474d630cb2db7740f1ef2e77711c909d47304727ec26faa3ce30a9385c327a19593edf3d29d132fe068403547f0ac370752f0397aa486876d20678a7ae99ea2e023963"
                                  {:L L
                                   :fixed-info "a1b2c3d4e54341565569649ca417ca784bb09885fb56c3ed491aa8ea97aa"})))

    (is (= "582df4b67baa226e84ed8fc11e9b"
           (key-derivation/dkm :sha256
                               "d61fe09dbf69157a6fd09a8687e5d68774b1cedf6c823def0889199fed11c73ee966c1a582710590744d905656b13356b1a337c2099548e37a3241771225dfdf5680ef2db9c41f8f0adf9cebe8010a46f45be9e85aa7264c190208b4f9862e7b7df69c31ee4132158bf3c391f313bcbb2b6bc4b6e76010e53a35e94894666c4e4dde4c14dca71235269633d11e3d06e9c73f30f9dd45b1410d88273e434b8af799554bc713580201cd83e59639a286e253e621e208386903f900ac9d645726ac8147d55a577a46a92521f24b73074179cf30196897950ba8b2b8a2928444e2352de54bc52f44e86155002e905ba18c87fc944a8a1e06219264ddfee556b73edb"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964a8eb8150221c49255997bd5c3aa0df7e7d20c5"})))

    (is (= "44c986a322e205bb8a3fc7d047dc"
           (key-derivation/dkm :sha256
                               "06da119269bf2c5e012dc8bc9f2ae85bd18b717593df987f16645340c9d62c9993c619162f924457468642a5eeafcd81c45966a684281cf9f40c055b539ff82cd841562bcfb6e0c73b5d4f2a0eed0f34f423f9109352187ebb14f81fc1219fcc1a2244c81449c1670b6a689945c2912c1c67248957b84a4a50e25f7a61bfd5a890bead08958fd4b173b13f152ab2eb44a3509e99bde4660118249f5423ea459251dd6321458d38afdffbe7b8f2f178bdace0dfc1a6308718e46ada33e9433b5fc0e19596f445db190615d940d2e2ea8c6f5a7f0c132bccc80aa68024579a5bab68579f27b0e37d010a85376630d284f992478cf789e26a491b0cc7aafaebc0a9"
                               {:L L
                                :fixed-info "a1b2c3d4e543415653696472871b14790b033d9919d035d63640d082fadc"})))

    (is (= "8ac04d2828963db458a18799082f"
           (key-derivation/dkm :sha256
                               "414d3446cf556180dcbfffdde2ae40063dee3be2ace839a5079d8bacddbc8472abc433e80c78f2095b51f40a920fce1b29d9ea62523b0832b86f2d5f673165d7487753ad49326016262465ad48b3d52e8e2856761bf56b15f065fc46a30c73b9560f81fceae8e3562d1836862afae7104b8f1e5ebc62f086bc89449d412eb2b237c6524696478c78794d85ab6ecf6021ff8cacba68fe188334bb394b59165886a3e8ddbff758625adc3d5e40e3f93aabaa012896afd3d854c3e77d9903bfb64a3dcf4a63f6c013dc27b3a49364f46edb49bddf4f38fa075be2bbcf5b465b95b1968fd0884a9038eb6376381289595d22f81a1cdf2bb7cd146a1dc13e4f7158a7"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369642d471a27a0c74dbd98f4cd6b45077ed4cc69b8"})))

    (is (= "ae9b7a8576a318147bf91b721120"
           (key-derivation/dkm :sha256
                               "68e4a4150524e1162edbdd8f735743278a488fb44f32e8e0c07384c0f7e40d17b574fad08e15350442b8d3e6bef8449827b4093a52221408b4340bd121e47859873f2ba2cec77b10a18913f07a48fe81ebfbb265a15b77c09969eabe02e168e6f115f78a9d5625c3ce18dff8c2c2d8de47fb5c086646d11d3c380dc0c088e0f4221131658601db66ec5f99ad0e76926939154aba1b2f4d2e4b7310659fbb41f1095f86b24731e0f69c39b2214d7b8072ccc6cbf9ec03995c777a056e58a064e8386ef12a820cffe608d87c3bbb7f050c7f93c258686e782ed55cee3d2dd90e3a12dc67f96591db306b69e798591fc9a3a8913670ee9f5254ca1782a58890e27e"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369645212c8b2025c20507c301c2fa0bfbea08b8422"})))

    (is (not= "31887e03f4c00737f7dccfe07e0d" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha256
                                  "000e888cefbe28e203e9adf83951c0bde3d5fbf07ae18107855d06ded5dd82cc7287b4cfa1cadeb7cf2bcd1b79ceac9c611dfaef7d01674690f74a52351f0f0db9e1c502e63c3f419ff3b72cda181d242a16fc62cc2d01975ed5fbe4e338a74375dae77dd7de1cb74854be0dec387710bed031946f9db1eea954706efadb07d7cf2d1c88d365dbc07b8010a4f87c347f2dfe259658843ca1fa9fb2cafb204b88bb6bd19f738bc5e405a868204fa426bcbc55eb1fd9840098ea0b2e02b7685098502007fdeb7736094f7f7940ec6e3613a2ccbaa8e0850c4888ae8e37d4e676406321194467ea9180dd52c7e8e9c392a32add374a1bb8c88417ec35b56df20806"
                                  {:L L
                                   :fixed-info "a1b2c3d4e543415655696433eb37284baf0f7a04b2b9a451af5458e619db"})))

    (is (= "d5978bce0629e9caff3b687ac269"
           (key-derivation/dkm :sha256
                               "0cf3053f47428679c7af4cc534e123b75416d8978b50d0026f2fafd5f10c3be47ba2d9cb69bd78dc82012781065cd51c733bf4bd5de4c47ccda8afb0af9b338ddc03fd2abeb12a5d4d65df089422e8298d2374ab755c2c0b431d2333bbd79c10932987ad60898a8c208e01fcbf0f8a2a66e6789f77f2c301f026cd9faf1ecefc3e2c678f024e32fc0fd3c03c24746627fd7b4f9679d2719732a3985c8c31f2dcba2ca09585b75b508d5be0b3bc7d6dcdcf8c4a296ac1591b3c81fc52fa06916e7800c89a447d3692e0dcac19101be99452e133a7a8f1f2059a8dc574dde600ba1b442bfdb5eaa18cea3d64a30c67275604a494f67f5dd5865d14cba64e0b0b9f"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369643735ebafdd51af5b3288a5dfab4c0cd68aa94d"})))

    (is (not= "a1b7926c9d9ba0215808936b367d" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha256
                                  "f123184ce5cf2483f4c1adbf433e87b138c75e03bba395bcf4d3264e561ad40d202bda230a53cac46cd4bb75ea3f09cde55d7dd21ea12d3ec59c2b42be5d65c10234606e8ef32377eb86c678aab2c66ea0c1bc82335477464f577e9d2c9f9f5b4bb10734d3a456cba428164a56a4b8ae3cd4ec03dbc0f051dd9afaf7ab5598aa8c1d38f33d98465ee916fba0bd788dfe3b002b9cd36c5b1ce4d7ec33490490ea0358e2b2828cb16849daa1913bbe184980de5234f4205f80d361052ccb61bb61b5f0aadb7a15c80be9e0b183da13e55e73faffc0ac0beda7d7ceaf7e6865dba50cfb4f2c274427f9f06f9e3c69358f4dfaaa1bcb737dcf0f144574945d7b48b1"
                                  {:L L
                                   :fixed-info "a1b2c3d4e54341565369641efd49df20016363601facd55d6b3ff7a6c8c0"}))))
  (testing "with sha384, taking 112 msb"
    (is (= "00371eae480c9b956d47b7be521c"
           (key-derivation/dkm :sha384
                               "83455094749d6b08b497033faaddb35ed7ddfb1cb93409fca763fab92f000cbb3df02eb8f4339432216f3067ba97a0f19a76142c64574e19f87d29eeab8608c9a77283e673df0fe5400c492b3fd4163a0d4c1ee821c462254b9ee875584eb425afbb0c51d0328b53bb8f41ce985ed163a6c9abe45abfec098b287a2336b820ea5a9e4525d0b9659f622fa3075c77617ec349ad16c33a5c992c365dc2484ef280547cf0f541d522511b7891aa396d5ceff1011a2023e2dda366cb93bf1d5cd9053dde61756ebaa7500c2c3ecd14fa69b6fc8f3e5d3452d9b44448061511a62d95a75052cf0a3c6ec93bb193d509f988a493fa770ca2283dd4b5fce903d6cb744a"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369648bd04740a9218ef9194217d45948f4b5934738"})))

    (is (= "b68b424f26c20469dc6464032ba3"
           (key-derivation/dkm :sha384
                               "37be0ed6bec3be2127ea19c00e0d7ef7c82e27de4786f99f46d4b48eafaac379572d94bedbd7433d68a55f8ac2ab0eb44efab776082386142043422ed748eddcf2b4153b59746b59b9fdc8b7ebea00c0784a33d837d986c01376f5d6bd3cf88e488bcb32812ec872a981407682a53ad6c1dc0c377d0923963c4b98491ef631b2090a27630f558dbf94d98de8dc79dd25b2ce5b88df6a787cc2356b3aec70cafc5ea2120da66a0fab60a749593f7c311b7da407338ed1b108197fa3d9d57ccb239c47416dfea790ee413a90c106a5a0db8f9949a8fd102ac811eb2c7015f59178a092a9dfa709137d948503b07c77e34f4c9aad54c9e37bf214bd1c11fabf926b"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964f2e9bc8af912c910a3a3aaf3aabe09032e522a"})))

    (is (not= "6740bc458a658c6b2fb535783ea2" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha384
                                  "3bf444631efe7c91808395467519dd69748ad642fb7dab244d92be48e31453835f92d9d1452a19b042a9ada925f10a8361b3196b7cbfd4f29a2ecc16daa6e74866371612fec0b4f40ad427e0a8d832bdbc45e967ac90cc424863d5cbef0b1b607feac08544290c848623932fcb0137d01339e2ec0057104e3947de8e0d3d49e38ca24df57f161708a634cd24fc0e3d50893dadcbf67e6e2b2feb7502e94030e8722d50cb11aa9b83143e25d06415e736f4cda05df8c45ec315613903abaaf3d9a6fb5675038c7888b04503b82a10eec1c9eeeba09adfa4076a6c8b1d9a04baae2dfcbf5194d2ab253e838d94b1b6f3801c1f8cbe72a533d89fb22d98c0662e7e"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156536964db9776104e60f640ed379a2032fad424506781"})))

    (is (not= "5e920c1f75c3e0a6d5c0e5075166" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha384
                                  "24bf793bbdc47b6309b0806a704bb8e2048501aafd98b688eac239c3ba138096e5908c3f82d4afae078cd7ec9a3deee521456f03fb104268c82f4968acdb2bb5ba607b107f39ec98def7a32dc06ce39f6dd50cd2a542b1e00339a6ddf7e890ddbb36e1e91800692cd539b8d477443d36cbb435bfb53e2c81a7c951fb2fe629ae1fedb406260ff7e1f2e3074ae0f30e40af5f0ea156d113b3c6cd632f86f6c048375f67514df5eab48a02c2802ab6d9b34c95c49e7340f939b4e37a1cc9883fda99ea936f37c82b5a49f95c7fc1f203a8aa5cae877e4bf8206b9ea9331134303ae1b5a091dbb7dc16951c92ff772652093fd4829e0b4712a607b5d5d64f94d2c5"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156556964876d6fb999b1766d63dc947567bb72a4bc5903"})))

    (is (= "bc46802323536161c39b80001a31"
           (key-derivation/dkm :sha384
                               "0728aab5769ee081ec0a3db71957d9844a3666ac5f1b30901712ec5b65773bdafeba301c3b0ffbbc07ce0cec803dfc81f26362ec19518ae3beadadd83c6766c733297c8491438fc86b3e9109d1bd6f8512ef87405589127d7d7358dad7c8314380c7f8766ed535012453265f4bbbb3df5a36c819e490d5f708969b9b27798f90cd6174beb64a0fc08d267bd31ff8cafb7c56f4c0aa913a34949633b795a8255f641a9bfb927e51d444bf33a559d5045858e7bba7ee99397104a09dd6e31e042961e539ad99aec1da7cca763be380c1ddb1d13142a517236918371d9ef2edec746828c34c1d34d43928d0537e534f8c53389eb0405728ff08a1c1147f019d8913"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369641d4e1df55088398a14ee2b88e466569361549a"})))

    (is (= "bbefdd66e2c97c53a665c9fedf0d"
           (key-derivation/dkm :sha384
                               "89178fe7b56e73b10d45faaba582622207bf563d42d066c977934eef50cc78bf66066c511f3caaac9a9222b53caa57604f0b4914c59faba3f8fad7808c6800f594119cf9be0840e5f342165f17919292c8d247360137ecba89764330ad81c8ca6af06044b3aecee0b4a5cbdd3d05fbeb008b0f636b636cf04f634756cf85c8f72b80a083ac7706f7ddae2ac3d7dda434f70fbc4e9a5d8a25389814374be1d108243c48b3734704342a9e62ce88fb4addc253a95e322817c4a8880cd38421c0d10fe31649e3149785423a31797477f9811055293cf99674888efde86dbf179e6440496ce46282774570ab3982f7e69d6cc23eb59b8105623fd2b1700ddb67be4d"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964f26cc0af8bad1c80adc68f25fd5c7f8595ad7e"})))

    (is (= "8379d13c78868dd443ad1be15ebc"
           (key-derivation/dkm :sha384
                               "7283d3d92c3ddbdd22005fe3bea464dd50b768deb75750c8affefa8dc0fd20aff7595d1361e67f3f797ed177bc9c540a7699db3c111ce682d62f1cd3acfa45396fd50784d38659d0d14d61c2cf2f715291dad4cbc7bb7ab7bd969f8b25fa541dcf662c51f661c263751d52e15b6c189b108a7f3ffeb0367d2048865cbbf236b4731460f6c01546807dc5ae00115558424820fcb0cdcfd7c4545b994740297b52cd191dde730ab9f6dbecffdd4e8d040b9526c9ec0b8fb243029e2e967c8e6021de348956a5f8bfdae9d8ea3392ff3888db7682b94ee7398231842ca25ad2d630cab1626f72ee8c078cea3d8b19f6c44b47f57ff0a8e7f1ed8893b445af2b0da9"
                               {:L L
                                :fixed-info "a1b2c3d4e543415653696484bc009cfbf6b1a9b275847e8d201655a92b17"})))

    (is (= "f2287bb99f98a95aee946110c5b5"
           (key-derivation/dkm :sha384
                               "0e61575d18fe79b197642fe58453d9ab3797960f4e56e7ee8c5c76447ca45652f6b01db2f6949bb83a742e973100714043545f69708c0129a397039e5f6ad0462772e1d967f532717f77f87e605ae2032b7af13980613ec30d6595982a5623288e9c52733cf30c761e59a33c9e5d3be4a4238502239d70cce3e06640c9cf9bac67e5973cb0e5a8a9fec2c3fb78115f7a261dfe333041c59e8480ee7ab8e489d2cd490a03d8dc96afbdb08549be7e404ca59de962c99e75fabd7d87ff139b5a0effb1863f2b1750bdf3f36c992d7edbcd6365af6ad4fad0c3fe43eaef04b6c325d4af9990b7012a1789686e02de504caefa988947611872f69d414064c114f9b9"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964668df9fe41f31dcf5f2a03b61501d19ac32df3"})))

    (is (not= "5ecd167326b00bc0ff0cd9929d53" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha384
                                  "343c8f79635bb373870b3fb17de9d460dcac808c814c60635f0fe018fa48f9130fb2f062b131b610fff7337c6e088bead134a781b75c9f8b73e598221c0b9266ff696db0e785331c785da530c2e4fc5c3ec696d31a3ed8b0a1d126c7f6b20048bd1a933e4e3deb90e2b7a473f57f605218e58879350425ba4a408d57a80e41417a184d8d8924e0b3bec87eb75783a2a7df96ee038a21b463027d265e364ca450f3a4325258b302e5244b1264c4894d655861552d3b77ba269d7730ae2652a3a570b775106b906ceb3e379f2f137d89825fb87fc6215a603bd18a3e120201a7ef256840d7a7a1b89b89a58d78ec6931d6239540bcf2e8cea254b14a6c5cca5273"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156556964271d184749c249910dcf5ced7d3351e84107b0"})))

    (is (not= "73fab3cd9cc7fd7cb0cf0da37224" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha384
                                  "31fa4ff5ccbbd2bd001beb67d4ab433f08d3b670ca2034df947f24f722fdc71ef156883b7290a8e624751a3768bdb41e00b031939724265b90eece143db8fd6a831d737cc308c352a32cd4522d8630f5337821c0b184cb50e1a50253bdf93ef270097f7fb366a98be5b5c3ecb2f308e5e03b6ed65bfd9f48171d4029af89fd1a0f34d5804bb33a787cdad79de1531b497ad46aeaed71c0e1b5e74573d8c5e8b4c92a3692db9ea1aeed7eccb2df430129af90aa34fa76d1573a8d938b4450dc56acb3af0b9fed9ad530d77d7ca7e813874ca49f6c7d9933923385cf3b859e33980d5d04235aebdfec4015f6152c92bf0f6b811a01d30da7e14aaeb3f6481a509f"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156536964899da47b25ca62b364989484f6090816b99522"}))))
  (testing "with sha512, taking 112 msb"
    (is (not= "a2188fe6c80ac9f8dcfd1f4ea449" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha512
                                  "ce7b9f7cedbc6ce21e906157eb9dad882957753e2469f637ab827e5f307aa3bddef94951bcee1e5fd858610ab4c03d894fa5b3a986d604a5812201bb230df99d43fd996a35a7072a0b0d7aab44865b6777db67bf4dfb3e88d6d3b6fb78e59ec17219565d912f250d75f4b3f0ebc46b10644442a36ff1baabea5de14064accdea9377e71682aa095fc237093dd931e95059e237192134dab179dca8956a807cde437bb64edcdf1baf96ecfc517a9fd9fd07be3228aaf5cad58a02d275dfa66db4051bc668b2427e838514f989cc521322fd6e8dc4c228d9639be5360310da3e9ed4ba25c53b1d22e0c19f65496f591c7839064401f54a9f3148c75ebfb5aad7cc"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156536964d41f5791b09ee40c181d831f506134d8ff0476"})))

    (is (= "554ec2b9b8bd1d12b1bf18217dca"
           (key-derivation/dkm :sha512
                               "05ec8487a87fc9134ce7ce879335b01ae921ca82dd41cd2ac2c54b6fe582a390587f4d3accc7e7e658d129018a7b08ca099d194aed7cfdcd4540e99253cd464c40e3c55661a0a2bbe83437afd3c1864608da2edbb5309d9eeeaa13410b0d69e006702dc70a6905909fe931420c51e14aafcb0103aad96d720487166092f2c10ac0449e6b24eeacb66029067ad7cdca0151402e1920070fa76062f99fd0057749dd755689dece6495c876efce9828862d244c0f2073a761c487781251686de0486301eb138e1fcc90f4523ab1c6b61fbd9885c0b2090e8b1c8c5e6967ec79e4658934910c3606f6888d1afbea65e6209524c2af81dc3941d98598bdece6799590"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964c22e560a156c35e464274918bc8923c15733f5"})))

    (is (= "2571c9d5be282198df455f9f5600"
           (key-derivation/dkm :sha512
                               "4a069f221551b8713a7c8fec77b322e9ed717b271897545f77623dfa29f7f95c4f08debb7380331c9bbeeeb955ca2fbfbb801e275255c0bc2095d0da2cfb32adc3ea52f35ee860829f6af599624f5bb8a0b4d002f3236035fc88e70e7f35ca247a41a21d94801f8b07d9f031a856a56e3303b1294cbc12ba22e9593e43d0d36acece442a4617c979d63626bc7fc19a911e0775296a07693f8b3f7f51f94c25e0146aa32cf3f579f67fccab3e43abb84e371f291b03b21c144811545840114902fe32f45b4128b2abc34011f406824aa4837aef92c3f49bde4204e29cf6a1c2519f15304ce977ef33f8bc2283c8cfa0459b8cc6edb91eb59b2934ca4eb433f4dd"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964546660518f9282373ac1a9e8f65da7bd4c1c67"})))

    (is (= "803bdcf9c936a96b95c5e68587fd"
           (key-derivation/dkm :sha512
                               "32468b5e4a7994b9f96ffb0d9d83045fa753df00ae65e968f271a675b555dd248527d5840a4741985989b043e342262fb78d50d17b89993d1c8689bde2c1d4e8aaffb991a84c6c02b77c0956cc03041c7d531362905e676acf2269ea9643460cc0065e80ab18bf8a3ea7d25a56118dbf1df5d466847659cd79ac0828f73b0610d28e5577bda317dd9f8b1a1788cceecfbb115401b89337a6e0772079dc71de567d0ecf1d894a316f74583f65458de8d777932ec1778180da10e02e476813f8133d37b58735a5c0c3392f7fe3ea968f957ff3286a18aeae128a7b9033893fe57cf65235c860447a06210535838f13e51a5d8093f8143814c8f7c2d136e911c45e"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964dd4816b0411dcf1698be373e439c4a41c2bd42"})))

    (is (not= "e6124c8fd12da6e571ef8e919e03" ;; > Result = F (7 - OI changed)
              (key-derivation/dkm :sha512
                                  "2a220c6c3e38b7bebe719cb468e7a7cd5d11414aee9f4b98d59b1489a39e42f9907708a28f1166ad82f769817c7e7b803a95f3b2e49e11918de427db640bcafec82dd5fc22e2bde728ddab3b01747a5f641e4b5b413fe0725a28d91eb44698e2ce391b3b30be651903626d31efa8c60fef8169e11e653d4c6a9eb7f8bb07a382f0715ed1a64e5083c7303ef98e2d0dcf81448640d01eeb8238bd74bd24f886f13344bcabe5e95da74511308ed4d0ac7e84840370c837d91631661858e1579c36fc5bd60beda9a827d611fd274a39071db69d6e66c5f2874b054a09bd29eaf9fb636e03c450e6d73a0ab9e35deeea3428f3541560b9182bf2025300fc64fe1440"
                                  {:L L
                                   :fixed-info "a1b2c3d4e54341565569649d199e91e45ad923a00b5355739bcab441a879"})))

    (is (= "0632a1dc0016dbbd82e37fb8e5ec"
           (key-derivation/dkm :sha512
                               "b1d27b22b6f91e4d48771d79f8eef23f6c3add9162c3c7ab261bce6d5cbe1f615c47aadd276e5ae7e7b07ae5610c02221ccbc8c3418d5807fbd0ece7e6f39a8598d96ebbf2a4eee543819d015fc5551c96d2795ed7edbc902d7fcca65e4bbd49a1db97dfb2fbe029fac70900773d3e051d3e31ca717a6430aa6840fca36edd00a2ecfdc9d88b5665b6aab4ee6781e8c524971d916ec60d0e8934e6af1aeafb891217779d5884923589d7d6c7d2c2aa34a8343b449831bf994e768c87038b9a2a82c75daaa66aae1804efa7067da610e5579035af913f384d00965c823014520309491932328c59b5b36d512ff162aa0f9dd32381651422fbf3211c42d44937b1"
                               {:L L
                                :fixed-info "a1b2c3d4e54341565369643b341ba53a0e4637885905526c4f810df0e2ac"})))

    (is (= "a2f9e89f88d1db9355361bbf38c7"
           (key-derivation/dkm :sha512
                               "9d676612f1d38f0c98da0f9620eb742f32d3cf290e097c13b1f54f2ce5c67462af93a19415deb2a68cdb0eec0da5e1ec31f020eb7ffd1ae82cc750941fc21c669862d194be2a4bfdccfda123945c9f13b349ad074414ee0a4d2eafd72ae497b233eb9682255fc1d0efe8c805f0fa8d7a16c22bc29317abc1c4592abfdcf5c9290d9d5f364bc7583337546e03dd6d7b2ebce4c2401fea555216317f5a08775fa2b7bb7d19785211bd1e70b93ea4dae6b352b03150643082dffda785d8f859c4f4eedc4fc47be8ed70baa08e4fdb8a6cfd119f08d6d2b7cc695163aad239cd45d97d1d26c0774d0f789e7141aa21659df3120c4a48e0b291cb6889a9ae66d69d37"
                               {:L L
                                :fixed-info "a1b2c3d4e543415653696486e39bba7c066407d9623cfeb9afc939a07643"})))

    (is (= "a5c5d8f37683605a8cdfe301b7d2"
           (key-derivation/dkm :sha512
                               "01fe50f47bb4834856804bfebcd897ca7b1bf631d262f37021e9d2b2eca04e64260b41912cbbf3802a390e6c5f02936427097da88a90145e11d1e6735ab4d4e5e2ed36f4c0080dbad2a18b337390f203cc770458173ac275ae043f70dd4ff429640dd5c7fa17cb2182ab500ce21edf964a730e55c4f7f67ef151903483b9cf484500c7d37263e6731b5246598c4fa1147f49f1647ad5970790de58bd98204296819cf7132934ec3bca57764298abb5e3d64cce91f83fc066aa43774bd031c66483e97adc91496df7785c7159fccb9d3e2f1bb917bcafcd402491f683abf92c3fbf685d0c05d6736ae93c68aa51550f2420b02c37d223f554ac401e6b68f8c1c2"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964e1775025f83b2d5845e1d2dd95931741116707"})))

    (is (not= "76cd2c1469314849512b8c9d6214" ;; > Result = F (6 - DKM changed)
              (key-derivation/dkm :sha512
                                  "7914b0438a1f23d11a1a1d78ea5f2b6ad02adf5ffa94af5b6765da2edeb22ee8673cde84991ec7050da49e521940fb20b44b6db5083149f2ddbfb45443aefea4fc8a32638475f4235df26514d33b285ea90124b60d91e5dd15cd9ef8ba06910ddcc5e53294b2ac4c4a70f3804eefd80731d0b7dfd4b71be2ebd4f94317284be665fe593c9803b693954efd4f844cbcabb6fd79f7a9a0d568c681331ba4bda9c73cc1629eacac92ff8f49143b34e165c2aa56707eb30e09ed95a6da67375db3cf069810a6f9b53a21a2e9357291c04db3e97c04cfb5cc0acca06f0ddd337118605d28dd31391b8cadbb08954becbe980197dcc3dbd3687d19c8f91f767aadbd2c"
                                  {:L L
                                   :fixed-info "a1b2c3d4e5434156536964b1687c48b9175c25f23faa2b4f1a868c8d7c47"})))

    (is (= "0666fcc2d5ae3f05bcba4693d4ce"
           (key-derivation/dkm :sha512
                               "0e1098ff474d57007d5b8a9b0d701154c9453cdf470851cc495a90d685a246feb42690a8e754d76d03f846a96809b2ec0ee241cf1998418360b7c24ce747402c2b01949935f301818ca239171fc7d31e26bf5de0da0e901da39ff6f02fc83a4ff6cb786697fde47074c3ade7f9d585b0cb5bc960ec2339c3d6c4ad5552c9cc6619d6364fd9945d2b29f9849850b6de594ff4a49cce93363379f057b759716f3a1af9be6eecf43bfe1f4b80cd15c986c4d7af7a1e613c5ec4a0c2a45ac726a25cd02ac2b11d6f87a2b32106e96b386593bfb2736d450dd1c49c406aedf875006eef2176849b3664008e15e94aadb8f22a5020ec6b972f86b05be4491df225445b"
                               {:L L
                                :fixed-info "a1b2c3d4e5434156536964053721d881852b18ea194a682cf70193fcd6b8"})))))
