(ns litanie-contre-la-peur.core-test
  (:require [clojure.test :refer :all]
            [litanie-contre-la-peur.core :as core]))

(deftest ffcmqv1-nokc-zzonly-init-1-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "ce827647ac3541d35f7d5137a0c1a2a2be8f08905d75a2a1f8991b881f1382e12fbe87dcc78c03a2660c8c306b8d2dcd05cd2c518b6cd1af0fe5005674be8b245d6ed9937dad0edb6704b2a21191c0bb0b8b69170fee181e937cddd6d3009051803eb56049f6a5dc3ba29b917074a36beeb7e211cdb65f7d73e9d536d7f57ffc1a5ebeb5e298fa3f7b3e14415706690e5a108f8bf9b675c26c450842173bb4ab34ad8638b9ee87da77e3c071f404eff20b3ceb40f2ebe9b2af775ba17503d4b4f04e5c423de5bfc0793f51b7ee40bf868a5f74ad67080fd1c50b3b9b48ce3c09841ba9327ae69c88848c8c31a5b57bcdde95b9e1482b3a146025bab2e947c62f")
         :q (core/hex-str->big-int "af9d253e3f116756784a0301f682533694b3f12f45abd5913ab09395")
         :g (core/hex-str->big-int "bdee5043282fc0d242666d801e8934f38245509d7da17bc9004e24896366146789611025c71d7818dbda4e09d0a815ec45cc59a307770208bdd635e131e7564e598375fb75d0c861a751688669ebd9f9c04a3f153f060bc800519745dd9e283566c8c9a641772040b0cb4b5c69f398cc6461ad763a9564105db324de30368222f36abf7ef6aaa62ac67346c391aa38d301ac6051ed28acbe223ad04033ff95dd0fd89a52564e2a8327f9de729945f4c1008b7a3dd6ede80a8f66ae6217d74fee9ff81d26765ca7e4fd5819c227069ec1fd855e234911c689e057f3927d000ccc482da3ce0e5993f924681cec31a4e63294b52aef8716695e9ca2f8fb36464829")}]

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "6f378694fd0affa3d67bd1324adf5d0b2b55d11f8912751dc538d7d6")
                          :static-public-key (core/hex-str->big-int "289035379caf0d7cc8984102654202dd027c6a74f7f0fcd634faeef2c0917210b997d507625ca535947f02d78c3cf7266791f3e95cf73f9aca3be7b18c05a66fc33d746e02811eb16a44b3e6af012cdccdc2f84d3a0a9984fa2d034eeba596b634a4c9e5ab29d8787d31711b09ea77c991391cad3a0c574af807e31a1d7395745b29b9847419213d519a4210cb5c3f0601c6505380e102f13d2e6d473daf611a0aa2cbb47d85529434f17d1014b876c918ee2c866acd1b3c59a8de76a41675dc3f1967c748c077ed0be035365c7a7148c6295eb83fa53eec4bea9569d0775e451c8d1171bc532b7714214d9f22bacbce3efbf57e6c9283b8140f20fecea867ab")
                          :ephemeral-private-key (core/hex-str->big-int "12da574432595fc792a11084046348248e98f571162821efacf45276")
                          :ephemeral-public-key (core/hex-str->big-int "6588df436aab3233e49503aee9f76eb87ab393af96c0f77038f22821aec1c979d2652db07397d199252e0be4309c62516f02e2c09c61429c9bc1fc1d2d74cb3d15a10febd78ffc4eac8d98b49b6f71eccac85f60340c395f9ad74e29d7d276db407bc7a3cff2bb585841163c2afc6207eccef4706c5f7f8c786341c89466e57b64c5f9056efde08cef7ba95e826f59e0260c6536e348c8e0045099761cd38a1079382ddc5db88ac376a788838b15d4dcac35e668f67b2159ef82128276ba9d01c3bd12def396c16eb0832e2892b8d7017ae2f57f35248fa06a29be48a96f5c01611d59c63fb54b30a4a2c786c6aefd16292f16eceaaf796aec923aa22115e303")}
          responder-keys {:static-public-key (core/hex-str->big-int "10431e92b1efe26a389e559066e635c2a6b564d39bfd5902d3b3ad003d5321fb8ea361983a4389e9e6121714eed2b33fbf95dd45d49324d0420ba58e6b2c9809235760c254b44cf59a217e98a77f6065bccee3100dd7049f39fd4faaf5af8ea4c4ab6c2453c5e37a962bcb8f33941ca75cc4ef1d3ab73558db448d023ca1369d5d993583b582ad285491705930f81a2e8ab9cc4c82aee16f49807a5d13b3e0e953ea0ad7b51998428cfe3559f208f42d41346d3c1cf2c5b342f9f55c19cef3a19939d716e6e61e4bec92670e60a404985b5553d02fec43ef7dd3064ee857f422ccbcb7edf2ba72e18591c6bc1cf5922c43fdd642379af6a78ad1b05b655b2a0f")}
          Z "35778de5bd6606f335ec6f9304601d4ef9933f5024f9dd35400069c7ff683243504802532ac35535a21bdf65cb3fea428447e7c3a2e3e13aff752674b86e14de9492ff13556cc8589802deb4f4f3534d0cb0870933d7834b01e1f91bfe60535c7e7f3379a0036f32ca1152740c5a8919405de07877f6623f7807bd8ab991b5ea6c47c0b59dca6baf1d81968481fbca0229d62f325d9e55d7bba8dc98a40d31067524f0d7d16ab40af5cac3a52ffdc1d31cee1921372f76316399df0aa916a406ae2b463dcd82475831038702bde94d61c1683d7ea9a97d9a2f10a68cfce8a1d05b13daa3017d653cc6d3c9031bdd198a42ca778771aa8e94bf40695ab682cd28"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "1eba54562ab81fbddc6da069e7d0897c17b5ca152874ae6abed3168f")
                          :static-public-key (core/hex-str->big-int "470aa7ed8a2d969b66e645db7d1b04859f2ba8681c5a36dd45968b2721c39ead34d0a8990b76a0f85dd637d644e15483923dc23be47f5fecee00367442faf047b35a9657334b8143fcc5a4974903af3ea464d1df4228c81d6190c4a608503d5a7ffc2dddaca876db5be4de862ff35966f2e5b98d7de1dcacc81dfa745a0b147d9ac9caa4df587ffab6e66f23c8704d2cfc0bcfef424a3eefe3c2656133d733e34667a14ae9ffcd343599864a57eb64c7c67f8d26beb4f7c3d7281c9a1b7cf2fdaa01734781a4466b4b7ad8eff0a5e69f6a046968f5796f64b40f4ca3a843f78cf911244d810cffe2424802ea809aec0366e54075d8ed716a07cd558e81cb84fa")
                          :ephemeral-private-key (core/hex-str->big-int "140dd38ae0e6bdc072d101a2b38d4ed1001f6e93d47e69181300cb01")
                          :ephemeral-public-key (core/hex-str->big-int "c1db2b50c90fc7825abc95be9d94b5b1f59eb47c91a459d345c5dc409e4840bca5ced898447b9457276fb17fcafecd4697fcc494920d7bf40851b0f52b96f829f05c3b8bcb277236d541c829daec94f5e217fff1c3dd32c0ee90265f9c0ad7e674c0123ab93ef9ebb810d63c5f27dc31d861a39d24982da69310789ce7723cab6ab7211b1e37667b9223fa505b47a3e6f6fc64b9d799c271d5e8c54f1796e3cbddfc71d041199de2383f1ebaed287b5bf29e24050e5c0363762dff8e3f2986a3f5febe796df3aa5568f614dcfba35f7a68ba766f9d884f9d0c0097c6c363034e90f000e62558916bc96911b139bc4542875bf54555083b60a34ff98c5d50dd45")}
          responder-keys {:static-public-key (core/hex-str->big-int "485356ecbe530d868e225dcd435baa08543df0257a8f689ebd06edc5b569f46ca2e2eafbac8ceabe05c9f5fba74880b094c8f22b45aa377412852c189c36e8444e628beea304594d6f554161be9b8d8ba492ec129e2c996cbe4cf09ef2c5171e50c82985d704ff514908493968b24028d0c7a7e3b726d20851800db236d4cdc7a4300e7e170773c0e685a66da33e82e8772e91bebb16df73c2bb22c2e145b0e181d647ca2da79f682f6b3b37cc2f516c7264b0a7f2ef3617d1ed3a5c1f33a80fe0a0dccfb433b4d7ee88d48879981b4cb747d517ef8ff9d4e303d399d8e1942648bc2f189cf50a39e99c5e545ecf6e1ee7362138d5a378c5166fdd14ab1180c8")}
          Z "36c3a886a69999f72aa442efd124c2abc6a3d0adac8b50e0743e9523116ec1a004af8df822f661bfcf8bba10305828fe746b28f9579c36f7330d19835b79dba2ec6e871841dd2913dc0177e9e6d7678f5438a096f16b91d8680b00a37e6422f3ec1e48217d2b5b2566525b63d97251af4b2afe3f07f8df40b7bc2af4bafb4bc589ba31407c96b178344485cbd7c55daae019fcb940787dd15c3ede8d86d903e25f2a843a32a79b93e139586b76a817867f4fba4c9077cbf1e31ee589b28c4d2415960db7c3e6be47f1d117260c8d8e7c44123e862c7ffd99a0d4536b13cce2148397fa195596fb6eac927c00799ab164da1128ca01006f75018a8f9f27c29765"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "57ce1374d699497e1a6c1dfa7408099cf305e3b84d2bd2f7aaeea1a0")
                          :static-public-key (core/hex-str->big-int "caf2d82e8f8b55535988b4e145c8ec9e729e908b1530577b96896c46cf3a55dcefe3202e2689302f30c61c71c7422b0829b3e5d3270201db707fec87132e9cdb8feb234d2ce037e3af8209cf3b77945f19433c212ee82dc4893aa007c59291bcdcbdb82f63b42ce6ea4a744dde3fbf3955eaf7a4153434da7ae522006b361a8a982d029dc0b2d0e5338282dd0afd19ee7a938b3243a20149bf56d0aac46107f30606205efb357318dc278a602f82970177ce04c30d070be93303f1ed5aa1c809942f52011141b7ddcbf0ca56e531911f1834c01b5683e08a3efe51bfa564976e051755520bac25758ba30e6815b0149ca8e363f7328e650218df9c1c0b41b044")
                          :ephemeral-private-key (core/hex-str->big-int "55e96292273122bfc0a2bc05fb39bfab94f520fc653146ed072d65f3")
                          :ephemeral-public-key (core/hex-str->big-int "50d534270c10682ae8b426ebabefc059b697f20886845acfa07ba1b4233f9b18fea4a0e325dbb063587475c84c8bf18c1a48ea1238ccd2956bbf942e467a580fa41c83f5ca24f17e685741e26f4e12cbcb95a354f3c4e1aab2cef12bd3df3a6ccd0e2feed61bb87d04416ea632a66e13636a78b7a1f0d36a5876175051d7b96d247ce596328ef5accbbb3e306eaf8a966cefd6d4e582937bcf6947b633602ad57c11932bdd5d8465115394b4cc73b2407dcb7c80148350f1656f724b48d62baa84d083db6bde332b8e3a8ab7659067f7cc2c4f58646cc258e184897f93a82671e64697fe55e01466fe82480f6463ce5d81d215090b0cd1ff0d1f38af988d1576")}
          responder-keys {:static-public-key (core/hex-str->big-int "961a0d5836e79c26c1dbc8e63d18c66e0dfb1a2a7234cb7734b8151d06adf7a0de69bc78b95154238694d0332055a7cd8fdbf57a448c18a7f58f4b6ba7c2334cab203be0cb959a9bf98f440083245d22b8574b38121c22ef7128c243648804d16a620ba82764c5ab31c4700463e9a3474fe5e3559050dc1acaee3ee8597eb74e9a271c808d4c48eddf2a88b4fa5dc97b88038a3deb70dbb9afe3f13c51dda59ec917e8ede5ad6dde4f7dbfc2eb0ba16b0a8a85a5725c183f4362cbb7f4f910d04bb1058faf704426ca554b1125e2007d26d89347eabce37569979ecb13cb415ecc547688c5b9bb4064b2a9f2754b9fbf6bf0136eedf4b8ecf899ea8ce28711ef")}
          Z "6f8c083934fcbd3c5c283b5e4aefd4e2646666806f08ec0336f876f5b44f10dc1eaf4b780da108057e24a1210455bf5c7154845bac4ec1d701179c3c0bfaa3f7579a5d74106bd8b429e549cb0c577c02c9eda5cf889f954d22ea303ac66bc4ef2cab78793abdea9ee6afffe6e7c1b55eed837b60e09e11b63633d405aa12f4b3e8713e1419ec6f26cd7422b64358d2a0f8b0a9a9fb5be3dced2aa28d5f5359600a1e1dd4f5505a959cf43bfaaa1a4ba03a0b1b22a5421f835516cda1674fedf563f3f258db8d2f9dffe25443c3b3c3efd439ed97cad01b4a99e954da31de5f11c11105801d56f3e71cc9fe25224f404685786cab41036dec85329e810bdd42ec"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "a4e345be32fc51d3c023ef7d762c068af03b86ae33b560bdc35885c0")
                          :static-public-key (core/hex-str->big-int "ad4a42b2f359181748faf75c24ebd98ed8c46c3687fbbd708f5fdf1b239e2390fcf5992abdd77ff7e6ea6accfee37868029b85b073ccad3cd2e10dcba01f6a9f3e8a728495bc1823e4c3647dd20bca9165ae0baebb2e855a09518da2d90c574c5275000010a51c02f13835a291779be04f517200cc56c63c718d8123e17d1b37d015d8a3e7abd6b65ac2eddf17da091c988e1b31d74b2b354dd3ee624e04f9e1da264517e35b9a3a36198456198f66f8c06038fe2ed21f23b21c976f75ffdec32cf35cc448c018cabd295b305ea9cf359d6ee0f974c3eb645628e365c382b7b53a6ad3198e36f784935db78ff284028e7020914f076f0e181e241a29ebddfbb5")
                          :ephemeral-private-key (core/hex-str->big-int "980859ec70f54a0b3359df9184605ea4f864966d8b509a66c17b0e30")
                          :ephemeral-public-key (core/hex-str->big-int "1290f143fe491e0d5ef5829f48594524338c659ef5e3b4aa53411325c6fc46110d2b9415e77b641150eeefb4bf1f39bab551799e9ec3687a65f13e1f6991bac2ae2fba7b757b3860ba39e42c962038df7d606eda80413ede4e099835e643bc32b5696ec1ca63c68950a01b754f482451f5ef1157d7b5accc70411e52bb32f692915c5f8c1f949fa4dd986aa5ea94c9d5d31b147013abde219b2fe654f50020f5f880d94b63113600b0bcdcee7ce8714371eaf5ed5464338eaf88783a8a421949554c801c6591653c8738449299651f75c3c6167e6d36c6a44b85e3271b1145b11f97ab27f3f38f9eab7b5338282951db1e1a225c6849b3d9e987e2db8e3a4db0")}
          responder-keys {:static-public-key (core/hex-str->big-int "1d3a7ccf36b888006ca6af3d0260f40620bbcfbac7f7f6bcd3a5e9f17e7593455ba0d658802ec0c25d8200ff3eba24bb83078747fa97d1e94673dccdadee3e21071128879f0c06bb1b055715b432d676bee84c7714bffa2f57a8893a567425148a888e1f065a08e359f643c0cbd7b37e0e76fd16876cf56dd08f187ef65ff4a518285345fc358842189014bc37e98d5a2452f3e854333fc97ae87c7c5c2769123c0a81fc9b9fa9665fcae55a5ccabc648e34b94a9ff065304afb2b69bb7eaa5751e8ff4a8bd8c4550a4a3e5d67262fc30eb3fd5b67774397d956c956b386f6d1b245a8aafa731aef0bfae64b7f62563a420749a4cb2e9243cc5a310370a68812")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "26b8cf60c090de9dde3ffdfd8c7c755f8c91ad11b9fe06ce477f95be")
                          :static-public-key (core/hex-str->big-int "8ffc9e38c77ebd893d3d58489a07bc51891e350cbe4c30e7032d8e7948427507658449318a1411f3f6680d8ab9efa86d0153f9e65722a29c59051d436c60525bd390b283ac12d043274d4604b8fdae211be8d771d3b7c198bb28b16197ec479e097ab18083da1d412f61648236f2970c128582f2d037d4c29890a2dc24afc9a64aac54ce23ac64a29a719451e6217c1e8585da830d9fe3dbee1ede9d1e20c29c42b829b83982318fba0d40ad97f51f53e3bab690536e17feaddbab47120681da7a84bc112855ff0efa1d7b9f61c936f84a410aca79d1fede0f773d21c8e818479193144b42c53fb406132b2f70c65009daac0f3398d30b07d503fea9a9477cbe")
                          :ephemeral-private-key (core/hex-str->big-int "3d64073e44b7f72590bc6445e4c1c57dc7b399ac087e14cacc892cae")
                          :ephemeral-public-key (core/hex-str->big-int "4279187ffe4ba143ea823ebb2b37ce8f4321cc581628d699ed7dee75e04c1b35a62d21b4948f67ea2842853abfb03f0c73d9dba967419b45876734e01d00b91eced1d7948358a448bf8a6adedd69e1818024ae27c9a1ecb204c661f68a7054e11bba338d58efc64f21111ee21888b0c4ddde2a0f71ee0bb5c95f403c0571452dc96dd5d4405c374b67ca198c0546d540aa3e29d8039e54304133900a4de9f393111d8abdd728dc56d0230a5791d24c8f385ec9fe4c4e60d4b0351adfb8cd389892503aa64816543884e937a45bd10037309c9025d7a5ec7ade5bbc28e7211c07fa6e6ade3b4758f9c07c8dddfae6e83eae031deb4af27f27b7462117c8cd2c22")}
          responder-keys {:static-public-key (core/hex-str->big-int "1ed8ed0bd2caaeeaa5eb9053125a60c436bef2d9a58edcfab06e502ab82e43bbd29a9b3a7ffb4deef59f53b20bc89125d27430307a5b63587b77524f98240fde25f6c6dab240dead77f9565153349d1feb8ed90e4bf75a35a728288398578e1b6c5d52abfe31dda6a4e53b34cabda8339477cf185e3d390e1e1418b24d07ba8169022baa4b9d3312a8dcadb9ccdcf0514bda6fde2cf9fde44ce731c30facd92dc90f8a99a938d156685931f60cc5753984731a180d397abaebab2097626dd38d5b82b8808026a1003dd3f1fcab9ac72537edb394b39fbfce9663ca9d33606e78493e859113d3d2608cf80364dd960d068efae5031428d2861387312ec3e6cf00")}
          Z "8c7de41470b142b5f592690e54c44c913c7c846f3ffcd2d88da1c29d144bf6913bdefacbaf5ff8b0a398507585a3b7d758e77d24d7552e6b6a0866523251cea178a6829fb7428f8273ab924fcfeff83bed2dec9b1cac456a74dace95a7c5a95e335b7fe0ef57b05cf3afee6e290a3eb85fb3b8fe6567fec273bfa7fa6266bf404db3b4f351d0801073af7dd6af76cdbb61bc8bc8dbee7d5d1c2e763201933dfd1a634cb81f8dc84271c3467b2cfb34fa981539f0249065129786c4e1800f21d1b81c9218581baf418065093fbd5bd57f9a1d1b325be9a64b89d12c75ce88c4766f78e32667b4491612ed01c585374b7796c66a6514741eebf1799d4504d3000a"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4452a25d49de8da1c719ea13df772c8fe446a13b317df870466377ca")
                          :static-public-key (core/hex-str->big-int "167ed51e5e2162b1f3d280eca4242ed635d0215f14b06c5941f44b4e0256b7feac3582360e7ebe5d097755de5257818e103d2af34e28404ecff35d05a355ecc18cb29a3efb5b306d69e49b8acbc541029075e93c3bc1aa1f02c3163b39909b465bb45be962e529aef38b711b71aaf6139d1bf108b80e46ee7f0e0f7b20f93917b26c3b77d9ce881ef8a871c66baae4dd2175f52d3c6e5532f132cc8ffbdf2727c0ab330488219dd89d7722829f06a06c11808352cb74e18a393dd7e533fd46cd290f746d519b943ec4fe9de54fe11dab93015f291ce6f4389cc86148207717704935b761931d593ea7dc7290a1247eb6a39229fe11b681035bb9a9a92e3c5627")
                          :ephemeral-private-key (core/hex-str->big-int "8dde3d826688cc34c61529286ef39da43cde2800a2a551bb0a0e2277")
                          :ephemeral-public-key (core/hex-str->big-int "220ac43c7109fd85fc96666f213d14b324db3dcd23aaad45c66c4c59ba0b5811bffba1ecbb42a225c93e1a3cf375a3daa23d99aa8b69cbbafd72e3b643f72124fa11adfff7b1be3290a0da66124c50819cb292d38bfc50e78b2c41d0a02f40530bbb81926773b0bef29a6c323db7e7e0583f739b4ac24958e718e58c6aa94742cf6ce121bbcaf1fca8ae6ee1afc4c03e2296ef268f88e4246aaa089e7de15f4eaccbea014555730cbc56a50980d1e92740e31a312a45080d516d030243bcf25ff2dca9bdd7033d41b608b5c66b797850a62fa62aa9fed8b5d16c13cf7382dbd58856416f79967b8d3fbf995b9c22b2987b3e1b108372e0ecb1c85b78772dbbd7")}
          responder-keys {:static-public-key (core/hex-str->big-int "98f4920fe4abed6a3561f1d5999f7ba2d139a4d0676c8a275fbb27981be658da4c4336f1f15216d6ebebee7c074bfa978e93167d9f64c449c1b0f24d1c46b64df82794287e6fda645fb98973064dc91f7c0043fb21baab7f6b41d1f6631206df4034b9a8da88283bcd014665848be2ccdc2baa7f0f712f1c6614be3014666fe498aa30f94855aae5ad46583a095d8e2224c3f10b94eaa21bd3b54871251451dc149dc09ff124ac6ed8ea286c07189ff497265695bac514c393141282896bd95983c5f049057223bf4fcbe8c7b9bd6147fa55c4f128cd4bd25952932d49e41d26962ca6b0ccd8bef98f517b6487131c88cfddf8bd1e122052a2f5ecc50056b354")}
          Z "251b2b2f89af4a885df002a16e7ed69e18053c03ac39bba383182d5bcecc17f4af44b197fc90c71185d0f12be86efc5047eb3927a47593a71f69c1068ddec55aa4ac4ee50031cebb4267043c3e228afc1ebf2e6961376dc2e5d1f2243793df031f488f02e872147fb30e1b8da765301a2464c74f2de677e8fbbf7c10a05d6d06b57f022d89a00ab3d9ffdb07e552f6e4739bc8f193627c9d7c7020db98b455c5dbfd10c3edb82750a0fac89b1d6c7338063e1416ab386297ab8cfa149568ef40352973ed912b6b983f89c2dd1ed5eb75169bb165ab9bdce18aa4df39377c53c2c3c3ae73110ef6e9bcc1d1f675aa6cafb904c8784bf546d4aa0fefa667b1ab1b"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4bebbc7a68f8e91d210146321d05f21b4cb9da04799330562a487f8a")
                          :static-public-key (core/hex-str->big-int "9a45fb320f7031fe7634ecc3f5d5e432a432f30534feaf91e2ceb41ccfa835bbff8c27cb20c567f39bb940dec3ebb49b1bc19c5d3feec0de98a496ba253176fb51485eecfc213e7c6383bc01b23650de817ddcafd439e8da43186726b85637e9d7c0324946433922439201d5fd129f6e017e4ad59968874ef59c021f34d533c3305d9a1d1643c23e5d173f1023f59ded104ac2a48e75ca342672d2992bb804ececf050764eca9dd542bc5bd86401fffb634b372d561c790610a63bc9fbdabdd26d3c6040c8b6fed1e19535227a09609cbd5027bba4094a5bba27d4a0fe91451b250479fec1ccc9b984a3bc880c62737e332ecfb054fbcf9f90586d24d4a11a51")
                          :ephemeral-private-key (core/hex-str->big-int "80af3989837159640b247d1515c7482bfb30d8b58fec15cd259cdcac")
                          :ephemeral-public-key (core/hex-str->big-int "9df524d2518bd3d234df6337ac7c566f04814596e5a80eac4162135378cbf06dacdd53acb2fc3ab7eaddfbed995491f8e5cfd13714085d2b1695fdc809ace5f7db022fdd4560c13c3c63bd77fb7c373d09079deb8747804bc359ff2e14cfc5e2c112c9e3aa2f1b68db3b588428efca8ce0868f30a25d55e3d0b7760bacbf3a93eb03d2c435eb76fb97e1f159b3b5857126a5c8af7740e9693f8dfbb19b4f8b016c5e5b74c2405dd8a5fc4b1d9b801b139b0d10706f8b2a1908f6c24ac9ae15daf0d800d9e1000d163aa874c02b140075078a7bab37dda1530e33340a7ee11c3c36221e1825ad85501f55d3f870f7acbce5010954fca3de79622a8cc9f969693b")}
          responder-keys {:static-public-key (core/hex-str->big-int "2934d2f5ccda33c403cd3c5e4c07367d8e3fcb33e659e431f56120593a36e8ad8bac4b920b6ada43e553d0e1182b60942f370f73aa1b0f802b44fb4b8900933e1c4037ac78a6873c87666ac12135cca0b8f68296081dbcf2e83976a4eab7c3d36730e21a19c09d1ff6d8ef1cff069426b9615fd82824c9740a89310499c09e792017019051a3fdf2fc8df7f1163c8727f5d9091ccf05d604aa58179609b9456f02651c228336832852a163721e68b73f0fa048a55285bb43348fb94dcb37a36f3e4bb5421a8290d14aaf6b70d2cdf0cfdba371159a450759bc096ecc64b657fb9fc976d594f1fae0bf338868c0949787f7eb50c1f640ba4bc9b98478e3198420")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4123a40d0cf3eec774c4cd33abc433c8f3e0e74e0105c30a8a5d6d81")
                          :static-public-key (core/hex-str->big-int "ab34ad5e0dad06662a1bde73d897316f1b7abf8a95b83604408dc5a488f7351310f07b7b63322ceaa68e181c1f55be70ed937785da14605292d5f3c278afe1f06feb78b5cb6cb29469c54e1037c94f566a5b908cd4f485c266520b9edb2a8622bce2471df044d4cfa8c02472ebcedac9d6979e164d6366276a88fefb5ac60f285042ca7b922a0e783ef2457659958a9156e515f7c2bf307f4183fbd208524baac76a9fef2bd6d393cc1161951b1db7754d9c9f1eb242538158075d488387ff488e5532588c3ce4b926c7798e4821e860ef2c31d27804647146b330f2d0368c6e5d66dee55db4134ce90bc82c4e4483535d53efd0dc56b017613452353f764a65")
                          :ephemeral-private-key (core/hex-str->big-int "48efc1ca031c54fcfb55e32d18e81e7311fb5ae78ae3a18efd17f016")
                          :ephemeral-public-key (core/hex-str->big-int "26ddcc1e61171bd9f7348907de9a53e0a0ba9e7b9a976def54f9fb9a529b421b206dccbe129f874feb97bd4656a5dd15a22506f599e09cdc5e14fde25d95ae6a7c63b220324fc5f06b7dcd7c143b4da25b4f74f4800ec847853e121aee5d5172a8a4441b6e746f7a4a00895bfdc75817308cfef99537ca8948e0a40767bcadd62493dcbfc8cb686b9cb72ab1888efd7252f437a8fec2ffa68c5635240322ba7174798c1da4bbeb79216dd8113d905bf6185939688f594b34e0374823971e9d4bed4e1ce275f29be0368bc2c1fc7066543ce34993d4a5983a044576248b326b8ec6bd6e1ad2c0be537e846c0490d5cece9d45b8c6d2da4016c4d9c6b53e37cb89")}
          responder-keys {:static-public-key (core/hex-str->big-int "980179d493f240c4730740c8721c48cb5401776132c23484cfbbc23340f6948dfad50ff26804558e44d4c0434726e18d93e26c8ea0c5731959d97051868fa13db2fae6c147da4d26f55d71e3333cfa3f505a3911038720063ed621f2c2b5a5b7986289a5a0a3dc896b648ecefe2f033dce915d4c7749dde201d9627c5481990ea44dcaa01a36a3b26c71c9e4e3b80f2c552d691a0bd0a756b08813898f828801c696f2b72aac804fd63f36e5b611145aa7b95acdcb5368cc784c99e20197172050998355a579df72cbb69dcaa2deb427e3ddad185403593eeb54487ca8387617b196ba7bce11ca857e8da350595c51b0337ea0a2ae9809a3d96ebb7a407398a1")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "2e29771bb18b8bb9391d5335411d896b5be523c7d445b6834e4badad")
                          :static-public-key (core/hex-str->big-int "2bca048650829a61e5d305a71feb862e9aa2df548aaedd88a8cf4bdb05f67403d3c4698437abd1947c90a381cdac611a0f3292a4975cea6926c089f0e1a1b9152671f8172e4aa8d22013d7dd12fba5c2b10c2be3658e1b05eae52802a71bf92411b1a7dec641b2e81f851fac45497eb9df8953b2d9c7ac6c126d9189d044bfa7e62ff65390f1fd2a9f329ac3ba4a9f531fcbdb7370f481e7d465e2bf24ea4363e35d230c35aa331958ec34cb1b55dc871cbc8a5804d33aa053c69bd47b51890a0e7b42e72b5df65ccddfe275a4541aa8ca1fb68f4d52e48bada71da6d2faa4593941872a85306d92f9cc8c186f21ed01668ce3b045b7640d8afd8e1a4eff321e")
                          :ephemeral-private-key (core/hex-str->big-int "91712d57f88e5e9d664f972ba2293ca22e5180d40ee37815ba46ac9c")
                          :ephemeral-public-key (core/hex-str->big-int "5ce4345e96a0e4527c294c16988f64bf32365d842e00eef0b3e0d03ee9ff0b27fe1a83014d9d0e3c8e6fde5d6e1631637fa17e38c50902555cd502052a7a24a8b9cbf37d70d3085ed2ce506421a4518f351df52aadc9c43b00bd7ab98ca5aa86a810c45348ac2349d8e75c679969397deb4f9bd069ff654db2617b60205f1897e04fed9aeea5fb966bde3c3bea9863ce0435c0d3346d755209755a76d6c436712c40ea24aad6e685b272aecdd49588276ea3936903140bc54d0077f1335f27ff3f2d0f1bb58ab37a31672b99699af0c7a135e51b65dad94052db41dcabe23f098e75641d7beda6e6279599e1fd7d84607577d6329bb382a2b8ab96982cb84b9d")}
          responder-keys {:static-public-key (core/hex-str->big-int "75340f9c46eb78cd798f39385d6daa31b06973418d5cd0dbfaddf08df1111ffd8429276cc6dfb9f3fa8d2ae699675f50d97f13954ba9740781ab2941b3ab18ab6dc23fe417f076ae9bbe84f875eea7371a0c5ecbed4dd0f008a68253bb39014733bc1d744c3204556ff1ec7fc5ad1070c32258c2ef335e31dfb80f3a5418a95d454a277f59e9e8f33ac524d3bc5fb162e4dbaf2a54b9841b475fdf15dd90b93e6d47183857965cb39b95c7708f3c411ec9deb1e989242a78a81b191026edb5d96d645af61d51cc59a32a1f137c8fab0a4dfedac2c9cb80f343e1686926e1d20a6db19c2181f6be028154f0d148ff5a2c2d2b497c1237bf836d9f9e4949820af8")}
          Z "01b20955ce34d2508e41c92ea35f090781196e7e8c2531b2a49ba51de188a0265cb653804ed7a468ed4793b7764f773a66ab3c2129db3f9cfc00bae34b2aa8dd3a0987e8400bff20863ef618bb9bb1aab10a49681153413c5a273996ed2d20d48b77d1069ef37d1a600d1f626df4ff66823383df4e511ce74ea629a6c99746f9f755d7e882004dbfa4f8fc57c3a10c7d54a81050308bc540d73ba9d320f5b1d0836008bf5d82e08bbad0d51f8760fd70309ec22c07623985911eed8be297281f5560c19b8ea65e8014b739adf9e7ee2962e551b05f2569d8af7124999d98450e876e0528f558c3f2466f0601dfbbc120231bba128b45472f2a51b9d0dff2a037"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "05e5d75a078faca786e58905b6f50025e00e61788ae08a677cb2668f")
                          :static-public-key (core/hex-str->big-int "7c13712aba892c59eab2d19660f6f14c30097eceb17a2f50e1019d53e044c3a891c9d3d26253cecada3dc40356537f9cc8d68871661d8a8ec12ca932f5bd95c7242064c2d4e419d525508696332a93a8d49a1651ac3fc0c764f3ff235e227048ff49aeecae5d7c04148f7c9c528b0fa882c601e139943d4f842d0b5c44fd24239b2289e212bc5fa0f2fb38618f1f956ceedc468a5131fd021635ccf46e525e83c6e95e85973477feaa251b03857955ec7a7329bfb493b8b933c94f6bd9a5321527e2a9a5ef5307e0aea234a36e4f1ab8c1b2931e409771d5b7b25d9b27b4d3fa25ca0be8e03f30fe5c89440ba71f23ae9c9e2bae7191bbadb9f241a15961d364")
                          :ephemeral-private-key (core/hex-str->big-int "7d719a3496419da201726f1de3b83f2d004be0775e97e88ddc7c5402")
                          :ephemeral-public-key (core/hex-str->big-int "a6ce610dffea50563e3e013a14d7a82de53179d0ae7166beb84a6ca0307d3fbcb5c1d4973f1cb2b7269e4cf3f3375a019450996574c494a07180e60bc47e4aeee7f0b8d635369141f95ab142e5bb22f96d520f3ffd95066a94f22a5e13b1f1c222d4f830e79d0ae7cfa2a372c0a94d59df3d22ff92cd86b873e15baee2ec4bab31d845974eb8d2efd8f42c9af07da37ab58228fc8a2a54e8c974ef3f078f88404674eabff7a8524d29f6a78366956649a89b046eeefebc4fa6a76e0db44d4d88505d47d800112c3aacda32451ff65d35bcf5d5fad385425996beb901d27df9d258f2df977b71f234d056f487360d3d5b2406b0af5c82ab7309bc1d7598d7f059")}
          responder-keys {:static-public-key (core/hex-str->big-int "008acd9db88d4b54000224ab993c2ac3757ffc75f0164de0d72ff2a0dad73742fc1912e3d0ba6431fd4af2938eedb2a77fa2bbefc9015112d7da576f90e7b419624008bd3a03d5c04b50d25634f9599b5596e8d83ce40bb4e2ee94860d8f42e9fa48fc1e10b8dd2ad5a89f9a325ff7c5be982e8a01e1e785a8f3075d70378af3e2c39df503f46d51c4d407f8d4e3a809cb3fc8b0de366f165c56deaa2aa0a6ad09f0912d06bc3bbddafb08cfffd7c15ab588057e50abfde5ee70372497f141ea4f844e2ab109d36d2a9bb0f541ae8a5bdc97c3b96ba6de7a8178953e1e72f28449e9ed4c1ea5cdb6709444d0a39a7b808e62d6998a77a710a50fd2120a6e6533")}
          Z "5084626db96f5596bdf628c76ed0880ccda9ba8f83343392b956d9e3770ab2e420d38470a992ae3a1139ad2a90a77c9c1f8b4b1b617039b25827d7a525e6c9492a85a81f6ac8cb930ac6d744c5be9338ab11b7c4a17cb4d5a211e949310788074b093186b526c1857d17b5030fd39c26921a13e597672c511f672e2618c748fb4f5b6164f229ec630c471738d74c37507f7ea39a5e494b9fa0f9b6bf313e19eee10f057494ea730bba7231ed4ac4b02b56fb8acba56d6328bd2d7b2109566262fb06b985793192e1dbdafe64e879601cbcef5c59dcd618d44ca396f08249b9ffb34c1056c3ba2f7d2d2915bc8427483b76544458d1401fef71ab8b0de2277e37"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "855372c4040956ee858648f5c4443b624a3e997a99d86f761a1967dc")
                          :static-public-key (core/hex-str->big-int "57429e0226d0c8e5556c207354638f512a204463a07894dec9878892291bd5adb671b8305a10ea7f9d661192a6855d149e4ebcf144212ebfdc7fac28ef2b9c7fb53c64afe5ff7e9797bb4c7cd1a085cc8bafcd4977f085eda2daca904601536f67cce734946a969105b3d14570d323b5f2e1c63e3339db276cdcb8a11787941985e874ab589fb741d002d87f905b4ed6daf6bc1f84ba7580dff0208081b507e0c56e103ca9183a91a64a6d9c278c18a8ed1d8a17f9688317515ddc8f9f8e70817fe5a79b1626e438339b1a5126d913e0a0d0fee43e0774ebd439a87b0c7c6bded8c3ecae4319e1444790c1d3eb79897fa52ad60f1dd368ff53679496030b1497")
                          :ephemeral-private-key (core/hex-str->big-int "1e716d04b716dc5c77a5bc5ab3fb1b7b416624aa929b6edb32f382e3")
                          :ephemeral-public-key (core/hex-str->big-int "01cf788a541e236bc4e6fea52cb7e206a988cb62c20c2a7d0538f76d344efd1ee73f2fb1f84769cd6db0b8de6d231ca6a7673f9e8115333d4e3a3f36bd1cfa52418df6666b8eb899ed19e4a88510a45963039ec9696a5689ded953fd42403725e81bf0d8f7976089feed4ca1c584184bc664d41964a2f4211e7dfb4d7c7f315c7e397f1c44d5784411cb577250c832df9a7d89b69af85baee31c86f393a9a41aec04f1fe771abdf2c585763069a8859ab06e2dfa32c6f5d7913d6638cf88ae7175b15449a78b0c523e4eacd02c703aea9d7b0b2d281650d1d2336acf6967cbde88d877fc11815a54e7a4a14b726ae506a80e84494b31d8aebc658bf7b32ed635")}
          responder-keys {:static-public-key (core/hex-str->big-int "8be80ddd5c768f2864aa4fbe20b14f47aa2fb51cb991f32dc2c3dd86ae53b5f3fc798faa8fa9ff137702f03fb0ebe404a5c011ac2981dd670cdd888b9c1e08b86cd4f41fc1067d19ad14493571149b6c2fe1f65a326fb48b168f3cc364334ad41912499800baf4565b36bb6607412fdf6709a4c5217c2ee2d9de75d825e50dc0038c4e939521dc413895bd823bf241fd28307863b9e38ce91a37121c2bdaaeaf22cb385a8eb6eb2e59c5910afab65c6b8ea397533a9c1570281f438dd71a2324de3310b0ea84c352a877662474a848470a1d7751813eb9620d9e7f64946a8f51e28e09ce0da9bd994cedcbbde42ed8b32a898573c7c80146afdfe1a4afa9dbaa")}
          Z "0421ab76ccb9e521e505df10c4405b76a84e71c389503160df9e1849ebd5fb5fcac5c2a811b7aac543f5505b4d044ab6a3e0767bcbc76df46c236276a9e3e09c3532dba915fd03af5894c75f7b61501ef2cc3280af564b35f78ab1caadbfdc53a33c4305aeada4dd338dcf707cd28bb9f53cf14faba8987ea458778544a5b58bc23390f1cbb02179bd23c0af8cdd18ee8dff0ec70afd6a1ae2c5f228fc78d851bfdf2347d088901bc7a8ed1040f2423b5cb59ac7869e5ca473f33260452850a39cf6a09635d70e15a5d84052110facaf5de77c6b8fde0fcfaf602754c003290060abd2c422bc3e927d3fa786b86ca3ee0a5a69f2470aa2bfe5e6d500d69cedbc"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4506567112aab9adef9f30d7e89e8ced048b4a7aa4b3bd8522a127e3")
                          :static-public-key (core/hex-str->big-int "8ada46abafef0b972bdf368ec8b4f5918d62b2c5a6fc4c5c46f83cf2d9d1c17e14ff14800f4b93839b64b27f218f4b425956819b3684cf5a36c66cdde93175c73d47ae70a34636cb33ebfdcd73f7ba7229ab499c3328ed8052a448a79599033e1b028c30d2d3427583318a4c86fd3b4b62199024fea8dc93bf8f324d64113c9c0b0f94e077f6b5e5ab9c65b92f972b27b7323fbfd427a98a6c1defe24e2da8fa46c2651c2de002b8e33da9fba75d129836dc0ba6382faebdd72c44d9ca5dbdf2ad848b9b32a79210894c0b335cc9975e97d5345d4f26a7b0c257f0cdd8e9c40946370bfe40133c86a4db79e0025d85607dc0edcb52a09049e62d71e1f0862fa4")
                          :ephemeral-private-key (core/hex-str->big-int "115702cc6b799d2c94a6d8ac3f56df44880dc1caf8469753cf94275c")
                          :ephemeral-public-key (core/hex-str->big-int "610fa152d5caf6cea115f3889ebf53aa170854ed191bd00d3f632b674f32a0dc4c9fc3ddd0cdf9c1fd91cf4ab50b0f00b2338e514eae0bb64e620882429c6f20569d4845d35620281fa46d3f70ac370ad07670f53ca6a71c317ea030b320f32fabd9e9293f33023704c0bb6eb377ec425bad207075fd12d0faa2beddbd3d4972452ee4879edc722369a30e9167c4e17bb4e6176a0167868cf3e57ee08e4f96f75f98a223333a5fe2a631df036868d95a4f4ddcd275fc1739290396f67b0b5161118c624a09d21bf57bec895865f13da5baeec343c3e30d6ce37fec9f52f072114407d2a0eee7191ed4cd7211ded7b15d91b0d5bee488f9b7a2baaacc7d38d2d2")}
          responder-keys {:static-public-key (core/hex-str->big-int "30e268e548ed8bbfecc5bae673ce6243250de6299f9453c258a6ae2b4b8a77e2133538fc08ff9398bb3043d40e609141a6aadd77c8e3c6e8a60d8832e6f8273ef81d6d00c912aaa83e1a659784e109e779d3ae58f9c16bfffa5c80947abad8f87feb3f36b33fc4ba52444ae057bb8f2d205814701241c9b9084e08f554debdd11e39c0951da7ce26317665baf2a6d1e90ecc31bb363510087921b2b409e74b20593fed3fc259d6bdf470532039a775f417550aed27f08d3c6166057b7cb445b32a08e04ee6294432af43014117aad3895f043f35c0b3a26b791876c847a77e77482c4d99d511af316b98279a963ec61a18560c62fe47dbf2fd7fe0178cad6199")}
          Z "27f47b2fa398d387a3e0d453cbb167d4d662095c757d42bf3318548cb7aac50d02f6754f36fe697d679747ec236c275a8e4260735ecfa1e52763485c9fa8aa17f3356240076664193f47b379aee57788837775d38a8f4abc95b490d30db11e1b181737ce1653e14655272f6e709e7695a88d65c8aa6678ff73918173900a9235c953c49fef54df90b1b114567e5166014f22813d5332ec379880f5ce2b12ccf33d6d57f888f5a268f4078972d842788352d7fde6b6e15376d78bc51a67902e78bcef7492f1b0e6c5c82156b56ffcfee31d1858a66df8e3116b0412115414aa32e2cfe247824d0cf45aa6254b97449b94020955c25511f711b785b2195c84f44c"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "26cedf660e6a26b7d9148f1927d31b24c05a3d63c3a2cc94b24e4588")
                          :static-public-key (core/hex-str->big-int "9ff1372b283bbebc529f973537111ad22e82e51c371ed1c7b2c4420843586481f187e596f7981382758fb5a93f3162566a7cc1f6dafb29a25a527b1aed10199d95792ce59e49a07dcd51aa1014dd7b694d071a4f8228fef8dd6adfbaee011073fe65a0c16ebb1b6058e8c5de6dcd771b06131b683dd92fd68b092b78bd236187755e51b666d8e45fdb62865e1a9e9d93e9c9111674c0e08fbbae8a0385ff1affa5b0bba6c3807674c82cc9af8b92e4af73196c89056ebcca7e2f407d1c8fc3671d47ee5754aa869871c6f0e4b0c3237799f021f4336ba648b0efa84acf5982d06c7f840b62b48a91a3e7d5a98c4528000901dffbfbff6bd53860e8346daeee2d")
                          :ephemeral-private-key (core/hex-str->big-int "1ba779f0123305d7917d6dff27e7a4407fd9d6e53e299735bd434278")
                          :ephemeral-public-key (core/hex-str->big-int "c10899019792b1ce42829721e5b10a310eaf56c5377d4da78f143402df82dc349e3ca323c2623058b88ec6ce5803608703798f8ce5958d8523ada4853b6939261dbc9ea90fb56d069cc4f23f19afb2c18ca20dcd4261dae9baa25c3b960b32743854a0f86461c5b99b67e10a04f5a41659ae9b47a909c5e7ea747b81165b801b33f3d15f7a9bb49ca8dc6341d0baaf40a207ccafcf3a6f69c2dd5d43c29efe518fdfb73f5082447b69cf953286a575bda46510d23fc413057a12a6ea0df3862e96110d203361897020a7c1d35797c51b9eabd51c498a2da351f90192062626e4869210a902a5d02de71d8ca5618e26b73a289aafa6ec5fb01fc496e94c5d63e2")}
          responder-keys {:static-public-key (core/hex-str->big-int "89a96c15a57d8b96034ae2d14bd087d7a7ed519724548cf7283ceb6b5390620c259f0e8144be4e5b47315ad5294042460bd78758f83c86310717f11c28fb5237ad165f70a29000090b71f22025779abfd097f79a2641806523d3cdce74d10d34feb1488c071332f9ef4ec820ab7944f9e7e17fc821a4375f4b0ab3ed64a3200acd0351a0776223343f20889f557297c7c22c91f9aed1e72b32c0a8ab6e70d2f100beffab1eb9cd7960bde1ce35c99ac8e53eba48ab770b91404cd5cb45dfca4726fb7c8a3caf8a6dd045543e9797c08eec86a37fd84ab2c10ef3f2152a3fafe8be79445b6ed39281a12d96bd5ec384d4e574055aa0ce8e87f491ab379231794d")}
          Z "4eff26a5cfca1d9da1ec4a2d67d27f99f60e2a365b461991c855f427d440a04d8c15fb6da75e4af53f6f7f47419cdedc560ba6e6bfd9ac0f7df498da991edfd80e482bfa9aaee3d214ef106c44a2b8f7470c6dd3066ce90ed38d8c51a1411fd3eed6e492fa3610df0dcab1efafb2b3f4e37adba2548b0f09fdcb410eae32b769c3e4880608c16a74480a84eef07001d08198c3f3dfb7d6770a39cc47b9bc0008f5f4469f2a75f8e1511e26296b06940941ae9566c38fed8df06f76cf5381a29efd28bfa4e8469be534ff4fc0b1b1fe804192ff097abb030ddb9ac4f7553952e802ff17ca364dd17ff8077880fe30466159ae49dc46ebf0e25e27e9ab4de26337"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "70d389d765e1146cff58fcbdc3b2a0533c64ce296e3887bcb7b014d2")
                          :static-public-key (core/hex-str->big-int "154cf7cd58867af8db859a48e848c4966fccd9c014ce75d04b97871ad99417aed2833a89891dc56f70d79be73427046802743b140eba054ca63104b0c77b83bf2b9089701acfa14671dfd32146f14411fd8d6f8bd7c01e4af863ce0d15d554814b0e7e071c137bb5d5ef712fe8221bf5a3aff4e6162305112fedc53b8cf1c2c119cb536c087a7a70a313f1b795580f46cf7ebcdc4f626ddc348000679f0688c5637223f2f674eec56d1d1cf2935b31aca26e5c809a9ae4208e4507a25a6e1fb41a6b0db7f19999e32cec22c6ef41d6fc86af79af5efab323b970a9c6093697345d7552e8813ff84d81fe16c76e91bad72ddba57a839f1fff608beee6071dacfb")
                          :ephemeral-private-key (core/hex-str->big-int "6fd0c721d9a25a437e1a06ecab1516b788d827eb51d7a37f7b41cff0")
                          :ephemeral-public-key (core/hex-str->big-int "6507b7bb8baec08b13d7daaf7a9209aa25667bde50dc32e4a71fee5cf6e9084d1649bdf2e95d281fa89d2944016240fadcc137f8abf28ec265a9ef1bef6a6cdf8b5d0bc941952e5c981a8500f11a97d0be8425b2f5a803748f18d4e5c63f683822f6edc86f86efc3899d60dcf02eb0e72cd8ec4a50b6314ae1aae256b34729a45342578c9e088e9d7d41a947a27932894e779475b62a2a7e0bb1fb3e932fe3674c021eb5a7bcfde71bb455a386bb38b87fbc166770f1f9ef2716bcc5ce3a54c3b9ba2a535de0c26ce6fb8600b56c92c6d67384ee127e11c6a806992c2ad38866fbfce8a2900c4dd52108f5c65f7fa8b3b19a40fc7d4a698c3036a7bfb2b1244e")}
          responder-keys {:static-public-key (core/hex-str->big-int "b4357616bf069fc508c2d4f646cffcdece5ea2906a672100c942cb8aed83de9fb832e913c49bf7d3840749577e022c51ed651676cf0a73cde2de0ef3cc81ea2f32a48c5bb1a371cee420b189d21eee400548efc32fe04875837d81ab801d0e1b728ee4b41813a72cec781e476f638661433be2174878506af5283bcb6fb016d1ac2e886a0c412a29211960b435be400e96def006109a719241ba96a13d2620f0f2fbe0a80c7d4df772ebda2f929b81816e09c077ea8a777d4d5709c2126d46ce86d55c3db7e581ceebbba396d7bbe29a7b8622817bf472e93b6c5ee93a2ee8e5af2c460398f6f83abb9d13f77802310091373ea6dd5744498c3202da4538363f")}
          Z "abf147bc173ab1d12f471458900565675c2fa4558217a4073a7b5221b7fe38b33eaf781f2c7c06615048a14c9be1c67c59b68582ddc9a8f3ae1241f4b01463dc16d79ffe1c555a177e38482e589c640b06c171929be84bce484707948e8ba581c20a05e1454cb7852ed26f77f8b3e0a0fd021fa3009530f0b3ec6c9e0e2c1b72731093090a220dd79bff4430f172d13467afbc9ebd1ec5ed24073f0ae62a0fd795945d5e43c88928753a5d092ef3d1acfb4a2dea46967b97659f0d9c454adcdfb4d1bb1ec23f95eace5bab242d9c83c29849cf62978e486a468bc1c01bbe666df122e20c690163de456c58044495aca647664abf5c05ffb4b938d35afeec393c"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "3c4f0b2df3acff3c6d09f04d7936b1ccf94920b49aca3ab280a7c6c8")
                          :static-public-key (core/hex-str->big-int "6fa04fb54e1ebcb90e9d87cb1413ea7a5903347c3191b556efd124c110e145c33cb67ed2d2810e5e56cbc48151e1bdc5d71ce5933dfd3c8645ed2b15ef142fae25f5da38de16efb6e94eaeaa7b1557ea3266c609cb9f8480dbc36f38ec9896771481a873b013386f308efb1df83b62babe382b72aa7ea7c63e10fa03b30a1175e8e6aec3df56fefa7c82b51d38f89ffc94ca4daa0c97b88166e701b934a5ed9520c0afe4f7a5a3f4a5df78725a23738e7cca7771bf5556682fafbc39c2046afd11f712d0b5802d107f25d5ffd15a8c0cafe4cd833e5467256f40f25dd9727f49d9b617981298dda336057ced95d2d165144949ccdc35b13cb3bd7a3a84b8f438")
                          :ephemeral-private-key (core/hex-str->big-int "05a4b29dedbc4ca4cba0a7f2936bbf17169f50a1131be09d517fc08d")
                          :ephemeral-public-key (core/hex-str->big-int "cd1512314751251fca3ec00d5829816f3a1ec40e422ce5aa1519a097bad83f6abd08d532638a5c5af21894c767999d5012db4669b8652d2b3c01e39595de140352a6c200ac0f9d48e747c9e7623ceb0ced79e5163d760794d93ca2c8de4f777ab3f1e6d6a2abe05bfd9547748a535103608ba00e6b230bc702b3811a54c6656af2e1bbf20aabb10f19c9af302bf8e5c842c572b07561ca976046c2ae3c2f1f4daaa1c1f99d0b8740c96b96a6d71ee86537b6bdf6324ed69772493c375eb220c0e15083d0b72db53833b83718fdd3abdcb79234a9c2b508378abfad8add30d55b66c6ee31df8c9a0d49659f0e2ca069a1815a601a6763d5ebb178d15c164424fa")}
          responder-keys {:static-public-key (core/hex-str->big-int "78fa38d42e1fdecb1daee907385399a17c825dcf597e4c4f3483f3ed08bb24c9c56e738e6433bda1996a479e4b16bb8489c0a1583f711046af9620dbe2905a751624a9e7607b9d12612a034c51786830878ff0a6511e83f922651f56478b61c3ab8702bb952c341d9eba910d1bc0d4cf8dd59a00dc86c1c8528b179c15eb7c1dd3296d6e77e71978e3998d53487d6a8cadb6bf0e3a1068752a062d1615b46c9c5f4cf88d265cdb8cebaf523fef49b4e30a470f0ce43bcfab848ce79190afbd85facafb6ceb6470acd9d8aecca35d940a4844af064aabe00a784836f41ccd8550d6e6bd9d87028536a56dc32c0fdfd8253bacb7cf1d58b344b861f31f57deae20")}
          Z "5fc577f7252d75ea229c310b973ea7d8613dbc1845d4069ad0eef4c3f40b23906f7ad4c816000c5dee51a7d6fdbf8df6445ee6fed59c3fff376cd4769af619e012e08135f74c0e5f27d12e56be33e4297caee4a2a222f5bd49800dc2a14796390ce2024abae8c363860a650dac3d03ea1d34bedcb18bafd156cea147abde2aff393b5f493b7f51931249de8a11f5c149783ce6d70ef705e176c45b05b055e877c2968f43cd54613a3a8db9f6acf566895ffeb9c5b6338f2d08a22bcde6e6ba06c2977dbd6c256ed513a1fb10d62b124fe9958001b4de8409671820a022c54dabb6323162ef0758dc05e572967c6327af37aecd7f317abba271a3f9f5b75d8227"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4ed746d2992a7fc44ac5c5737c26c2827390305de55f469baac1934c")
                          :static-public-key (core/hex-str->big-int "0e0be2ca7ee2daabd637c5b771cf1cb2e5bcf000ef3f31576e03c98a3db9648a4019cdf1452eb517a5836dddce51d243d01d0c92323eaf78e8e7962f1d12661446c76e69d7ff196bc1f7d9e231ea85e9cfec9e803bc852dfe836c67ba43a42ade531744dc3f599de6750d91c10c1b004903684f5b0a56bea75c3fe0ddcc5427377aeb35b75768a9f2b9bc674146682cee88b3978acd3d9dae507bfc850b3495c0ddb5720ce7cb07459aee424683bb6d8348ee33a870b80edc73ef72c0d6367848ae7d8f4857491501c06402599bc0325b53952a3457ed41c3e4839a12ed9d31ca0aa1510e2b6291c2245fd36c5e02819b2589b8fc49c1fcbdcd34c8af2247d5e")
                          :ephemeral-private-key (core/hex-str->big-int "87b1ddcacf94aa83a31692c3d43596bc3e198b0984d2d62df12b5a9d")
                          :ephemeral-public-key (core/hex-str->big-int "25d70bee71a5c769f9c4f362f8d31fac6211b25d791c83ea7e8fd9dfb3b1ca2ec713964cb51808dbcf59c2c7ba7f669e451975c6f25bb8f4409d39cd2ef2b68b32ebd08356694ca5a69b67efc37dc44714823921967c5ccf4b5ae7e5335669defc6e6c6cfc2107da7cc547f35c268c99736bb1a70167142a22a894de99d52ad12ea2c09abab63b1251e430f10393174702169abc2a2d2a31dd077c6c753c7034cdfca2e67a6c09a5047e7fed96d5e19b080c56e423a0950bc808a6af6b07973aeb66b9b07846ffc44a4337ca0926182568cfb8e7274455f61858364848fa2eec4f4e12ac51004624efd94e9e14bb809add139e3a6a21bb2f055d263f738ce7ea")}
          responder-keys {:static-public-key (core/hex-str->big-int "9afe37b008543d3f5faab67e6ad76442f4c6f0108a97ce06437683919ab7b05275ea9182c77f5f2ca20e3faef9e3a38fa40cd4a1e88e156c4761b47e2047dff19afb149ae4eaf63906887a479f7682a605518c0b562b16e0e10bb0ed1c6f18075c35eb475716ee5ea3f1708307c36341c0a5cf3c8e404418e581da6b4decb03ec163d7ceef1844846252fcc9abe057e8e65700635f221c2fc9c40215e2e7f107564aeca6549c4291a5d3d8305e71323c079fa9e785335cca6cabbf56e1d1a810d4840f815b408cf044b2d2c685b1a7d1afa45fda34b7971106282622400f155b4eaf51c1a4e977ae179ed774531b0c2f52ae229522af5399a9583fb8ee5b7224")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "8fa805c24007c689739526997d692cdff9ca21252c904cef7ce2a58c")
                          :static-public-key (core/hex-str->big-int "45c8f52ef1f521368b08072b3fd68217a8540ad1f7d3a9d686b376ef6a38554c8e043dc2027ba09968d10a0c9fdcd45adc63cbfc913e6e18e642c3868ec20f34b332a6753f761f25092b4b96dc2a657a1c400f83ac12a09263bc2d75735b39bccbf55f1eb39009131322b89f21454565123e6c19f4ca0c2078c390a33e3ebe196f3554173ce754efee1b0780f96b6178ceae3bbeda4b1f49444bac53ab16c5c621988cfe7a2db982f4a4b7f31930d95410138ae42c35c9a99779d7184778ae2751f0bde57561adb43f3b02eceecd86c74cc8e94e767fae7c17bca4d9fe59468750b2038fda170f9115d3d6bdd8eb7e51790f456bd3e5de68469d145f8b666d79")
                          :ephemeral-private-key (core/hex-str->big-int "6cc0082139b8739233b3f1be939fb7bff44b90241638592dd625d1de")
                          :ephemeral-public-key (core/hex-str->big-int "5f1d95380eec27e4f38cff7dbc7d431797a13e15dd0f89bb0acbc35a6454368838c31d9c4871a6b5cbde9d8d4d11cff98224225a93b63f7b35bfdd1a3327c58350085cfe2de9b954d900c733e15ee170954128c8f5a2a57a707fee997152bb776f78a5596d5ec3e18d6645e318252945070cb79f4c0f873ca83ef2fbf5479a1dcefd84714c1cecbec962753ed8e2a2f50509f9252f996a1e3c47097adbbab382f0b457c60b001c0e332da033a4c819ba4bb82b836649ab1a341f4d0a611c75d9c564837c66e97e55fe018ac42eae2b2d55121540312493ae1062d2fc4fdcbf6f5fb39758d32dd422119ebcaad234159c3f34c6c52ce4148286c3e7735e566963")}
          responder-keys {:static-public-key (core/hex-str->big-int "bc4e89e5a970b162926c09e950d7f61235e26ba753d2789d4fca1c99e5873c4c3c4b2fb7392b47c047c4cce5df880572bc70b3987692ed248f2a923d97cecd3e171f58d524d27c3f36d190bd2eb899a53d72a76bcf0094ae4c281bd4e018bef45209d2cc4417856b73a945c8be9ffba500b0c4d1cbfc5300c886a1877efe80d8d65312f0d7fbd3f2f58ea5b08be241dd6904602f4699a2ea5732544d0aa41839a42cf5af3b5d6d1a5e7ee63da9483d077b8127ecab2bba6f4d053271436c8df7a6b6616402b191620f9b0f54d70ed878a42207df2315f1e438e473277ac157625644a279d94f7b186192bbe9aa050fa975ef274e1e30f5f732596787531baf6b")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "42b465d37c1d0328ab64fcd4913696037adc5cee5af66b6a2055ba5c")
                          :static-public-key (core/hex-str->big-int "4b615d4a2b4831abcf827fe1bfe36228ab0169da1cf7f32bc271cf9d68587433978de5eedfcef51f69b95e9054d1db472a47032ea80c9f53cd8888104a453bea37362d1dda006805e13c80769e488320e2de834a5d9857c565465d0f685054b428d6769ff1082b8abc3288fa57eb1416e162ddd63b87322f20bbaa886303ea2c81e813f3f223bdb279c1a38470e23bb9ff4a3328b0f9d81934f4b306774f71acdc0e260b63c5ba878f8e972661292ea09e53258773f5e2cb9c1e9fda4a89ccd1e7d242f34a32a891e7d47cc8da5239058611a204ee93ee0acb5b91a213d3eca2e2c5b8b1ab31979653ac6508565941cc2d07f3e87cdceccdfccb2dbafc0174ff")
                          :ephemeral-private-key (core/hex-str->big-int "4a6228904255fe1ed3b95769fdc143dfdd830505815c7bb925f18801")
                          :ephemeral-public-key (core/hex-str->big-int "09d3c043e01df5d8e362eb8f04d763918fc3888df0cf5b040c64fc58f91b84189458964299773e055d42f56a1ec27e4a6482c9acedb5468bdc3cc33eebf166965d2a8d3ec3b945e4ffa76ce3df45be58f9c89b19f1a956768ec06cfe52bd80a60aa1ecaa49a08b0079df66d1e1bd16ef3d5aaece8bd55994f2d0d29f077ec4d14089241fb8e9768e48b75091571ffdefc575242b3588086c515cda0b86decc3faeb747efba23f4e6a62d45f8a8c25044fe58d3789115b61238d2d68878f971419df232b41249ad919ba64b161f00f0f9575ac9437c8dc39e7b19b1a41641633219c76d8d99699ece66dc19251f1e3f5ed5b0d8657ea4e34ecfd5767655b0292a")}
          responder-keys {:static-public-key (core/hex-str->big-int "7453cc335b075db88097e399ea3e7da1f66e4435fe38e8b96e87cc95ff7ad68b22eadf7132fe2189d2fbb22109139469091809b9f3953830be07304404b6a0e902e08b4587dec09401761f842e6dd43a70ba34c16d93ca149c887913eabebab06feb68571cf76efe35e4a343c381550cd91c411656a41103a41c37ec35cdfb50c81b8046d749d08a6cca3a70b2ec75fa5de2dbfb401f644cfe331a9395532287bf9eeec747b707d7513d91c4bc0527498410fb135a464cda1df0b414f09669ec052844b802a49820878a5b602bbfe7d7c3e4163c2ca022b3d1a80678cb0106ab0c538c00644ec59dd4b9441c5cfdc82050f9e0cf9fe8c9e50b1e9036329cb084")}
          Z "6d522dd3932ff084b4276aabb36b5bda234d610a40bbad4fd79ac51f0edf6e7c0da75fe369440c6b8226119679598985a9967a5dc9dfb68803316a5d0fcf704713b22ccf885bf9fee341b775139891c583b20887769541583e390f7c1b46f4842423fee2c19f8f9d099c0b1afc0ef45a3b64065f7b17f2bec90972cef64f203534f6daf2ac89f10d08f8d136710917fb9eb4e8c410b90b42de49480e9f8059f7774a8b053f2ad49beadb2efa1939e6a0bd4ef0b40ad294a8d7f32eb405558ad1e22710f04f5636b074067b0310f9fe180408b0245fdbca0a3d71519028a467ca329ae5e29886dc62f6f9eb578632bb00a0d0d2306802798944941aa771c99d22"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "88b4076083a6b017972e94fa6ab30d3e7d3c0c6b09de52cdd14e1f4e")
                          :static-public-key (core/hex-str->big-int "189603e40bd907e496e7142a34dbc2f3be540d8aacd840be0137ee61cfcb00f2bc980b988d9fbb3816a8d9f7ea74778ec7c908f43243a26d6e3a88e06861a028605b554f38cd868bf228688542c30088d1405fbfa5ab2b42325c75e760ce6706776d4815a4ccd658af51c4a040460383e14fdcde4741c3c633872dc9e18de0543529204616b9235807a684f2d681ee23eb2074362bed96efcf253021c6e354350469eb53bd562f9a090b7e708627bf5b911fb66721762de8e1722ca5ff7dc04b120547fdaba664e5eb2b7f935779adabe3942a4c135281cb899e5d3cf2609f7772638dd99293f6b3f46060782c2f05a2152329e52a2167a42e32b5fa37e672c0")
                          :ephemeral-private-key (core/hex-str->big-int "1df3c00d4112d88ce91eab1789060b187672e225cb2d674c140c54db")
                          :ephemeral-public-key (core/hex-str->big-int "79035dfdb36fab97356e79c497eacfac0c8bc845fdb2d85bda87efadcdb6547175b9e117e8b547d0e8538e4b0039511a981ebc7600dca643e1de6e4b20ca6894e29667dce6c59e9803f28295aaf0d3543c36ec5f302610838820a6ff9139dd3490569c09887a09303a5fbb2b2d024e86aeb7528872dc164279f66be25aac673ddeb651c4d9ab593359758a26c7311527e2b50ea3c6886d3c1124a0b52e4ca1d9d7d31693f154881a2321eae4602905522e636ccde6a6ed5adf24ff8d8a3dbaaccfe62d231694c3ed8b093aad5857e6bd21a1f6597e143c881b096e283cba52715f433ad6d7d8335520fe35540be2e219c7d46a4fe9374dfc5f42a99e273fefb3")}
          responder-keys {:static-public-key (core/hex-str->big-int "2692733b7a6c18000e3c4371d9b1ff3508856b2d49de28230585c3b151e3658e9d4ccc1686b475ab5cbc9ea2e448409194f97cb4d2cb24579047ad1ad1aa3798be73563649c17cef0a3f0b6978a20f20009f7982fd5be08549a61df11a28acc0e05c32910840490658c93cb9bdcb50649bb72215c1f59fe9633db1a940203a91112cdb15caddb7fb5cbcc46d1f91296496ddacd6560cfbda5378ae9566e051ca4272c2e9f0b4acb1b9aef2183646689c6510252ffde8b2f04842111f8d12a68842e290e47eb143423844e77244273871b4b3a022a04088d4b41765ee4413381d579e08b1a69813cd781107078200804a414bb2ed51f72a87769059de7dd4e8a9")}
          Z "2743ffe823179089ae86ba79026cd0767a395cc05fbf295fdd7d9aaeb5baa249a95b7386fb3c00a3aa674b1f12c405b7b0605672d7e3ea9d8401847b8f03754ea60f49ff87865e2bda20a8005766f33368996da882f83cc2fdf330b37ed1a837a07e17de68a4d6d8bc21c87afeb22014f654d4ca675c272ca06e90a8a852232eb85e25078690bb105a16fe730755aa023f7943bad521675bfc7fcdfd50940748271167757cc37d0bf86c290bdeb51806bf00af8ce931c531b02bd2afa156207014c15771637a5c16202a91860dbe67b58bf24cee1fd4c821a435b86e8470a8c89c2ab433bcae92c67741092bc16780a5dcaf7e89c113d9204e535b734a71a2fc"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "68484c6a021147a242b8aeb99800dcc476b993c0bad3f90e06a95569")
                          :static-public-key (core/hex-str->big-int "9119f6a851eed091922ac1a76dda35de690bfff88f6a2f008b71847febc92a0be4e8b309c13178969e155f31b830bdf0faf456364595bf7a3dcee160535a8af91de20abb9004530b585e2f57cdaa15bf3bdcafad953bd0c2a9e6ecb691a7b4e4cf394a477a95b32008dcaf416aef3aa70a88cd367f2bca9fbf621d6a77a68198b18e69d8b55c94f024e0b79c0d3a1b5e977a0e5e1a100972a0abd212c55f9733a073c09910be0b4d71eb387cbe203c7db222e902d468ca1abc7ac1ea1117acc531fd1d42e51dc7e9d07de7aedf99a3b80f7184fe4ae6a7f50c14eea03a95549feb6077f9a4042df2a7696f91da37b88ca966189c47ce417ebcf564af4fa85ba2")
                          :ephemeral-private-key (core/hex-str->big-int "6c268beb94a0a35fe706fb5c17bb6a5435e485d4ba868bd716f80dc4")
                          :ephemeral-public-key (core/hex-str->big-int "480b9c4ec29c04f98d8f3ce35b9c9006c89c7a8b5793d24082215e2b76a10d5546d38f5e4ea7a287722e3962dac108cf7462a0be9492c97e74106ede0c3124f04ec7914f8d8af74f0dc83f2e423e8c0efdbfb5f7cfb96d4055507ed1d9ecb84067e0bfc0e2ff52bee3df8b439a826ef4984a96d1e8ca15a41013c8d1b0259610920c8b3c0470d927573aa15e74ac8b6677855831c225a82da330b90d4d792cee2c3df0af95bc2515cc373498490f4d061b6297238e4afc7370942f770b260aadf8bcb2f21464e2005ab835cdaa4410f809822db36dd4759f8fa301743af22bf82d65ccc3431298bd900703dad542a10f603b14d85faeed23ed03c8984f2bd5bb")}
          responder-keys {:static-public-key (core/hex-str->big-int "ab7296eabd8bfd82956a31e45411d7441c792b14441b83ff33ebe1c7ade4de9296b92b8f851d67dc5650e425791ae02452af24daf0e0cc069bca1a4095812e899b802530300ff890cf4c4b3cb1a32931fa40f8204a554cdcac878c1443211209e57cc4e91a90222c292b38a62a11bd1c335d37d1a33e76b90ff69a0861617885ce7dc5ecfecb403d74c21998d17a7ca7b0e9ca757c0e40713a9f2d3dfbc37525350f37103c4be01475ad58e4e71a5b0c3f1ab9ccef96b21494a048b4d57ff6f70d089ac5e728469d122c2180a5227c7c9fbc4c9b550f63adb760d004e9ed3b586d69c9bfba31ea5ce24511151ab3897ad45fc8448b099be55357ff93adf994ba")}
          Z "024428643425ca1eeffa342512d273e73296779790e0dc0387933df818614077c7d45b889057284bb5fec840a55513bfd5f3c05f7a29b6df08d5c72b75f9e2ae327ea756bd599d6afa61768a18e93264ba04e76d399f0df1c9ec3f8897c1126b9b77b507b723c7ca1385df630014416dd30b1e7906e42eba68da94868080990036f4ad4a24d8629e084b525b92c2ebce1b834b4254eb551e1aac463594b793999ee2f1b355317d7ecac92f8d81e04c00fd4baa722ac7266f4e087256ca462cd1c38c5023e056a66cc5af7872d5314292bc214b342aae13b5750a78fafb9a87cc98d9068b7b79ad2c5f640d40370cb7ebd47aa2ee666ee63d914b58d73c9c1508"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "17029171a97396adaaef8c194038ad3d727262d6a828b381999e70ab")
                          :static-public-key (core/hex-str->big-int "8cd09ef8d92d1342079c29f4e2c60bec5c54f4c9e70164815794ea9d880f2964252de797e8fb96e9aac53355550fb63772d6e08d7b678d5322332a90f4ada88a04160b783179a5945377c2ef47221b6825b8b80c8388f3df03094d2da5d52f9d3f488b46e08d30d197a9d4d28b7767a2d82009264766208849386b994842043257b23b2204582f7ca4c7f9e2058bd454969b8e9bda9a62c6327c43ccf219eedd5bcce07a0f3206d037787438d016cce1db666b9e005d0daf31896490b8018a86fdfc5f0640390dd9a070bee26ef5d22d1f6dd3cfcc8d2f784cffc9635f8072c891d54636fe731ea5ffa4797d284ea1b556c5abfa17eccfe7754575e98ecb1677")
                          :ephemeral-private-key (core/hex-str->big-int "a685a43075774b972b867bab7913224f9d33f187af7a62e1dd10b670")
                          :ephemeral-public-key (core/hex-str->big-int "53d705b99ea7087f3f58a91f152c3d4158dd3723ce1075e2c66ab313d437e9ee9583e9125e165b5a480397ebaff629d7c22c5d5ddc1c79cc448aad949082c1bdcd5616eebb2bafb29c0369fd4335bb6952142b48ea09fca59a4351f286f20b13e32da673c5ac7a0f035733056ff8c2ce2f5d9c1f9a555f31c27e298862a4a9daa76a4d9b8eadb5663a981d0ac14c6cb9b5770c9fb8a22c823af910a807a4a2f1e0b0011b3ed42ac5b2a00f5f2398fe0b359bc80fec227e18c3417c71eb6017f7e834257f95274dd3a997b1503a925174d22f481424d4840b02778e28f139896dd30515c03c7297060f029da596b8df89cbaaed1a9e885233cdc797a1c9cf186d")}
          responder-keys {:static-public-key (core/hex-str->big-int "0c0019f75f683a038087ddc1c9ed86aa5dad197b4cfd0eebfb8d6d9b6a6c1842ce7cacc648fc3297352956f520304e39e9f051ade904cb812d7960811e28dba924efa32afd8c79f34c3146057cafb82cbf7efe16aaf4233a6587f92f7ffbb741b2b4fbc8b2bdaf2e955b578b4490d8cf0b0a82a4e5d28e81e0b6c1e136e226b87c41fb02e9d09baae8885bfb2cdcacb299bcccedd770f0d4416f8539c85914a90343bb683db8d8b88b1113416a9819176bf2d5bd88a168195d10f0aba3a40f68ce888ed17019a9f2ac12d570cc518131004065225bbfb88b4f1984c46250b024ec097fe92da478c83cf804f911d2e447372f0b4e5a9f81efea9e76666acf1937")}
          Z "c487fee8de6d5543a121eac11cde9425352a97cbecd9f05ee5effce7227936f887415aa7fcb475b727e9a99fff1e8f4b90f9ae6b05a1280aa046afb469ff94c60c848f97c3ee90aa1b42b142535145aff619c59a1dae6e4a0a501ad3e405df8e6c35e6ef8ec691c5221cbc63d1364c3a79879e3966d8bb419595c30ee3f45984002f7636ec4a223e7a11ea3c957469f46e842ef43c0705c4604d2cd7dd0ecea61d8e55f5944bb4dde47f3cd493e69e29c4c76f567bed65200812203b66cc1cccd54786aecdc10ab618980c1c0230715faa67807b3711a141e7d37192c247c82ad3c1ed2c90e1920b9fb5d58e1b41f012f2078d482456a07430328302d183300e"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "a3e21ecc02192af14b684adfbe0fc882b377ee4d3b5b6b35a932e7e1")
                          :static-public-key (core/hex-str->big-int "bd11230a9d0666ee72ca46d34ab2c8e0c62366f0f89b1b8d65ab1192c510bc309112aa428eeb4516064e4abe2b97cda4e931994c6743686586c08dd6cb06420c006cf64f028eef9c89bc706d1361219f3a2e2278c9658002ca6cca10a048857dc80d6622fe20d5ba03497c74619a9675690d9ddcc87f53a36abb7c08ccecc1158144f350a4d04e44f135f66b5c7adff08ca4216d6d2a4a6a3e7a2f1b73a77da79838025a1960238409e991fa6a356e2493d851229abaec1959066fde3fd113ed8ee35bbe0fb078b5552d8da34322fc68bc243df32b499182971988e559afca0ded322d9b09f98b9f51579a8ead35e175662fb8e7c7a2ab7598f42bbf915413d5")
                          :ephemeral-private-key (core/hex-str->big-int "79b337c88e62236a51ecd496ae2c58b3dbbc8c4c2701b35ead486a3d")
                          :ephemeral-public-key (core/hex-str->big-int "74605bff2d085ec8737c1c2cffd7d91e67fb11ccddd8339956fafc13497515e6eb4651588141dd5c7b1e26ac4e7c7dd3f051bb4cc24dd6d74cde299a8fcf4f920a38ea9bd68f4d2e5c9d388eaba6cb8ea6f2ab90337b22ae062643f98b6047924f877b89b1c0b4e93d2776c1c15a09202bf934c23f13e16a8dd53158dd5420df4a9a9e57ac82f0a39d2594cd461482fed1f37825a34f62ced4215ef749cd4345e656d8d0ab3cb0cc66d3f546b3af51b9e538045fcf4d032e83249bfac4f457961cbc9a5fe3fb2c3f420817e33b52864a02a9851d7adcc7e6e1a02b8c5803ed07c63e372a0c11c52ab902c2f4af7a641388866832c781254e7bec11fd6b2642e1")}
          responder-keys {:static-public-key (core/hex-str->big-int "a571d84f44fc909d6427cba7aa88871550f2ebd5a16db1577fe7d3314279db351a075cfc876e30f4ee8e8056489ae4031f9570b3c6cbef0fc2eade0a2f87f9847fa3aab9b74c7490f99f5da31a7c109701ddc728432e1ef81b7a37fcd1d7d783f918c21331db546b82ecc6350c55feaf809a14c68af9adbd5df0305b7d176e64fe690910e83136122fe671437836adb6b2ad2bfd0099db3a83223da651bf947a0fbea1e22b74b765c24e8ed99a51315691ae538d207b251b9d6844d0c29b2bc4f1c81566bc6c0440bef9159ab4599322818714419c76798b53263ca1c1186a89878f8b4ee379f7fce593107788ffb79d0a192babb3bd32211935b0350802765c")}
          Z "2356cf02e6867447e4a300988fdb7d9f7634989415165f742e922580f48b6b3fb2797ab138ec1474a39970f669f59ef595d0c6655105a0c29ae78f9ff881b8233f21e11aa6c0e46a44203cf6eec5926ddb12532485b44909416cc9a78f57ecbb869280fe585e6a5d80ae7e28560aeda2e5d506c6448e2b341d917c5c627918b33558f8717bd18d8dea6dcf110b7b7234b85ca9e0ede02c682a84592a61012f95c78878b54da930f8c367806c0df530cb6a387d5f80802833715cf9587b702391ccc64d05bf5faf74cd3f46e53400f5a30cb91513fde0725a4c68c61c9841f77cffd2ee421a2502405c5d1a2d9bab3e0f5542ddf21bd47b94dc9bbdb2fbed5311"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "7a066945a66cf8761cfd48bcc42e35eaa8f77831f0582d24b1589073")
                          :static-public-key (core/hex-str->big-int "c824d63f1561dfb14efcf6693fa300ed840b4830da4f9f26cf4e50dbe4dcfce743eaa09a28936cc36ae306c44fe01e18293a6d9dcc5af324fbe0bd1b27d7ee5a282fe35d4e75532ac71820087f2bd42ed4c3d6b39a0b2723c00afd28dbb8eea3db2c45a9b7da414b1d5e78cab35002c3fe38a9908deba0cc7e1825d0e31df4802efcd731bcc80364cd2f42c5ce3ad0e73a8fcbd6bed916a8e669ac687f3b8456276e770ebd03cc80ae642304d254af53a08b8f02cd2eac8063af289e2f6fe036c082d0947294ab009e0189c0e88297d4ecdabad22156f49e8f03c1dc7ad897a72f1eb520dae28eed824b4b0d25c28894e7f1c3d6b3d05f15a3edf9107765c44f")
                          :ephemeral-private-key (core/hex-str->big-int "870f654299e87107bf79348e5674ae061ad50162013cadcc436d70df")
                          :ephemeral-public-key (core/hex-str->big-int "73edfff8bc0a8105095768d8571583ab76f55025e73340d66f6f01ef685c92d1d2d6c51f5437441bc0b1e8613d51b0ad70d10c5a39ae5974a9020c1a492b8d06c06b42894c9ec708bf85105ffd62c9726094ac332486d9658389acae7dc0f1a2182496410392aa31d72253ebad9436ac3fc85efc1d372e7eba396dda5c60818201d1495d4ff8705d89da941ed225f28fd7613c7b55ed382001da9292a49725a235c9f4f07edd292f58c30e075b8c40fc684ceacf9f1b2cffdb8e2fafbf154687c68fb2d424430f05a896b2f23e378ba78678b3cc899cd803692ad4b2e271c29a1ec4e639944e0c48af6645c0010ee797183fb8140c42893a43a232909adfad03")}
          responder-keys {:static-public-key (core/hex-str->big-int "5dda17892e1b63823b444e94020222dfa3f8d746877bdcacd4ede5ee7205e4a41b5a9ffe504f0ad3711d0644bb3c7ce4c87032de7874c5d5515156ebb69eb181fa828e6bf5aa1f9d54488c21e0faed960702ea807163db40b2eec6abf2a825ed0b966240bf95dcc37bffd186ff77b971440c2d7cfa3f0aedbc9c49a27e0692704b4c453aee03159f96a34028bd2463d96de18712921aa29ea57707f24487d0dc8d4baca79023eb35f7f8bcd172c8d0a7970453f4c9c5777218f6f8309fe90aa82838257d3d966970ba894265ed7ded89ad7d9ec21a27928d4abc5a5ed9f64fb6e2739ea64ca690259b20e023cc85dcb0208a41184ababf568c66612483eafe75")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "0027a477ce238ae040e4bcfe38df731f02be89422e8bcc8f824b9db8")
                          :static-public-key (core/hex-str->big-int "a2f3c7478829a33fae0426bcfe07197c04449cf13cd68629702f2a670579bebf02f142629bc7bf4e1d66d9b3ea501d66ba82a9aeff6f59af816fec9074b8edbcdd1ee834099b05feb69349736a61654af2ebc1425457b8eff34d331f00eb35f63cedc8fc9770f4ea00c3bf9839966f682e0fa8324e0b2e44db57d2dd9cabf05722846a355701d253b7c6a286c832d54d1f224cb7565734c6134b9a6e79dffa31003ec6f965916eed65ba1f4be5c8d203597f6f1231a1de582f20c991ae3449868c898e9fff694ec614dde8ef37e734a2843bb2a21b6e41b5e2ce61760918649935e4ef1211401aa59bc170c8eecc8ddfbf351017ec7564d38c7710b0d5e802ce")
                          :ephemeral-private-key (core/hex-str->big-int "4e67315e638c2f672144e6b068b8b23df425ce9786df3b17b9d3d9aa")
                          :ephemeral-public-key (core/hex-str->big-int "6f2a18705a5210983e683e1135917104aa986876b7ab00416123a423c8b614a9296d2a5a31941824da111b62b162f979c830fec74ce273ebe9d864dd2ddc58c336b8d3d2dad31ef481ba86c0a6f2fb8f880a1e9f9804fb9c43a70625c61c9e9128be2c7ed2f9ade640f5e9ce3e6bd5d6830ad6cdddbed351c0e26f39e0ccdcee59995dcd0642944135b1876709b1a9fb94fe25db5ed7dbcea35c2f7d0fbb80563d7b1f6c87f19427e14ab1b31ef995d731f374446205521454534e2b9eae910b064479b8459cc008ea078e9271a886b85b06a5452f60be214a42ac078d4b7b76bdc17c4d8f6ea679324f153c5da3476723f8023ec558469d5d5e4c25d9b31009")}
          responder-keys {:static-public-key (core/hex-str->big-int "1d4d0bd9926ba90d98688d4b8cdd46c43a592edbdc35f919c44f7bf94165b24c8dfd4f167592da24f841fbc474d6e42dc2fc54c32e4bb2890f4325da0dc0a19e4007037f102e938f9502196a323b2648fa768e7e2afb1c5341df294d78dcc09f82b32592d1a836fe31637b6ab8920092f7cbda6c99f6f3492cb340d5788a296cfbd1321b1935ecd0c9f1e20cb1ae8c249ddbefcdd8c9ef54bf1d3866a4c1b93a893911fb6ce4ca6ca83ad8e0c6c5284bb570a6fbbca984cdd87c5595bfbcbf41a4c00ee2867454017721491159eb9458668b71f050c8e155f33e62b9d06b21aea69dfa146cc04349687c677bf2772c50fb5a25408eb5323e9996da9489d8151a")}
          Z "8721579c1ad3401ac4937958b0b579dda82068ee3a636f84bdf49b975bc65f01e95429084e2e9982c8f0d23c98ff734726bf554a1c699ac09ee8268364491bd434870ccb0d00d96ea08498928a220086337be7e85d97f8b17b63f2e8757e3f62cfb7dd4fc5d2bbeafffcad4da7310488b3ee888cc4a55a6802119ea3ad8795d1894f074ed2c956bb0fdbb5e7582f6019ce4bf54d3e164250ca71720e553fbd593f3beba3f5f4ee86c4de998106f95b62e7b1674b3b2f0403adc3c3fbf9008a04267f818847d229d58fdacdfda9530ae0b4d7214e26db4e7e3dec8887e934839c18a2217ec516e9a82eb532a808016462e00ba9387b17350e21d889012234fe60"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))))

(deftest ffcmqv1-nokc-zzonly-init-2-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "ec1fac742dad74ad2fb50977dd5bae3756322cc1b0d67316a7359233ef6530102e69f9293807c90a3876a696ab00a97cdf0034c9e3147c2f4e62c23069214fb103bc08db06570aff956e4241e655a00507a570d778bb0eff89e188d75161b0a08dfea5867d0b246f19bd2d024e9054dafd3bd78df099d54ba0564ba7d6950076f2a6228d47857d1cda16c5b9aad0bf09cd4b9fd353335e4a005709c4e946327aed93fee2aa6a95577226ea034b3ea29b91fa8869d49141adc43e442e2b1e0275fdc6e893942ebc820d02656b482aa9e1d87a7224899b0ea38546fc8969be56fdfbad2d3a675d3aafe7175be9083937842c6de220acf17e2d4d6cfc403187a621")
         :q (core/hex-str->big-int "dcaa4fb0024e766ca5870af0ed211d2ada29d3cbd575590f1697e534dbe5cfff")
         :g (core/hex-str->big-int "7e3b1f0365da3792b4c822dd3add07d9473e9f7929e68aa8a3cbfbbfe565daeb93a6ede1b2bdb2116ab11bb809221f1e243e39ac054326f29bed3480e5d8f6f96956759c5c68d2571e5a58e14c389924538847d3488ab2eaa2fc263a90d9eff0d8e21925e8ad919acebb78687a6fb4a4d1188a2174e4026abf88be5391670de6f75d72a29ade7133e3bd64452794bde4ed2dcdbdb655d634b5e2b8378c9e59cf09b0c8b69d4c9f3c694c9ba04d35501ab5dbd83e0c874b8bfd6df92f3e828ee95ed0b6985be74472ba979994b724512c47b3afbccc5a99b99efe1e4756a2234e2d36a60ffb6a04652ee52fd0c6caf61ef2705e73e06e9420e54c111386a5f3ec")}]

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "aa3b399f8e1d9edf008c2002bad3509989880ab134ffed96eba5d56f60d1f1ee")
                          :static-public-key (core/hex-str->big-int "01eeacb352ad3f4438d9a9a9518a3c5f529e8a02dee32822266fbfc4cab02d08cbeef6805cda16657bf8120e93b5390776930e5f326c3c6494f14adfcf114795ff018e9fa8a7deffcbe8179df3123a394bbff8aeeae4f6891ca00bb0f6413e2f679cf73cc173447af868a008bef41cacb45bb4cf87f7249fd6a9a422d66d7aa0e696818b6a37a44f25cfcba35afd52770c1bb39f5e2cb33078b2812e19ede286b839c6dfeba1c47b81a6961b4099c000bc53d072ece0e9ab89d5bf6d499c2cd92709fa4b044c05b4d812664d537dac47b864b9f81eabd4d450d393d115188600ce671079111bcbdb946676c1d3095cc8b9639c5c91e22e2555fcccade9a20abf")
                          :ephemeral-private-key (core/hex-str->big-int "a99253c82d8e469238aad095f172a45306c4dba47c9777bf4e2ca426f6d029e2")
                          :ephemeral-public-key (core/hex-str->big-int "98caad1e5db63de6f38cba0b14c603b709edb9034685cf0a721ba358bbcd239623b4a47b568380378dc23cf00a0ef52c5505debb5af0a7449438564e02ef6e6b10e935c09a6623ea09822b8a54d8872e9a1fcd911448762e577cb9528bec57ac1aa6f3da6cd3332f919f1df298a86f3c46c43b769b9f331285ab40105e03e95ff006c7fa620a943c0d86159cd7c7d9a721e11d3a48f96b4822c5cea850c4e27d7bab57c210103e3d63c4b79db95af0c335a9d606390116e337475809e055a29fbbcc9af357a973b6d65aa1bcdd847dfe836c389d137953f05c410cb37f7a48a8730633b0f0836a3beaa76fae5474b552c1d1dfb14d46a3c0054b27eb34bbfa1e")}
          responder-keys {:static-public-key (core/hex-str->big-int "bd55f48442259f3f84e445a2cd04c95b25b1f0653e2ed912e6dc1ddb75f438d039f3ebe0956011fcf674de8a493fd55a85444676b0e8e1d61ff3cac76a1618062ada9575dfaf4ee0041bc24fbad9c55626b84854e0ab204118374aa8a1a953a71373e3aa352782337be3d3adf754150bc36d80a34f6e3ef8bd402dc46b38064e1db8ca40d59a1d3705612c7c077404207256f32d19b951e88adf379178d43427570d3cf2a4e47e852aa2d6ee19559e50863595f87b9c96195f4608197e00fb73e12b96109602e8bcb62e181b6769b2ef4b9fe660539862b0f3151bd99b9611cd47f6c4698119b8d7fdcb00029fb4544bbffae6f506149f2178d35ca9c935dc2b")}
          Z "ae03ffb06f874a87a9903125251d2f93f167368d8f65682e8b7233f2835e71191ae68711c70cc6b8ada36c244ca200f61c3239473679446bfd43640d7bbe0b9ce66019f4544d9045a9c050c73b53fd0e0cf7fc17b3adb7c465121a9f405a5b9bd9a727c0672ac37ef9d0d1cefbb54f91c6bf874a2b0a2b5158a904bfcd491cb3ae44ebb5ef475124c2051375866282f8939c74b4b3cd90adfacbb68109a2dcc1b8ba3dc7811bec567c8bd66883593516a5a40c96226464b78d6fabb3fd50b9176e69a7a7a1155e2f5f08a57dcab911b9a87c71fd727291dcf9720c4f67fc58dd3beccef590f02201ae4f22a6488822ba6b50e289cd352134b803c8db25f3349f"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "3cc7958a5c51e21188778eb8e816b732b85b272d675695df00273b76c25aaa35")
                          :static-public-key (core/hex-str->big-int "499785aad3caf814b1cbfde3cff42b9ab035fa8dc8e0267ffb66a383f06ab70294011e496fa5439a7ed97a70e5267782b79362221aa77dba297b464368f69422497409b5996ffbc450c1f33df361d85d216daff2585d4a25d28b32805dc68b075dcfc67afe862f70f4ced738c1dd49af38d3632f82b9c1956ce3067c34306c248d2475bcc8a828e1c0853e1de9aac48d84c3e67870b0bd1940a9757e8d2a3642c58f1123b4f679221675bab35ad5b740aa2b28d7511686b9440cc836b1b34bcb73d82d2f57d482ba9f265179017aa138194a6d02571e859352e7ee3811fb5b53ea893997ad97f3c2d23bb614bb7e58aeebb4544c2e975c846511aab01d1f97fe")
                          :ephemeral-private-key (core/hex-str->big-int "86eb41631200fed59c967cb445e02d879c61f52b82f92b1f632d43527d58778e")
                          :ephemeral-public-key (core/hex-str->big-int "8a947573c4d550a1560ad35e3394bd6aaa56cd2bacf2f5c3042fdae524ea9dd802686398ee22d8987dc224b6b0cc6a613d531f5574e50c166c2755a3096197b8ea5e03b03b3e9a7e0419165b9959a239e49c3a1066da7bb3eb12bc18bf3b2bc52249f672a39329bc76bd77122b20998529d47b012525828695219c0d21eefb64a79d7f6eee8edf650f67f9918bc639a0e512b0e83aa56754b9cd2645dfb46a26d3f9bd549412f9a08a2da79d0775ad712aaa95a69ba603efc4f65536119fd685dbce366f3899b781ff90d000705490bed6670f5fa42ec88369e799fe43c015d10298c74b48ed521f53dfec0be16f40777dd23fa4b96ee01c28f58216f073eed7")}
          responder-keys {:static-public-key (core/hex-str->big-int "accc78ae3ef126beb1d3d8cfa48d11fd37e83c422660394b0d1e7990df6ac54a960347965d7c68ef3d9d233fc3b2571d12fff9a737984b884cc1489e0ef2412fabdcdde7e3de5bbd1a97637bd13371a7532c5e4cfa8dc02dce5d7aba7ee40db6dfc3f6d960d5462db0654f97c4ee1dcaaacc4344925240ff9ddd76b17a705e3705adf0ed37ca32aeeefe538728b68d0263dc0b66a18b85402b5f9ea35f035d817fd9b92b559d0c76df3b4861c70154ebf72c15fab5c9fced786db5fcefb7a29094f0c57b2f78266cf411eec5843333b716c8f5fcab87710a5488d4b99de2eb71e8c3895554beeeba098af2ca151953fa6d5699738a418b12511059668639e187")}
          Z "adeee4c3fdf6610f9a03928358bb70738db5349062b7078c170518f114a6f76056109f1ee41bde543128fe4b8c365b2f8c11de2ca3c9287c6b50a77fbc60a31841451d56de42f3a8913878dbda91907c1384c50d14017b357e2c01b1ab1a24953e3aa5407f7c3370cd7170319c31bd096e9be41d1d17f631b7ba842bca30a7b4a77259fc49f7fde2abeede6d3ace1aaa51cdff2e772fde3edf53f013d21fe233f129980f7ffab9a5c9968f0a3e4f329dd7252e296afe35ce623b4675e3afd44ee043f262231ff5f3ba2c4494fef49532022ec223e31e6f2364d87f2ad81a9e66d905658a0fdb6e8db9618233f725c5d1d35ed3b2389ee50bd87cd8e77f01cd98"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "80a55637a8ce807654fefd8e0e2e4a7fb32f59ab77a4c5f7feb17b33561bec47")
                          :static-public-key (core/hex-str->big-int "6cbd32dac3ab90ea5e70083ffd17b69d58e7774144c8fd12113460e5bf96f4ce3f4509bb7a9fde1a99969472ed5f9823c075dfa8c20f22366fa747e3f7048b8168b61f346853c3bb7dd0057268a6c56cc8fb17fe2f06b19ed89afdebbac07060adc5cea0a2b9e6a8acf03ad59f59dddcf7b60a82a3a6b290d37ccbb5e7d389b0a7444a57f49a147d46ffc4071e08a32361399db3faf627b89730c459e8b253323c41f07e4b9a722ba6509e3fde8f7eb62b6f5be17ba0bb36b6431fbce810243328cbd37d3f8ac9942e5c8e027559c42188d9249e84ed51caba296228a1b50d293ca1f2f289aa2ac779cf7d727b189c3acdc8960efae2959b099afeae1db9e515")
                          :ephemeral-private-key (core/hex-str->big-int "ab076c24e2e2451071eaaa5af3fa9d63408bf31036b0a7500daeac42437ba4de")
                          :ephemeral-public-key (core/hex-str->big-int "e4de7680e5dde137f65a08b326c5bb085e9465050f71d121522498d061522d5676c6cafd20cabb12dc0f156f7ff2eca728030d544654acb4e9b3a8296f01df5a2dd6f2a4abd6c63a3f91d2bc6bf041d267c46ad8aeb3ceff88a33a0b5ef8bc0335003f6c0bac09cc95f4ec9655d4fc41d3b573e78b7795816be60e9be2fd5c3ea2f0ed1e51b7d50dc8ae28808015d8213c49954c09af5ecbc76dadcab1fadfca377d7adedf148049d8e0fe08661c464ab5ef21a0fcc83223be83800582b7c2577f5a4483893a96bebac54bce512860feff769a35a320c893881040acab651552f53629e88eeaeff0286597993f0ca3091810393da84911a8addcc79d36871097")}
          responder-keys {:static-public-key (core/hex-str->big-int "c6b4a4a24e5a6316b5ec62478c16350f47f583a00373522c9034af6936b8bcad27a6af5e2c34bbf44d03ff51e9dc8b1affadb504f68661609676a905a14d6ee20cb89233d026313c8302c333212a3c9f90a041d39a5a8296663ab3ad4d1812d6d7c00ba30cc978173c8f00f83cb62a3bc70d39ec014302d85518ed80edeb8e34ae3c6dd22d9e141b710813255f66c2173fe3c7a89747f770f9233d54c500a63294c68f0f44ba90d96f2a15bebc22b47bf4f76ed38e7b49780802b61bc1a79256e4038137eb135798485053ef3d3f56c0466b55d15d2d787899684ae25837dc8ef104337f3fff6572801c38ba57296aebcf3c56274dd20266b3d8236c99f26d00")}
          Z "3c914ec81b8cf6c5456a9decd9a7b1bba23ec0ecd2611b9caae4a7ab9da10864cdad4e9c04d167b5b91fd1f1861d0024a54b94a507294b2e8082d412afbe75afe7f9ef9da95d4b6641a22b1b44e7b67be5e6480d98ec8fab0cf9fe7d2a185653b8da24f326c2406b6ba6d42627004aa28bb5bbf0f1d8808e4b5d8cbecfa2e859d1e937a8391b985aaeea182fdf5b38280b0e99444fe3279ade614540e2b4ebcb1d9ef7ffc7e748e5ad4eff95c9a773f7dddd7ac95ac76dbc81d3eb31da74dc8f6ed3d76a2229199f3a5c6a19b503b55a1778fd3f1403ebc3e9c75dac1dd8dc52f20e51a8eb7cd485cf22b67ee456354073c1cbf9991f5ce2c5e25d66df616d01"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "44cb7605e11da327566f9a6bbb69b676dec9dd29178a457978e9e47ebd98789e")
                          :static-public-key (core/hex-str->big-int "2a61509fc840b4e38045c415477cb53177aaa1830b3084da7f284ac07f39f3bec86b63e8148d9940056844172a40a7175ad70911910d6306fc7517e3c13c2906896ff6b1ad2403c366d97533900496c6ad75b135702aaeb037eafe8510b465370d45e5a8444f82ea403202a59d3b3381514e66c05550485b7c72b32d106b5dde241b10052e13a15fb3a3a0222387d44879355ee18648dbe752e9fc79bc8d89974e790c503ff6bb7c3ba6740e7a239f730e37238ffc67c55ad9fc36f06e4e757e604ca1adf14989bba6e490759f9d9713e9cc38cf9d642d3b2a338561bfc458628bb192e47a720c1288aed41a6eb658b1ff2ffbd3549af96bd3b17ed5b5e37095")
                          :ephemeral-private-key (core/hex-str->big-int "b6b51c25b7cc6840ea2da2fbc1456d082db95f251fd7c87b25983f68356e1904")
                          :ephemeral-public-key (core/hex-str->big-int "2db78a3768699a097250022340f2807fd7af16aaaedcb31d2f70a118bb184a136e0cbeba26424587d9cca83fcdfee916c4dc9072cf48dd9eb5a0141223a9e1ceb69e3403102a63f5c5a69c9bb4e44cd4c8996ca9ac9e79be1dfd0767feab33df4176c4dd8b14c0ea21e284f402407ba4b18536276ba86e1af11babf83da7ce9b6f6f2b0ddfad97db183c69cb56f2a73ab38a0d5146e06e557b37a4c6e9fa8f24ee778e13991b57d3638a3e32e15323f9e003ca2e8d1a9c085d4c7ea36e22208d16e156c380ffda4e85eaa54e612a88ba142baa830d74c6f6361ce6b29563df8cc4d3e137fa5fc88c038870d4ba1b159d056b8655161a45430fc7a40b43c32d14")}
          responder-keys {:static-public-key (core/hex-str->big-int "baae0e7235dae45f9021e43b592e1655c64aceb2b84d16eeaa544c46217e86fccbe15d17f853cfc705186c3189b72dfc3d3577de7eeaa978d09776a3c7d6d6b2605aea93b7fd61a3dbb860ca94aa9be9347d83d39135a9a10defc06f18e19036a06755dde496683fa7fbec04fb586f601f34211f03e4fd5f6973b567a2d98aa55be797c22bc6120561607f0ccac01c24da4a9807490c015363aa56019a1081088b1f9ed5b0c4d2f205c2ac9ed1a97b879b826961fb9554cede8fbb95463e1ab07ed646a22a916c2b0d8c2d62f865de8e41bc16e3a205559af74487f1b31c1c26b5013426c1500fee55ed84e05da536e591f5b9893acd1796472c10771df5893e")}
          Z "366984c80b43a15819fc8557fd4df1cbb7654312377edc3f77a9d465430414ed0a548a8cb48261b30854eebc15e3f2d7cfc3189aa16585c4d8a423252f0fc7503269de2d455786c3b0420ee6b3c91bf244fd71b796f9364ba7e6a0c42b2e8986ada63be65b13810a9fd229b033579e572b9828c5f7382bccc798573dfab89946a9c052c768833382fb7819b8c46ff859e7f3250166944a59fa6be4658a89f3b269e98785971cef2c772e38f3485936603e6465049f159ba67118badc04c6e2479db81d9652edcfab85309c0c5a0904b6e5ac2121d4f6948d1bfaae6b6309161bd2a866e52ce28373c552b6029c4bcb74033589fb4396bde5e410aef457be3599"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "b7d4c9d52d640da581618ef0759b96be11c192deb0d86026c03e13e7290cf787")
                          :static-public-key (core/hex-str->big-int "70f9c9086f7d3d5276314d8f7017cf70bb6af7c81638fa61e274c89e29223ef188df3f238f28b16098f95f1b2e7b9b31beaf26645edb36138007d2fd05c3c913b3a9b41166204604c48acad0462834a5c16545cf66425c2b5304308c60668b5f4095a2621ea09a188522efd28ef8364dae2c2b7499f8a8f9c9338699640b095dcc88456db609d0fe563b6c835f3f999c1b7ada7a6198b571761d17a0cc5b40a3a1cd5716063aeb1323c776339cbc9f2600b63590280eab7be45fc14552401d0d3e9fbee47e98af4fd9a91bf7c306ca41380545b5766fd8b873cb25278323bc35f84fbda475a18e0749035be46e8e8503787d6d85f01243ccdea2e96080261c2d")
                          :ephemeral-private-key (core/hex-str->big-int "5ff4ac4421235ca24b7fc2125db613d53253e73e415fd1ca403a54f75c65f1a9")
                          :ephemeral-public-key (core/hex-str->big-int "9510eba5f996b08366dc9cde0b3af17aa3cf76e7c211e3f2958792998013b755ee6b3ceee2b9d3f1cb5fbce32d12eea520db59a0beba1e6d4dbe54e2c1787dcbfd26d8fe352c012bf755c057d1a1e8e4452f47ce86a8b775a485cbba481c14fa567310992779ddb84109bf698fc3c7553644b92b50a9261d9bf2ead3431a1bb9eec84f520dee9ab50818e0f28d748f012b91bd6e1123167e83a992d0ecde61c9b4a171c1801d582d0d522f7f7470d0c45e1d92ae249044046118cb704ef2648935b37224bf3624a7e479b673d756834739d040121779036a99c6a5b5173eaf8ca95cbaba782c1a48a50b49b209ba9a2e1e19df39dc585ebdd82c6159a7fc7cf7")}
          responder-keys {:static-public-key (core/hex-str->big-int "b6cc63fd23aa6a374fa302f139ffa06a325e4d8b21fecfcc0fb557f272a27c61cde7b5f3edb01f30e74d80ae98c0b3640fc29ae7fc2bef4611418e6631136b5dbb99248c23b21b158bc4abf1f861d1f2299144d1112ac571ef95db6c16eb16d0aa92ce7ef1d935ec023d99e8e1a33bf3a960849a0e8840c8fc4c01e7eaead64503fbbfefc2851939bdc3e16aeb5fc506c748ffb00900b0ce23f9bec74c4ad991ac6b0b3771b080e823e403f1816b281a9ff8860d0abb8f4627b798ed59e49143cc2e0c483460c7c908fa670deb7bb309a0f33845a813e228db12af2b6fd0eaeff9a1e7401ca83b6d305ac88510bc3ca713181d5ea5819ebbc958e649b75d7f55")}
          Z "ceffa6f9e6a54139a2ec68860a27a8947cc268248b9cae8f1e192d4d6a3ad2b5a0742895b82cc315a3944216ee756896e8af05832a73c6759189a3f6b36ab478c618a1b54d453d7abae63cc136443fb74baf4f6e49953ef4c8dbaa2e20d5ab4a3265967d4db7a4551a222e9c1c029f85995c101fb907e20511028e4c2dd7601a5c8b33a6d0f168f7476d4e77a0435a9da169c96ce3fa390986f1821ce8fb497aafd0993a18280b9d81d742ac7fbc5836b58660e24e9c2bde25e6021211a2ef4b33550b03b1d4607fb5b3a781c74f75de628e46e236281c900d7ffe1e2f34192ae12acdef8f3c6c168939ef8ee20ebad2919fe3dc19d8ea446796f8c6a0f29b42"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "9d070849cb5a9caae80becd13cc57e76ecf6d16d42a0775a9cfea447715f3654")
                          :static-public-key (core/hex-str->big-int "500fb6e7e92a00765ce627243d1bcdc115ab1575dfaf4d841925b754246d574fb79b1d7518b0ef5efe9277e4da90f0515f024042f9ac269f14da2e6dd015364a85935038e71121c986b14e6c7bd04e0b8baa42d5fb69320e9435a043ddc8cf734034e23fa3bb09ab5ebccc05aad0c0c916316ac3a16083e4d4027b6dda69d80c9156cc7df0ed631f41b35bd31d4be811f21e522877654f0e69f461fe2ef75436a4ba9a9e72853fc09b9b21559080bb15b66408daaece26c4fba8c576e57ecb6906eab9c8a0ffbe9aa78dbe5e1e0a367e7aee284214421942163dd24471d9f453d3912a634ce95247fe2a5dd393bffe9e7cda815baeea9a90e27466ccead26206")
                          :ephemeral-private-key (core/hex-str->big-int "8c67127f0395d935c79f13dbad0c39987d176fd1865339f12b8262ac18f69bec")
                          :ephemeral-public-key (core/hex-str->big-int "052f5a4a6e5ae222f9d0917a948e72d2fd8791560b155575b8ac4e6f3f31664f185c661abcec51538efdea2e9049022c77781843e201faca0d436b113b9f0edb1f59a4ffe485d216d9af8ed8e79544b32a825bbefe23980af0bf93224413ce500deb889327eba028b1e1a713dbebbcbe7c242abef0b369dc869d57d09cf4713712d630b097641844a701ebc875e1151cadf40c089311e27039e46c425d34a1eb327729d0ac52dfa4c0ed4bd37f0e78b8c99e699efd3090761ababe55b28305637a782cb02178e9662de769912c3230fbc55243a7bf3290e23e5cd7c691fd1c2300d5819d88828511d7ff57c9e4dc73dab4173331b70d37eacfb77938ab97ffa3")}
          responder-keys {:static-public-key (core/hex-str->big-int "0ea13694fcb55c0c927b2351765b7bdf174473aae8823aed6fcef8d9b4bc3414e809ffdbc104e99db17ae3f4afee1ab662d6f61a2311400d2065e9f8109287d0d4da72e819f1bc482fbac4459ab6068d1b69dea60f49909df9563eba035dc2f7e312ee85e07ba174126dd8303cd143a2843cd852c036d57ebe2749c18ce9b2f93e172394355e6e069acdf81be929cfc95a68d0c26380b399ee3fbaafd5a148c7f7d1cde881ca17d4494391d22f2b308ca9758f84a0f81f3264b428d3907c58d2da5d126fc1b4e2dec30a723e47d7e72991a38497ba7fd849d0cd9cc937acb5c9f7dee22566d0b6244809fbe147de6ce4febf35b5e023e79c4f6fb16fbaebd63a")}
          Z "753656255e8f670426aaff8320d04874a8958c32d207ca6c5e254768ade46edd2ea4e7c6b32a888af93f57562a70122b46b8ef5121bba247624e3df51de7a86ba11ab7b8633ed529b2484a511cbc41a2f5bfd44ff3065950effadc203a664dc1d03b7ac8a4d455b8ae0f893825d6fac9cdc44aff4f747e4356518ac0de7874d0f3aac8ab6cd5c55915924db36a6ed181b822a945ad8f9f4cf62cd0db304c4d8b1ab6960414244646bfc785f600b2e2491f759d7d3b6ac03d98eba4f4c335da7215fc68b5b16041471801c79c241d62b1589a4dc50aab6b79991f2dde572165877ce3bd89089b4a73e2181e542a752883a44748447b51a619584dcd3f121bd8ee"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "57da84f1894884cc690d85fae57f6993bd7c0ba67742430757a37bed6beb2a8f")
                          :static-public-key (core/hex-str->big-int "5bdf4b82c4973ba5b0f94450ebdb2c60a6e955b540c5669f3c1587b5ffdd0b0fdaf549a3ce8a67118f31935fb180248664b9c2f0cb2e892161169cec618efcfbf64ed39ea9adf31f8e4ae391dbf0c1c8d00de891977a5fff4e0e39899f187af563fb585fd72433186feedc4b97ca9a18dd8c088d09db464a9e76397268fc36e9db0f5bc7f37b4c67b9e83164c742364773a183c6d0f69448988e0c142712dd0807906d9fc64c94dbea520109b31940e8ba2c6786f0b24ee36b9d1a12d7d52593c0c2cd967ac3627ca522d710b68af5457a34009e512b2fddbd77eb13dfe67e8b2ad244a96887c91d76b553c4c257064b4f030348538e8b5e139c70b10b1078c5")
                          :ephemeral-private-key (core/hex-str->big-int "0429309b2888c58eb265a0ce676c21bb47de2d0f31d1a2580710307598b139bd")
                          :ephemeral-public-key (core/hex-str->big-int "26e551a0834d8c9748bac1e6060069b609235d3e8baf0486293b73122e09425e5b522eb5bff7e6f5785f74020ac70b420caa69e57f87ae303626c9f8af4d450d7b5dcbb19a98805de29111a598bb238c09f06f756a4e772723912ab051e13a351c77ca7c9a8150dc3915f37d45faa180b191ddb7830c43863786b8d2638e5d27e291a12f2d699f821381706a750d520228cfe2f473ded4520e0a81119375e52e3c483d6fa4aaea94b901c63a2fa055c3bd4879b38f5392359a3af24e4c92ed5840fd0b84d51e76ceb948e2df4b975e819076a152e0821fcde433658a979980e84a17c76384ddce3fde13553f924ebd12ed43dbc8967cebf4918f71d621890a3c")}
          responder-keys {:static-public-key (core/hex-str->big-int "12d103093b7cb712a997e47ca44c34f318a6d7f84acd0262c385fc6ed0a74e6e2f9d3cdbb543d81ba85336415850b9a53c17991fe5ba11ddef6293b63bae17bfcd4aa9420b8ad206eefcb87d69a75e3e7d9bbaa896a5e318cd2b814627d027fb0d01b51a02638bf68c0c2d6e298d388bbf171a17153392c41649b47efc90e3770087caf0e9fa437ffbfdff19b8f5c0eacfb8c077839788517d80e9ce168ec69026fcca65e363e353381b73e7569a58983594f97936f1dd02c4760971867374253e030d0280d9c7b2765be21a6c445ebee09c531b717d719d9ca054430ad02f74315692253630bff3e017025399032ceb085c7b0930d51034960f0806399b6b69")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "6e151dd5f154b2b1c6531046f31418bee13ee1763e976c8465757a3aac292466")
                          :static-public-key (core/hex-str->big-int "b6d83d3f4f54fb5c2684e6aa496066f463624ec61065f798e495bcf6fa442537079e0dd52b823876d822d53ceef6a46c46ae8a47097549e1b66d41b88d981eb10cffa9e4e68fe3747779058bc729f7a03cf8df5697e01824ac903fd562eeeba14c9365d016e3b571bc7a13589f87b5bc95be80b1ea0e2b10f1c4a5fa2b663d58501c9ee0b3f9a094c2b0c0e1807d60baeb8dd3ebe9581d9623e029242fa86f40b10d9d9316eba685f2516ffeea938927569bc720c906c60147daa4711b1a72d27586461c70bc5d71c5ab2b92d70ab49e75ccc6c90d4c021969b5b34d3637259329b2e2f222d8b99a9f7a758da95a504c0111a55ec15234a7ddcb6af620e99c0a")
                          :ephemeral-private-key (core/hex-str->big-int "9d80ada1509269e0f9a2f52ee40651b0c5ae7225ae520746308e23ab539c25af")
                          :ephemeral-public-key (core/hex-str->big-int "a624c8961406aa9e6ea01296a94b36933d4d4e9dea3764f91ed6deb0138b79507e30984b93e9b3fcf2b5caeb16528c87cf6083907bd21607f3123f5869148972ac8edb93da45dd9a697906c6eab0533a529706517b2a69ee7425305115401d62a88507012a3b7c7d963670e20f52f902c2b6a763501fbc78299f8ca570dc5a7277ec1de66777c6614d5745a275e765a1e159a4510e60864fd42afb9eef7087bc247101cba0e7fee91cf5ec668c31fa207e82dbc1a477fe34fb99368ba446a3d222f760e13eb72b49ebf92ef5334606289bb002e885d162180a963e25f29f4ae0ecd96450a00b6f8edbdf5ef2d7705f51039cd6423bb613f97624a4c5385dd06a")}
          responder-keys {:static-public-key (core/hex-str->big-int "b490d5e4e3896669c8a1268c2d210a48722e2136e523df4333594672baac4ea4fc5f9a82de0925b46e676c964dedc3a1dae9a05498cb1ff1c1f2e06f8ae7c582b06b459e764f137b92ff63e4f6d28ccab5625692ba0aaf4e7859cbc06fd4a87d691c4612403954cd05569c125797a497a58cc86aa3e78f54d26f042ad72aca384cd9b5390657efe5576c4a5e3d6a28b7ef12e49873db67fc577c13c91f7d11e65f7bd48d2681a52baf136007376c0642f1873b491a9700e7b405ecbdad8309d6239d1aef4768132d5659aba5add97c79f656c09acaf7687743137193c2eb5cae4ae6da20895a5f16ce42fdc7dc0c4e60ee4cb46f0e16715bfef259b8d7b0b554")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "7c2f52f918fb4d07a0508c142122780968d065e47f685fd4f7c48788bd2bef93")
                          :static-public-key (core/hex-str->big-int "4ec1262b2ab94f339086f92046c3f907596641da788cff9d065572cf948ae0607e6ff1aeb3d880865a1cc06c52fada3b4663c8d12d02c5824a25967d1c1837bfcaeb479ead67c3b3abbbbcd1d2dc77e6cf3ea9d6442cf1f2997a0cbe9f65ebe50aa4d51db2e2c3d24a708b168a4f82c541574924b77fcec8928505d6a574f544ea4d9539fe27fa55b6ae4bd9ca2fb688692b583eb199f9216b86195a45d79919339291265d42fbe1032cddca403cd4bf262ca8c1499246369a6e4c1f09e73fa43a5b033c9d093d0f9fcb1ae1a5c1c882fa46d2cfb7a59c44a917b655319cb7f88f2bf90d41a1145ced7c4a7e71236781fbeda3add39c5e79fdd6848b59622313")
                          :ephemeral-private-key (core/hex-str->big-int "26454e988cb43d73dca37d29819a24b8114034845d61090706ac462873239e6a")
                          :ephemeral-public-key (core/hex-str->big-int "bc65ea357f2b6a0aa570403f08ef4f60c0b49ca02fdc6f07730bd60bc0ebae0a671afd9f9e1f6f21515fd05c07da0d6fe56d6dae334d249289a46244143c26e790ee7e2d9bf84fce7cf9bf846399dcf36877d2e33c2ee079626a8aeae69de75ae106eacd2a3e9b7738290a517c9bd5f5d919557a7d6c1dbbdaa05fea46bb227564830b41b134f8ad9fe0b02b949930a54fe3ddb8c82fe013fcecae52a4d24ef9da3d55fb774d956522986cc95e14e759d36f1881afcfbf466854095e97b668941c32cdb403eed047ba2a4ed05fa2bae18545d37e5be439fe5bd6ffe1070df16550ffb8e485c1c03801316c11599712bad73ec825eadbf8836cefe5aa8a6b5bb7")}
          responder-keys {:static-public-key (core/hex-str->big-int "440d60757aaf435e44aeed23f5fe5ece84a39499a3f2a559b5bcc4bbcd2e2fd516e7c990d833bdd8028c02708476ef2828b7b5440bec40543cc742d6d917de1b6cb4faae38e7a430b634cd9e64e14f11639485c9000744b3dbec31b529522d89a7e68ae1f5e204e0b186d4898ba29da65777a6090b809daaaac6da8dbd6a89fb688f00c9698b9db355ec760c1b1f37b5da10dc572a1a6a7451733252e9aeaaf985c8d02ee2c0992ae4fc02757cd3c65f87d52ff828c57fe325649defa37a15cd171d270e59c5e764c1ffcb72dde8d42263c40a1940f9f9e08f646e7fc9cfabc1158ec4b82a2f820bbddbc974aaa4c9677f2cb30e02d76b7e93beb59d6a0a5bca")}
          Z "763c69a0e3193e3050274ede1e3ad5301e4a5e9fbf7d3780e450e8695bf05b68490791320705bccc36b75eebd9e96ac0f2a2894c778b08fa39799a3e10944d0052c22ce0b99f8ca6d53d754a1d1393c65dc7aab501e049e02bb9a9fc8efb998f3d90c5ba2ec603e02ad12a7a33af0f0ec9ff74b5aec5f19909539ffefc93f93e37c4c5581374b76bc0c9973ced4812df9c8711cd069876b982e7b8ae45dbd89ba1278dbe1cf22b1f989a1b1ae9747de6c5a8e356a02307d54491d2acda3e726fa4a1c1cc5d25bad7d6bc7df27df2b30b9510487db083ca5702dd2763eda24af5493188884c6235dfad695390f206fdf7cac77e227fe0ecc1590c63df5ad4f595"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "12e82b5d490dbbdd0f8310bd9c6d0278530773b39c2772c6cedf143b0c42c108")
                          :static-public-key (core/hex-str->big-int "96087f0002046ed46d00bd0e04c80889926083a38a687db68dc2b16591e2d06357ba4ea8b23897c2b57a65aea3d41b445108b2e9d11b7068cca5e6fca72c3826c9e8d10a700bf6c16d988ed9a204c482168e22f65f0036cf6c325acda5e309cc37d5ce3f5487bd2135b60529f097093a95bcf3da564775ceb2bdab3abe4abbcb2f7eceb0dcdf93cf65c8e79322551034834cdd97f5fafafdb4a812b880b567f88c4b0c9d083b9aecdabc972b31d569d7660ee6cf8a956b7e53ef4d55f2c41cf19346496c69eab54ff312dae212e2a004c2c7de9e1c521c4216d39429c88d0a557f27d7d94f719f4521dfee855d512e47aba2549a48857b9fdfb8f60ab2d7a3c1")
                          :ephemeral-private-key (core/hex-str->big-int "0a153ee8faf5770bb3268257a96620c469cd90c977cad7ee90f5747c3751c083")
                          :ephemeral-public-key (core/hex-str->big-int "0bf74606e7fe1ce139906ce74c8276c8f2362634c578a1ec9b1093aba296523104ed6d6f16bea3418742dc3c0f5e04086c317f0e69cb525484b2912ebbb5041a03564b6979fe13f4b387d8beafae9a9d23d9c55ce6010a78ad74edd3d9bdffaff45769ddf57ec9f48e94357c923ded95a0b705ddc42168011aa128d215f53678af972fee715a0a0e1434b2581a39cc175e11dd41b7e13a18bfbe4751b45e55d4cc1eb6af167e1fbe3997597da5693200e75f55e9c7d720eb09a3272ff472b6018bc43f2eca58e221a9872153154b6361b12257cf7d2e98e16b31f535ee59008a8ec8ab62db98ab4c8ab1e980d7bedabba961979714aa1f0aaf07db61b3c91e76")}
          responder-keys {:static-public-key (core/hex-str->big-int "32ff966c43ff5dee1fb7875465bd15ead444b1590b3d1b307ac03916041a0dfb1875dbac5d508460a57c7baea51d6c670acc4f4eba61a95e6c640876924bb2274fe1913caad2e5fb8bea949e46e323473b21760f03c89c313b7ccd46c0f6e0089a1d7e1a606fb108037dd14325dd126a6a5e44bf3681b38883abffb602820d49d07bf212ee2ded5289539763da5754fd970f4f9e13d74bcd4642afc47b643cfd5727036201967ae75ce332be7e4518bacc30ca7288fe6ce9d09703e14334a07082a9732f181645b4b25c7e319879d2aaf299f7e2643bbf3f94c6d0b225f23236a1deb3b043f785169348b613f1a061fcc476de375b186a1177f1d8de1d822b4e")}
          Z "04a90869b99eb32a54538f863ccfff8fef0b0c943bbe8513badbac87bfbe72e95dcbd086d408a60c7ef903ba4e681a4d010328d331e91567f3c51c65aa4701190e722b88f29918aaf1df4dbc5d0d32228664279793fe59d6fe67502cd21efef295522e09ce6027ca7318fa4b2d3594c80be638657615819ebaf29baba67ef0880546b27cb61d51a7867218ec43a84661622de59c2ecea3b8655b0678c9de3c64c983e10d728c8700cd30df3b9c64f38cb9ce3d8cc26b77a4829e2d3aeb4018e0fb1084805ef55088fbd2b50675fffc7d18626b3bcc8d93d730b0a2ae5b686d29c4d1d6808c9b3b9d1448971c5c81b097776badfe451085ea023875bdc5685e2f"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "467bc14277f916d342e1d3a587e5d7cf58a551112718e635acc43e40ec5b3580")
                          :static-public-key (core/hex-str->big-int "aa97378780a0424bbd6f4ba5fae70d732d6a149353e5c047235d310e750ddef645a552972e9662840c35ee32a92fe8155e92d5e802908b23edbc6979b5868e53dc75af8309c052b26c8b26f2fc7eac8fce519d5b650381987b32f17016d91151da8e95aa1460fe7a473377988c01be53800e6229200878746b6e3b27089507c93bdafd76be18ff9a629be7d76718017b7e6f4b2db03467b92b40fccc9f34c5717f37e809c78bf998f77359debe3dbaac6a4e853bba1cd6f974bf534acbe4c3c20c1a3ce231bcb164d5351581fb0b08ac8a02186fac9bf606fcbbb105defa2da7b8a74a568788b3cb676e327df86712c1fab760d8a822b0c3efa4a6bdb0477701")
                          :ephemeral-private-key (core/hex-str->big-int "71cbea32da5e982b11e4c81d3c2ae50fc6ece596aa8b368af0bbf82e9951a57f")
                          :ephemeral-public-key (core/hex-str->big-int "d4e976675cf065770c110f0180cf8c6009d68796226731792156d5becdb05e9b461f05ef8da5cfdb9573b820a5c9f5e267d285c9f4e6ae0bfa58606fa0ba2a9da05f084cbfbca8f7e0ca10e7e6e6c43ebc5468eec334329eef01bf96b550884dfd39c0a568a8024066d9997e31797246b2c19f086b53b54d061e1487bd5e5344d2c7961aed8212d948559890e495b6a8e7979a834ab8daf12dc60a03e7d7fff812fc137cbe80b17a7bb90879533f165983b75f3844fcc57a83da74b1771971877e15bfb68eafe1a588890d312c1bcc21b2609ab503a3d8cdacbeae992d72fb1661cb9b9a81221d15fdcd05bcdd9b5d92ac54723eb163f8780d505cbb979b8d68")}
          responder-keys {:static-public-key (core/hex-str->big-int "1132cde35638b7215f940f8e7e0886bae1284df087cfe5b9b2548879bf3ef00cefe6a8d1a151ca4a4b8378ef196785aceb2dfd259c4ee86b2e39451f01aca70b724ae5a085b99d48ffb71c90b3e193e1892c36cce185aa1d2f4d5e3a388f9371299dac70cd6d5b94af8a1bbaf7884bb6b382b376fe013c370a64802d608825ece1fe08cda5acebf83d28aefb12629fa7f9ef0f540f5b1e43b220d91a35aad74621c62fa16e752ab0e9804cea68ea2845fc7e4f6b16331744259eb94f791b42e79f8404dbba3e6fc520e2aa5aaab90cfd3cfec589db120077c32d2ef546c79853ae6ea55a5fee14bc8ef0bb5d58f2f21ada5fe4a56dc3a755d11ecfa0bfd20e30")}
          Z "085db91e7c5dbc354ba11839b034b73d0aea845af621ecedda6a2a6370c7556f70cb280c5871722cb96013180f7f9b89836f1cf18331c1429e1715c296f657ac986219571e8de1bf950997eda90e74297e8d016471ac857131444991cc14934a3f1087c7426fdf2329c72bfe64ac8f8e4afefe65fc7214958988f3dc7e5c30ff6558ae3294decee264929286af7143a132bddbdedbe730953afaf535e74c3d4405bb1db9adc2cc4051fd46cc3e5866a44ef5e744d8413b31f005922719ed83d43cfbe732450e1ef1d09e5898180602df5467d015526bed18ed6dd5534c2e8ffdd400be6322fb774108d91dba271851e3648f1150a86a4ed1cad07253a83f33e7"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "73aad1910e2469925e1fa4d6fad8c5967459524d469529970f5c3556da55d511")
                          :static-public-key (core/hex-str->big-int "3103304ee70d6f1806839fc13fd122c6c1ac95a9dcbdc7393b83a3fc85844eb40b80884da3c225c789ae23ae9a0bd47e4ed1b79de4427e5747ea210f2a03881a1730414e0e928975b24f3cdacec0c36194f915d321279cab77b90039ef1591ed84e312de2826bc02bd1b8cc476e4534b45976824a47e1cbc2e98ffbedfd6dc8caf13e833079e9eb0c5e9b02b4748113f62da490f1e2f9cdcbfeaa8681be2e52a558ed84c8959fd3d9e60652496c03971ebac532fb21a34a15529e6e5b9960415588b4a4a38e5c1fc02ad70ea364b95370a5845b753ddacb64e65d219656bbb3c166e0711e91648ef14b881a10b2e8b9d48bf7cd942af2598c20835062c1aad5d")
                          :ephemeral-private-key (core/hex-str->big-int "086bdde1f240694b66c4ff5b7db010c8960db1cbb67abe579af746cc41a858cc")
                          :ephemeral-public-key (core/hex-str->big-int "cbc95481102dcbef749c9cc6212edfd362bf3f5762a6c8aa251fde6bb03be8b12d25eb6c2f4cd2a5e8e80b11e058747e2c88ec034a4b13d70aeb0aef09613cec058d48769b369a38284697e0886b850412fb5fd9b38862e30e26b831d5e6bd831c3ece1b81dc2e413e7e84ec8e13172c04611b056fc6b829ea1f2093384ad02aaf9269f5715f30de33324368200fa01971e719022a18d0f234858e9b14cd5df1d8fc93d7b454bc1709c03fafa773790895301272ce325adf4b53e3b8e8f5452d9e686318c403a8e6733526b93d4e1db115cea7bc52c34d4f53826b6b6d64bee21bf3c80453b2955899f624d2bab9bc30d84ff0060e5f81bd0b8aa308ba3d88df")}
          responder-keys {:static-public-key (core/hex-str->big-int "c14878552d006c05fe704ef90f2e7cb830682ffd81b78425165d69fbeafbc56c2da1f075be5573eff41c38066de1d5d26d6dfd7d6d4e902bc0b393d03411e6df423e4cacc9895ee4bc614ec2b8809c7cf687bbbd0a79953b9901bdf0c0461e9ca81f5e335585da6026ae2e9199942371b04d6c72477bb967984ea0240e18761fa5890fdc4b0479d612f4989a964f537f6cff11c7807f58ee658a572373eb2634dec177b2b95a21ea3a20db69b6ac7c481e1f3f5572b7a2d7d116c0ed7d60ef78d2e6f2031c5129d6ecdff8aa73aeed9dd87605b31c2bb3fac22be674e4b46cd683a3cff471d06ad47126c325c393bd24fd627b8a915ce17b5de28cf7b1a8d4f7")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "d94215ed3f52cc92f5e8a7cf0ba4aeb2471430c69f7b1d07a26e9e1280cba6f9")
                          :static-public-key (core/hex-str->big-int "03674e91572833252ec71e5d4f21e6ecdc62de1b6df70bdda5f8be77eee7283e6e6410db00aeb2f454390b364931c4eadfe11ab0a002faca3d33feae8600e989e21f1281e4fe0223af0c0d55f1c889018695be2374d8935200514437a253281a75c502e64bd3279514f9ab9cef9be04e007cc85e222817507f2c98e0e20b552f4b97881cde55d3354a99399b9f12ae9c1694adb68f6de6abc95b27c6a0ba27de254075d78afe98d0781993a017704208414a09b9055e8ad58ea93a7702da0e31f3fa366c057d4a465cc47eeb5d1bc577446e8da6d8e17d2f63e12c156fd41c1d2bf91198f9dbeca7d5322610a04a92c6bdb1681909ec2da59ceb103bca10c8fd")
                          :ephemeral-private-key (core/hex-str->big-int "97b489fc834ccacf5155f39190d3e07a85be65093af226dadbe55517776329f4")
                          :ephemeral-public-key (core/hex-str->big-int "6536a242f6e4a9fb2005113c080c313759569008df67fed249e9f8c0e2fdabe985f87251974f19477bc7081c6dc4a71e5a8648373911d5f40e6052fb33918de09d50910219798fa08bed6dcef5bc6e4778b27089cc02f22cbc90dac1bcc1991caf135eca3e2145f3cfab714ed978a63b8881b25f177e3507899b91ffae4c7fa124efa4c856c832703826db9ba34c4cf9150617c7138c461e43fcb0d50101f20a25bde77381903f180866f96bce1a36e73101c8d7a089c5ff27fed900b0d329c8fd1c8113ef8ad6a11d899334d6213b8e4d2ec41e7d2e73f463197f41a442894ab7da9b2d128e5dc5af44e7c374f11f455e5f63180f27f2b9e557d14dd10986f5")}
          responder-keys {:static-public-key (core/hex-str->big-int "45a8d840a2084bf5c43b23c98587ae61fd3f78b92561b83b24d14cf0f704267844540a0b27d8668408ad351a6e534317e624563866690f11fa43b76f9f9145a240edd5564e4fce63ea2eede6e2b5d2197a20f943753ffc76502ae46303b9a7d0dab2405750058294bf8f4989f4df53449d305d32424218a29c6170c27e48fd3e1dd173a5e8fb368d18de266e92246747ac20987ea99c71a910035e7e6200d1f094e8357b7ea8ebe47bfb99650c21f90a654861a6e33e36d9c6dd5c3b16023dfa9bff72b56ab26e557456d551c9f6c0572bd28e4225ed37075c5ff5325f43c8048c6ccdbee8b6f16dffb025da92352d74db8ac26f2eaf08b28c848ed413d73555")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "ac50aa0321d5cb0d08b73c6a8c9c6de5938d5881032478ff3974886376ee1172")
                          :static-public-key (core/hex-str->big-int "7225ba4f340d517d6df09bfebdbcb30972d21690db6a1c1cc0c100b190ee3e653f2baeb1ce75d510fb0a5a6cdb0bfc92ffc2f301d3efa3b47ba2cf7218182c1f34c3389f104851cd20b7697397737d7f66f4150f38e16de8c60a60553a78654254bc779264808131e32868f942119101b1d338de90d95aa315d45c1227fcf0295b9d4cf9e19d31c63be6e55acf9bbf713f219f179a24cd6c927d6264eca7c00dc3fe0b6401a78d08a438eccb1ad95be5b880f0d9ec8518cd38673778597dc62e8b51c4a8af5b3bbd6790962af9eae17f473a82a723a1512b6975908f81d521026198aa8f9264d6bddf22cdee7b6dc29cef42f0f9ef8cff45fc2dedd8218f64f8")
                          :ephemeral-private-key (core/hex-str->big-int "45d74fc2b00b3c16d98c56ec5fecb3ec668a9541e0b7891c58887194f0907899")
                          :ephemeral-public-key (core/hex-str->big-int "8b98e8edb0f6dc62f0dd1cfa0c42ff69c590b5a7871cf5ae38e09fe5cb20369d3201cbb5ad938026f1e95193fc051eb82212cff7e4192c2cccdecf586ff03d56fc8aba038f05ca3879aa3d825218239cf01a54916b5a0d7e5c1937c238f03c0a0c1cdcd324658b999cf2192ea5439dc835ae5ca01922bcb06f797533d98849c95259b8e26ba151837e003bc6ff4f0313d82feeb3163775213ce1157a32fcafa9d8986f83300584f0c687baee1d05bc5fe54a6edbf2d10142432e14f09ebdb29cef61c5d1b8b36834f344456890eabbf6d10e4f993bf8a8d7a85cd8860633090749c70e020dcb40c9fce6a35b930cc0af59d17a69c04464136faa912bc96264b7")}
          responder-keys {:static-public-key (core/hex-str->big-int "1862a6718fa3540ba4aee0e9efa14f22b965e93f0926a82c2ae1c1dd8d2015a6e5d09a62cadf99007f1965ea06d325e1a8eb2c65ca367ea4b122c508547a4b7b7a005ff9a57aef96dcca4a2508d827fe4fbcbaf3196dc69ff09893c9dd7dbe88406aa35ea2c88aa249ee44d152d8db9eb81d928d322723694966f0eab96c453671180de75763a1f3f937865e711a997603fd02f67c8010034de04b8f7f3af6f4cc74fd69c21b7ed492ef7a9933c50d67f911542837b317532fe57e2fa5ad18a2609d951f6f6e9856715eb29e35101e465e6862b94d91f374336217fe25cb1d502c9125950bc02871580907f2031075808fcbfd4de8c97a4cad48082c1ea32f20")}
          Z "029e4068cdd7a8ca3f412e467bbbe91652929c1047402de13bcae2dd675f6832c071d3326671924a774aa432d86b95dea402c9a5e83362d9a7616e93e020f48c38f32666b143ad8b2c7bb45c16b1d9a470985597b0ae3587b87dd5ac96d924f9c43552aded4fd650928113ee2d4299024f115d7c2f0a788fb2e63f039b4447f37a4f2e563a2f20f0b4c03b99a06cbd62b47bec5fb8594c3663ff27e8e7b06ea3b36cdcc0ca112023e8c4914f42e7aae28dad7fe3ec1aa7ff9e902072c2ea04adecc3dbb90bf9f4d98471901b0628502583f6212d07cc67def08939815072166432b837995c63fbcc72cf14111ddc365984eda817ad9f30184180ab9c889d82d5"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "10c292574998fd2739110eef5c1a35f3641af4b1977ac43d8785ea70e1e8097a")
                          :static-public-key (core/hex-str->big-int "16644f7387cd04e4f1ec59f5665dceed97fc0b883569facf947017ed4a0b2a70c5e35fafe0815b70b43d7edc5141f34a7b87298c431ab41196747a8abf3b147102f10e74154fa14e292ee7bbc71247129c97990d989bb7862a616498a12191cd67fb4e052d87a1336e822db67781847fe30404f855032e4a1a88ab67b3ce0e200c642c51e56f9b888ff03dc133c7179c363a67bd0874f8d14e270a501d29894efd736e59ac7e3a3e1844c7f9f86c4f08096322f7399707a8ecb894ec9fbac57d77de9475986bdbba82f42883bc153249814d84674afbc827bd44e3cfac429d8830bf3935ce03c436d0b34a31a9cea768c88d962d502cd217d0c7a68a82d24878")
                          :ephemeral-private-key (core/hex-str->big-int "09e3b432b5fc480a7d3802a8b83ffbbce3f61bbb182672075e3f8580eac227f4")
                          :ephemeral-public-key (core/hex-str->big-int "92135f9d00053edabbf59d911d06f2b2426b4c197545b3d360cce20152b614550ff89d10887095c75fa9dd5078597aca16e6846660d4e317937c5a6e89a99966fc6b2e9f19ade123195c04c25d49ba98f3223aeafc373feb05bd4ff0cc0797992bd7b7c54c08047f57c262e8946c3e16316c753fceaabd72b6d18e558728fc5461d04099749cac078028d8c747c6c68878a1a8b85844565f8d708dc45e8f0f9cc5b1e2df91c8ba606b97ab30d43acb27042412e8c1b797b0c7fe99a5baeeb221e53814586664efad6674e48aeab8bde70302d572e21f0ccf4c760a9797e930025982616115af9d62d0cf6af8b529bb0fbb5e18737e0b3dc8eb81ecf381d88880")}
          responder-keys {:static-public-key (core/hex-str->big-int "13f0f80c74ecd49cbef12ad238b3de16a30e0896cdb435e243504c610a4d9973354ad14362d7c790fd916efb80aa23416ca1c4ccaf1512e454a0acf24b1c7889a2712c551e6fdab94395b748b5688f4bfaeeb6066dd6d207311e6bcb0b110c3ed93f75025516d37b0bf6586588bf91d0c3afe75e7c70365640a74a486b6adfae49ae2284169704dcfaf7523ed0bb96daf425253b3c37323e0bc5474100b4566f4a671945b88349fd92695cfeae9ee566a0628d5542b69f91b9bcb2cfe99557ee80426a7b305b59fc0df7b3b3d4796230de94ed3b8e52c4a9f296ceab5c37aa7c9fab14be9adf22a71ce546b0538999f2caacf45253079c6e1ea983ed2d968939")}
          Z "dc2a2914d2e2eab2006e7ff5d2ecaa79a5527979bf4ad34a1475cd5db67a8fa7527de90287ebec5d9dc3bb6a038dcf27b69710ccdb7f7dceffaef180f39803955eebe24ca958b53606015c00a5fa646040e07f767fbe4b2adcf5a9bf9274942f6c4bbd85fcf70a19ebdafda0df6a607baf9cec6ebd20bf9b34642b026f1d469d9d27d879f4ab363b33e68675b4d79213ded2cbe296b9997ac59fc6c44c79a925e1338e5cdad9a841a91fa9b1c549f1a80358674fb277ca0195b869e5b8b2fb5bebcd28d0e0a05e52165a9d3675d6b340cf4afb1c70d542ff8689e934d9226dbf5be4dfdbb2af740c1f405d54a4b732a38b2bdc0926f7eaf88bb463bdb788d74f"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "9d120dd37d8386c2adb9b107bfea2616c2c0b118dc0e92c8e3e5a76367c77978")
                          :static-public-key (core/hex-str->big-int "3bdd04582cd2d9f3bb838f7e7f9f5fb221b7a667dce529842b25bc75ed33cecce413f0d8f5c1f2a6e1300fda4994c2b8d8917edfe6eb3a693611dddfae6701e06897a7bc5b4e65cb587d2c97dc3046670fcfb7fe9329ef39544c63b4b2a3d7addb05894a7750ddbea1c6f8c0d71dd0138e17bcd6d9dbf7de597264d08cab09c82a6f49ba5c6c6b62656cee025da7c308933838946a8c79b51a224c88bf1b09c386bc627d79c7fd40a31f6db36024908c04fb62351f7adfc68fb5019ac5ed59a58e2928bceaece59085c4f012f9da3b668191e506943b1ec7254ee9a85d75f93b3ea78501b25286368806d56a3d0e724c12ede17315045ecb2d7d805f25d9ed59")
                          :ephemeral-private-key (core/hex-str->big-int "04f67c516270db1bc9394b7ec8cd1bde6c91f0a79e1c884141c0b6077de7f6e1")
                          :ephemeral-public-key (core/hex-str->big-int "c7b29da9e8ce77aa5da265152885835925015d901754b4ba710ea033354b3e056220bc7195fb39fd69876b10448d85e1c455760d1df6b2121e3f9f3ddddc61068b33a2f5e3cbd31c13b3209bd2d2ac8da84a0bcd1f6feeb47cd360c399d7e7c3ca3d3b523f21b4ffa556b69c6a102844ecc9d2226e867ae5d79e9a8b9db4508f64d9d038151cf69619c325f332b61f0248d20211d2ada178ad7434141d3b78c4c614b7209696ff5813244dc9cf4735b004fd70401b2c3ae82ee75234579005a3b2eee44bb4d2800f07d1461ca428a86660dd10a5665352f85aeaf015fec3a4146e7db1b66b1eb2d89951fc14afd8d5f855acb79d69f041df39dcd42035c2ef32")}
          responder-keys {:static-public-key (core/hex-str->big-int "2c062fdade888f0001799ffd8180e2dfbbaaaf43c19e6d5aad5ac6618f7bfad503174ee655fd7cc732d52b4924227df08ee8bf4eedce1a8a05677144444f5447e8752e4df8b8daca039f6f05aaf36e74e017be1b53646f4d4ea50f5386a25a8f338e56af0c66baaec8dab54dc982f057310b2cc2f69caf99bc8379269441a9bb0842446079ad7fded916db862bd28d1ae62ca97f63d16247e7de1f0d4781f14bc0cc9845552d80c7072a48a33b541dd6411ad331d8fedbce526fd3d54ed15b9cfc4a3cf135b13682439d7b3dfaa195d7ef947ea631c2f3c45889722e5cffb4aa7992acc882570330d01d8eeaa1b894c72243c4ac9fa9b3e7b4647d31806514e7")}
          Z "5520617a7c33060cf607d49715418003e4f5435b136eacb145a13c7e15272de5d8c8e83af4b7abe479e2bd69163c265ec57fb5c3146c4e39cfcf280e5c48e549cdcfae041727cecabfe0fc6fead85528e74ee36cfdd3078957f2b8cb91f27c6ca5467d184b03d215a0552c9d4a6644b8dca0b51652cac9e3a0e1b9e0bad3747b831e69794415ab2cb85bf02ee0aa3413adbf75e63761f838115fc9c85917429d10a2269c85d352218befffd274c5290e48d0c2bf26f262e0f347aaab047e4c04481338975abfb9a3298e65bc18cbe6708332c422128ca55c70a88d48db86ec519a85d7752a8cd4d24d852275956bc202dc0eaf923a18d6a90d38f0398a264571"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "53a6fced93a854ac5a58bf55c21b79777fbee17c28a5f520d3a1692c21a2e9d5")
                          :static-public-key (core/hex-str->big-int "70cf70bda84ff659d18d8c4d20044d70dbe049d8141b0899108f5f9d729ebc4d3a957dbe197b48a08072e3d03c4d2bc9a4df159e5fa35e9377909bce4707f2c42e700610a2fd92695fcb6f052c16913f9c6b4d26960e579baac83ee0f9f176512795da7b8ae6a1e015ba1e541cf753bacf004d0427fd5c02896011eb1c1bf6b2c228349eb76d16ed5e8a5c32626dd1330521d0a33ae060a801107c9053d8fa61ef2809f67cacc17bd99a0c9fec521b8c0afe10da3c294ac5b9fe811ef5547898a8f10e36631884c659d7f39c946d9352c33b498b8e4f70b06ae16daddf44352e194a1efdf57f91b94b61383e353af5bce74483a965aaa5260c27f7c93a5ca67b")
                          :ephemeral-private-key (core/hex-str->big-int "43d0c040fde4f5149e0e180d1dad6efc0aa970ba0da3f9bd47f966444c59effc")
                          :ephemeral-public-key (core/hex-str->big-int "1083d2a414dd574962cda63e65f6a54a813b3736e75be85fdb5d12192fa4558d52246446751b9eaf9dc21d41dd1a962bc867acc7d8dfc6471a6d8fa809a27b1883de3a8dcfe76718b64dc25585e3851a570ab952256925b3f4662449210db3b65e0d1de4c26ae5eafeea5f607e7dd5bf516ac85028ea9757326a8048ac5e2254d155d21a0d7e13aa477f9a03f4dc1a98a16f05104fcac225af2f7fd3ffbfc482b8b784963f9f5ddeb23e25b8e3b9e121bf8ce556321db6003ca12f22d5b9d3928d06cb904ee2882644d990c08d98ce9da9be765bb62f4549692a95534c4639e6dcbf160e04eae087c755201e486945366e6e5b7a51a7bea4def1823066d595bc")}
          responder-keys {:static-public-key (core/hex-str->big-int "7705f9c623b60bf128f0d3d1faf1e0dd99ffd0934f607e1360ab172d4b1e6170e487c9a009e6b9903a9f5706e4b77540fb6343397531e596f5f84736f974b2cd000a6f62a8c541cd5a19dfad99203c2031994a8b534b01c532b76731594e241602646df54e75aa0d1ec33e5401ee62978fd4fd6e90f14ef8af916875e8ed7db2faa14fc66b12f04172bed56478903a5c0ff64875d9799cc5db6ba12338c7571c2904c95958d85130d9dd5904de9f35c30028c53b097adc3a8566ce039fab581648cd36132fc52e7b1a94f14efd57e5f93f61d967ca72aec47300a38b7db8ddaf0effc11e7730531888d52295e301bdbc2ad9b5c2e8dc95d712fb395cba7abe2e")}
          Z "00934eb4e21282655254d0771f9a221a6c8cf4f179a8c4cfd4cd7022d5aec946c33e9a1e085ed3f269fc41febc518ebfb4027a8b4b15f65c16d4a258797a3d7c8d8e51caac412876cb330c23b1936f2c51af14863a418c8363e55c80c13663778389c5fe207a6b7c2b631749c11dd6b8805733c664f1ffa6995e6fd9b8ca0d00712eb4527f4848339073f8d62bd0af4b01252dd2bff31d86f3f80a1d98dfdb2653a35cfe524df2981c1d4eef2feb56c6d7e8a2cdf7fbd12df9b44266b850bca90b2604651f172aec1fcb2953561bb783fa35ab8aa6f6e7137773509e866803bc9b1af58bc7b087237fb42e78dccaa460e4a2958bf43e0ec489fe80ce105e7e03"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "c23b1a09d0450fc9de818f691d25bd67b13e292e449e0ccd3012abb89acdfe21")
                          :static-public-key (core/hex-str->big-int "caef71a65abc4d70fb93cbe5848a3fee6168347d6caf688c3ae7aa27b389dd0e68b85aae674fda36ad541f79c6e46f2ecaf800e1303745b9887342949a066bb058069b9575cc0be3ec201098d5704f2520f9b0d66076b6be5d3a091c14a06f83494b3571c42e1001c483a5d92233afd711bee8633096efa02eb33f0f7c551d0b433517bd180766a34217b3033893cfcc593f98778424c1fbc0ad1566e0a10cfe72a8b0c5b10de2a509406a74b9743374fe6716b75a5851a5cb8e65763f5c0b122bbfe5c36f5b86fe781074a01199159886f641e24d55c5b8af945249cbd5f6044e938f95b1b1394aadd052ab114075d1642b403dd56b1dd4b9c814f8b9a47a20")
                          :ephemeral-private-key (core/hex-str->big-int "821a7c6e06a3d3ee10645943e1b1681f9441c0778b9d2f929cfceb20cf4039a6")
                          :ephemeral-public-key (core/hex-str->big-int "59fa08aed44d5394d1754afdbac72354fbc7a34ea626a87a98a3877d0574266131e9dde1cf13978a66e1a0b3dd63528d6a0f206ec5b868c37383209feb0e65e63b26cc8788ffec598e3d2c36aa2ca889d9d8752f1a18428e8d513cecb57dd0b68d5c4d93deb59ecef97aded2d7cb32171d959f794811c544cc3ebcc8dde0c93e92d2e2c2e1a988467bfafa64854c66f5233acde117c76203d185bed1f3493f7902dece7f2b5361ddebebff320854f1e0a888cdbc14d00a21649ec0be622a6f625452d9f7dc326fcb1df8b4e7b5d9acb4c4708096b8683a70528495405094b3c48e941568b37e3c5e9b43067c348a7f35f0e32ba082dd6790c55440da8c5d3de8")}
          responder-keys {:static-public-key (core/hex-str->big-int "58cc4393257f8c0823326a170b36710ca395f39ad77f52371a5b8f5353df4b54dfa4c945eaa94502bff868d7958bd49df6ff9ce79f6a6a0777c1cc4c6b9f81a6262341f5e0446ebccca354d0e51eecb29dc33416dea93effc15c5dd45c91128b527d778a3350aabff06d37d83f9017232108497d2c4c61ecbcc236921a59757bd1d8fa2efa76083f979cb29ce60a1d2ce7abee4194bcadeebc265e03519096541ea3ff94972faca10490c3fdf3c544fdf75aa3354a203f07d1e7b677ca46ae517f9f289403dfd74594731ca66afd6720b5105b7c3c41c93f98d3f11dff04998a95499954b8529d82ac25ab10e39217d27242925a0c1b80a53b272ad2db48f598")}
          Z "86b1fe3efb57644f939cb271b58938b177e62a8e7fd7489b3d3c679d324768905b02371cc222d72395c27e6e4887ab12e01ecfa535e12bbd984da1763b3e5fe25335e25b2a40b4b4c8235b0ba6e5d71a9f53a08445458100294badee035fe9322d9ad6df955f7c8d5c1e6fa2753fa457b69dca3462284e3db7805910662d0a0b851f9bc96fd0dfafa7216c5943e3837c5281dbf3d6150f6f65806c903bc1e1f1bad9b11dbe2c8b8aa5a30bd1299544e845b05334a9365384c4f4b838d9321c6fbd71a8cc854a25d830eab917960d8813c90a665ee2f08a5ba0fca082ee26196ea42427cdf63879cdd2c43592d596e2e577ed9c9e91252cd1c6d20f49535a6068"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "5dcc892974650db01f8e960de217be201689c50f90f19e8851e912d8d6829355")
                          :static-public-key (core/hex-str->big-int "cabc31536ac88645f143a6d18654b3a6e045de420948f2245bf60b3bcf2679fd8844294f2cbf44a7d61bd9f7b608e4eaeaaa709b419b089cfe83605897e1e42138ca6c446f9d10dbe465c6feabfb9cd47abd1ef383d9f5d4b78162ada71e1106b05eb46e5a5336cec91ac519061caf2e92f178cb3a2014b672e39699b6c9687568f3ba3b303dddc56de4d4f9faec3c56eccd451255be2c57f1cf775e654c39b93877630d629ded3b0a23d5c3f7921fc32eb76e127b5388b866b3fb2455a8eee4d810bd33f45a7ccb6d65cb12416f14838d94530a56381c1f638cd9e8ffc27ce8d730b7c2b7e38a001ba1f0b32535cb7a51c3794c32c1121ef3964c5d2fc1e5ba")
                          :ephemeral-private-key (core/hex-str->big-int "2f2a3db1af09fe8c37343dd4b1ac8728e171525c517d59a17df71af9d1542ec6")
                          :ephemeral-public-key (core/hex-str->big-int "b1ff65442f3227a0ba48ea82e13a9388f967651fe199577332fb2b4d006a0e330ebf1f51b7793a229202124adcdf09a4314bd90960b6c68e43db6cd4cb29e2c32a05fc11ea1b0bcb3ab7167e661f42d3a2932b6b63f620a53e42ccfece292d22487341a45531044e63795a0fbb05166a803eb28c0fba4233b1dbd107a2ee484004274275070c56a34349561d04467f3044740c1f301b540fd011e7f67fb84832bf8520760948607dd4b56a4e8a5047d1edb416830c3857a643f330499652f78d15a4ebbbd32fe64386e7aea425099b825d8bc9d6645803cde2cc070894337ada3ac1520ae6a6f712ac02bbdf0963604491b81bf51a3f31541d32fd404c888c84")}
          responder-keys {:static-public-key (core/hex-str->big-int "d35cf1d12e0bde534c5995261765b54e2a8769e637214bef3babe2f89606b65ccf948a7c877098b886bcc85f3790f9651c23781308c9eec94f5c53737e700932492e8b42aec8cb39df5cddbb44d5902b70c5085412f8c836c3643f0ffa4aeeba35bf8a83c96f01fe668ac9995041bd11cf69ce3a319744236d404da2746317714a3266d73e4cb446ef6df509c835114e04db69b54480f2c2266793dd92e8b0a8c56474d77abc567f9e63899a0eb5618e8460cf683d94907a3f057c541f9d5e1d64fc24299232fe34363311ef18b281df9144b38cbd5ea43b6eca75f05a21f7b0ee12d8059e922d473aba7f46aa5971ef3ba067973ce8c6c9c056dca466b3a079")}
          Z "b6e6b5e4ce87f453f1fd991af33d7e3aef5f23454aab530e333563296ec7f1cda75d3c6e9b80f523b56388463a7de25c64fd613c1f897463f9f0ebc47dbb67f23edc8a2208de897763bc1b76bbc01f9e35b6f6cc9aacdb6722ebd00253e9883f4203e8bf62cf1f3d63148e7630647b2e18bcab4a4ac64db579fdaabd93bb150243735bb2b47f581babeafddaad5991bb56d85835b829f6fe6eaff178a3f1f7347a15a38165e5118d76be5b1a33e6fbaff22b7a0742d37b1ed1846cb94a719b42ff9bc92f584e2e06eeb6fc89beed5ca3e8a63b05bc82dd0fb9090cf43de441005473f14f78a262b139b96d8e8e694b1a6022b65ca42db9430336f59a287480a4"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "8a2d1256b7d54c25ed7951e1a68066c7dc447a23e25ad66739571961c80231e8")
                          :static-public-key (core/hex-str->big-int "b7d64973935f6b0cab86ae79778bc5a510d85fd59a17f079f28baf7510bf7c1fadc4fe4ae23581082a4e89a4179ba10640c1136293d4272069fdc77feb103178f6e9ce325ae341e9e4914bd7f9335ea1b828aa4e9ecaf80539cedc3d461ac4705346e519fc1c0ce0241c7bc86569ec08b68c36e2b7c5f07ece0bdb5919a35f474a2be962f8ece3d9f8c5d09564b8b4aab25def244b9cc993f5aa06a9d25b1e4e3ccebf04fb0bba384a5e4b4634d64fc9a82233d263123bcf1a4b9e0042ce6a62d5b7be3a0164574819de8e828d5679865ca531345925c5248df279e97240e39da50f0446f28c3d27d195af20ab26d809abd1f724613d6fe6829803ba29a12419")
                          :ephemeral-private-key (core/hex-str->big-int "6b0115e288813412fc687ba7cb56529f6a58f3b68c26768f9bf91614f99f9792")
                          :ephemeral-public-key (core/hex-str->big-int "d65d96d0993c17bd9e202e2d555a85abb60a07886fd0864ae2a0280f51eb75b7679db1dff8dfaf0c9e523f3be1c8720f99202fc1ca252f744e222b7bf23eeac8f2f738c907145a0ba4422a31dc4a70b9d7b33b2fa9b404605e26ff5bb44e8bc2f447f6a4f7e716849b4263ee48e97ce0443ee9eea26ad22500bbb206c8e46e228fd28c8a166a063b81ebc175c12d3f2e8b84e5d958d461a14e2e5246031be68339528a5b09ef8b1871665eb55f2a260663ea4ff33d249576a9b1ed924f0ecb365338fadd25581fc30cd38a8f86b8e48ed3774cd64e2001b6937e5e9a2c676c0ead2a88c6c792545422adc3af14e091e8b83e338db6b24a5764a4b2f412a0e0dc")}
          responder-keys {:static-public-key (core/hex-str->big-int "a46b2a128a28034d624b1b37008c8b7b37c524e741b43f3a4f96efb6437eb5aff02bd53a87798408117ec432f532021d94a02b9c4d6e7e56799a4e2c11cb97b0cb3cce1c61377e9b451bdf61d465802769d4051a2741a759de6bdbf77144665f1f0825a65ae54db0b33e07bb5078428e55045b5f3f98dbc51bf0d5ddd4ecc15cd14891e69d067630d0f5209126ad7dfe6836884ad5ce2c8d8bf5ed02ee7476f1a3e51a2beca8fdfaf6e18cf2d70015a3a588d55cd051702ddd2a0bba750940e887dd70b5278323e167fe73663131c8d37f3a62029832875044a86471480e5a5b39656267f6e22a662e594cc3a226a5c49c24c927c2c7d5a8b0ee1324e4138666")}
          Z "687d78aa833a5b0663465c629e36c0e1bbf1a2c919c51ddd29c00ff5f7e31ed0cf72420553cabfc98444babf0129d5b9b88514e9f482be17b2216915234831a4b088b22e6f62d50afcdfe2756a5d78cf92360e8d8edd8673b7a8eb73fa4cd22d093bdb76b8ed68d4a154f1dcbf34f031528a8d808d9d5ade6c659921ed4ef79fa2afdfa446caeff1ea273cf0c6c46c82862a3bca0404dd76a7f57b0edcb8ab9520dafdb92b0aa22967a2aa8ad09f75b3ebd16470644c9c779c10c1f5c884f056f04d1c53b6b159ff5f98794144f70ea6a931b8b501540516576b7d99972eafacc838352115e7ea2834cdcd44ac0f940d4f5d2f7cf29855fc3694f7d3f8a5c2aa"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "9cef8ed004f1e26e2e24beb0637d564d50226b792f5621b3612fd22ace83b09e")
                          :static-public-key (core/hex-str->big-int "932a11a823772cde9bce7d021828b83572683e2b8febe8633b385aef5f50033f4f780373a6ba1b61a99ad13f702b8d464a51c98a4922018f6cc0a49c73a21fd6fb4bf4601dc93504aec8b6fe7b04b51d90bfb953dc91a7822a3339b39d062e289884e62fe645245c94f5f0ce05387a33dfc3a9de89f8d85594a3d6d33f6bfc8e4c4346962c83ae7c46bff0fdaedd89613efee187cc1c1cbb0174b82d15fb0f570fe0d31d15109d38e21c401504ef333ad3b5d7e97f91f9edea5d0b013d7621bed69bac953b98a24db498b9cd636ba96c4a86e451e3384ce2f6cbc40f7a7a1c85bcd7d9585e0253f51f15f048df9de7c4b26c97fb8a9cc2a443a9061b7976c22d")
                          :ephemeral-private-key (core/hex-str->big-int "a8aa3b66eac4b146c4ea7bc22aaf1f780d639dd9c7612e347e916a6a69041909")
                          :ephemeral-public-key (core/hex-str->big-int "cbed0890b77fab0fdb64c921f7c610f89472ffa4fb6713b3e62f37b672b6592a19cb6930cab05e84e72ac32ac68c4966edd08da81bf33833e4e9a361fbe3e379db589e360d5c6d04b6bf6768022b0eeafb0652548bcdebcda862d91b5dbce79a09f40b987e06f8848fa3a7ed34402c8b452bf9c76ce741254160ab4d637bb6831ae2db4e6f3cf094bbedc4ecf1f0b4533bebd8fcb85cd6683172e46140668933b211b83db7e6f0ec7f0234158b7a6d771ba133da5b87ed39889274c5da96fd6a235db89f6b2b4cb65c0af1478b5eba007c4e9a7da57551333862a851345895d5ccc80378bc76fa875e660215e10884ff88b7d922cc7b8a6169b018bb8dabd58f")}
          responder-keys {:static-public-key (core/hex-str->big-int "b1c14e53af561931029cbdb1eb3b07db032279fb29742c384b404e79dd0cb4155f66fdcc173cdfd1039126b5013a3ada795676c3a6b63e69e999a57ef9341dd55538bfd30f1b7e309d0f1f072c89d28893eb89c3f0da4d6ea6c3ae0047a21aef8be5f3c040eea48be61f1b48927d5b7e097b26696191a26b74165638f34ac6ea70c503c69d4e03bcb25cfe42cf66ba7789bf1a7e70b16a8dc0add7cd35de1ba74903c8d2ddad35f9f2a758808cfee45ef5454aca79c89500c94af7b1a2a008020b5d6ca6a23252e90d57bc5d0289331cf8675126b2fb97cc9615331e0dc63d7aaeb151476331dfe29c33e8892dd233ac092140a49394563a6bee75606fbeec95")}
          Z "488dd68378d0bdf97ab1cddffc4d0e47dd7308c7c8b6c19ab59969bb4f454adad531f0c6426d14aa96d11d8da9f2ae561b5caa18120a8f35717cd66e4446983f90915c10edef86d17250d7de303d7c54df420010d59d08e1a5b83aaaa9f304bf59d7be9734c1b71aee457d65bfa1d86e22f88e3b83cd92ae4e62d5af3e37b9c741877fde05c650534a416d6e454d6c98a33c067d98e19c25690f542ae64f9ca5271f7109ed32141626447d8fce37475f3d01c2636835c5e1ea5caabf4a0d7c37b801c31704f3ae76531d3cc3a7e1393f5ebd66fd74892451cfb8f891a342b355395c38b7f9880e845b59d95f54511e315f7de9355188da513df4633aee4680a2"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "08e66b1364960b918595841aa751294b9801d7a774a7e3ea74c9e71bdea9ebc7")
                          :static-public-key (core/hex-str->big-int "266fb2b001ab44f6791af96d220f3e4b7976cb5dca751b4b8982e32c9134afbc14e1fa0f011e7296409cd3648de0c1eb32a846846ddd842b7fab72492514c70a125e5480d2def886b62028b748cdc70f6defc266fbd7a65931c955e206746541dffbef7c6d25e35a2c16d8cb0ae178f109b24f9c7afec9cafc4a2f42d61fe827cd59ac18b3b5efb10524a9e5d85ea0c9fa8312ada08adede02b0e4752d34a54fde1573f322cda556ed657d472effbb687066e865925feff83d54312bd0398b44c953e1dfcf91a6ee0d57d2e8e9265d163426c07348bb389523c630a2aa02de352d0567065732332390e4f3bda4030669675f976c57995bb8be7d088781a32927")
                          :ephemeral-private-key (core/hex-str->big-int "9517ca99a3b51fbb4e45304b29f3a896d06659a7dbadcce4be6a444ad6b5bacb")
                          :ephemeral-public-key (core/hex-str->big-int "16e7a06ea109273c544c563e43ff608a6431f8c54c001b287bebf58591bec0665a1af88ef534ba2cae7d2d96f794038183d6d57a08e5b3236fc17b9571831fd5bf51c77c027174d307549ccffdafacaeb1b087a2165a5cc9753202ea3d5455f5ae913097f97324339538c8363294687a7dd7f058899d53e41b1692e9ff934f79c8580b03ed3a7d235be12855886efca44228ca3c9bfa22cd3269f21c3c02834b9022042cbae5a39391138b2a3b08bb7dc12772aa3a6eb5943cc83e021eeaa4575f80967bcc7b10810e070c0b463ef3ab618e0ab1d21210ec4d14709a65d4dc8b7ee4c1b8dbe8e8d814d7de080fa75d274b2058251d453b0ae7c5016c8be93f4a")}
          responder-keys {:static-public-key (core/hex-str->big-int "767376690c826aff70e0bfcddadbb6be6ef31cf70b7541d33b383847e8d5aacfb0cadb1906b949ed80f42dbae213b810c329ab60dfea98ff8dbe576012853bda4988eeca42030dc5906317928849275f7fae431d8b51f1b9202fb98d13dd0f9e6ee24a37446197518d937786b376139ba710992bbac26b70961eb4a89dc45dfa57c9b99b2f3364df689e35fa78e6f861870ab4dbd488c597a0af7fc1e9446c8555107cefb67988a031fbb549c4c6e96b3cc7c70cce68d859dffb27429e55c3d816f9357c182fac79c210740ccf512b88a01ee30de96c5a63eee4deb6a2a9770cd2c52d6265e4b022420385c5e1a79537dcf9321ef2bd7285b455c8d3b5434bdb")}
          Z "e35607f53a8b7701aa619eb1c2280d097bc6ca9d82958618c855ed47ac424e0978df3f79b5eb864500ccabb8e4db9c6079a48db7b6a1054c10eff0005a6f024aebc8be2ecd5b898ab0c3c57c5f8559372ac5ded9d780721780510c2e991bea5da0815ba6ba0aec21c02656c4df52a883db55f3560b783cdcd1062d516984081ee90de65978cb7ffbdba6fa405dd61602d59ac7903161a16805dad14900c9483345d2e6836f93e40511772b19189c31051c36c0a56f2174da6ec1efffa3a09da40ba4be5d66972a57a3aea6abaa2fd556037be6a9b94fbc8d774e103fda1dc544f97204da54294f596c6f877516e726e7e20b53a4e1ecb83dcabc7c36350bfa9b"
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "c8ba43ece74ad1ebcdfce326d6da891d395402db8f4aec9fcd4886b4d8cc03a5")
                          :static-public-key (core/hex-str->big-int "5b79daee55c3455385664f0fc5b105f335dcee33cb5b3a2858fdf69a41aa81ba6cd76b12b6fe58658f6f92a0443636ab04247f1b94ebf0d6a7ee3139e5ee3f97f70dea7ed6955fa1fd45ef14ecb9c6a6f6a3a6f19ffa3c69bc6997d7bb9b174f5795c5fd1a2b65174d43ff3533983686f4b20e988032b73dfe9de957bcec7bcd543a0c9d4edda296437b7b27d9f654fb1a57ff0c8bb17e36a58e57745af2f4eb85565ef7940070ce3f8b21822ab96b0591e9cc237cb519d30c7f73a5b3079df487d34a868ff413a327c708d132d75801986f2c953bd0f8ea2476c22b1e96ce9afd035f1c3388c929b2108d5d7ba5e3c1587a5ba7a80a4f490be24fd0ba19054b")
                          :ephemeral-private-key (core/hex-str->big-int "90e96d9ee58b62e14f87186165ca0b351422bf6f9a9649cfa87912bf43f00d29")
                          :ephemeral-public-key (core/hex-str->big-int "2f7f1bdc3b3a8b23d3607ed54c294ee35af129ed56ab889af91420f6cce608b2d2325146813a1539687a65a76a5444449443b0a1cc96983d8c74698776423ab978c1e70cf6e3ce7b470825af061448ad086db1c9218de13ddec29b504e7246fbb64816b1aa58ce5054c6fb2c229f2638f1e49009ec21e3c98c6b546868d6c04b34895d7be94188bb0c89abcaa63e98503780e322f01588abb6538db693504b80a2e65a144e0224a7d0e97c3ff19b673937c15ab47448c25cfc163e9f5df2d3d59aef4eb109f1f8aa9cc047f421fa663b0ed3c46dd8ddcd100c442a22a16112359a23158fc3e0181874c88e92edd6b97a8102cad37d2f099b3f85fed3a8b9ab65")}
          responder-keys {:static-public-key (core/hex-str->big-int "a84f573aad8b700d1e79383cbf508ec6c494b2f3d287a3fc9ea6d6695e1c15a2a4227861d9d3652c50ed6ce2eda62b3e44da66eced16b43cb79404d036be70bddb72d35014cfccb122b028233baae8227e7384e4e3bc322e4942969bc025443ae358e93e26b7285432311d87329986ad4104cb22da20bb14857afaa9b4158e9ecb3896824dc9a32c2775a48738d5886099977de9cef042171a39df5fba46a02873b42fc735e15e36dd408b9898b43a75d18abd486ec2510ea6d4d2f25cc0cc99f882e5ba789e1df5cb1f35d35b9fac9833c1ab00bdadd10b4b82839d19d364b10aab5bf476187abe0fc5835ebb61a6df9b2e1e302e79ec6225079494c8b0abaf")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "6937660c3aea24981a28357b5419670bd389ac97161598d4d9c01f4956878bb4")
                          :static-public-key (core/hex-str->big-int "b8489e78ba58b7fa3e476c579659733eb69b0cd23775887df9109521aa9c81022181b53b5489bbb26c82e42f4ebd0d448ebd7f0864e9ab5fe1ddd2c7bc8a0ed68a4d9186a40b13f612df3c4a887a1777b0b53a8f830415e08c17bc18dfbde6550764838effa4e924d5907ea0ca61c25ed20bfc0e253a85fa4d052baa0309ead0d91908af2e12f75428f43763e221b0332465dca89a164e083689a23df64d9d07b2680517c6047f4063e244eccc21484beedb371f80bf6954deec09617333783874f0d199eeee4f5e73deffc8bce76425194ba9f09dfd6fccbc0c33f63a3c624ca790821eee153afd3190e25ec6dda4f6a03aad2725524e5810feab08b7fe59c0")
                          :ephemeral-private-key (core/hex-str->big-int "0aef3ab7f223055225af4892468837f70290d2449671deaf7c78e3a613c7ab78")
                          :ephemeral-public-key (core/hex-str->big-int "2117ed271bf9280475a374b79f3e4e88d890dfd476b60a670a37b71e712c1cafa1c045b8b10f94687a019d8264f53ed12a9f2879881db61c69304a5320c4fc11562eb3952ef0dda399865442539026eb0accdaffc72dbdefd894fad7450cd01aeee10b28fb8d224c4ee42a0ec3e30d33923a38e61bb8594f62e61d73d7426b41e83e29207709d1ea86d754b1af1c3c9adf119110ef81b96b158b17c672e5c380cee334bce4759c5d3bf7103b923a1718be30f29fca998636abfa809ae95f80e726e956195174411d84c269e7045e25fc105af5f663a23652575e85614815e82d3a2106598bd037b3d17bc780b674a5494e1b804f59539f910061d22315b3e5da")}
          responder-keys {:static-public-key (core/hex-str->big-int "171a5fc870edec84c46288c1f069a34be956accedb2a328870c40ae76a4ce096b8fdf01df259b04dd0ed001461264965d9fb161f4e3168fbf7e61348c3aa639132ed21d6727284eb29c3c7ecb3a8ed23be5525c6c055f007e787c5bd5d96acd52c6301a175f51858e3cb45ffea18f5acc664e01419da3f3031e0125e5b0ec07510804081d7b7e95b152f88380653b6964a6d5c49f3948830adb3df388e5f028b3d3d566e291c155540a8af8b37f0e81927b0b5cb6db5c2835c7165c6d4c0c899e876f34f2f2fda2d76da3d0fd5ee147165a998c9707915436f833e640355d5574add4f3da96ba96b5642802abecbe5b6ad4d6c01e8c45675541a37e28a7b3a02")}
          Z :bottom
          result (core/agreement :mqv1 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))))

(deftest ffcmqv1-nokc-zzonly-resp-1-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "e4b76e6340a1401c4ed68cc7001b545ac91bb7f9160b3b9970718ac1640ef282eb857721e92a89cf8082a1b502f4507e8e4e823d2a3dd6599dd21563c3ccf5927c617f34ab0140d089e695f378023ffbbefffa67b11c7908961423464871834197366b9a7fcdab946dcce038cb8af529d4f9f195692d27b95cde01c97536fda3f8ba39e7917736d4034416180ff3ea24f947c023dd2e3e48a8de0989ffddc7990c7caa945314f794eb1aa8a83b02842eb80c7e87c3467ae10da0f790377da14474c05b63d0337e70a5d2e504845a10966ff4521eb99a7091a260e03cf7b63d6d8011fd924e2d4794a250401a9a14b4efa83a8e04e37f6b044a1e4e17d7c872a3")
         :q (core/hex-str->big-int "ed22dc4e95dfffdc242b1f5a945bbac9144a09889ec8264e71be1fff")
         :g (core/hex-str->big-int "568cf07f1cac4d60025fd368dbe58a4dd1a12a06707b0ff433b54e579fe8779228bbc820e930312d8144a2e980ed5b5ebef446663958847e27cf87100b4ad12b4e92e1ab44147ee4a360550dff7e6fc116b95ecf2b721ee73484396727e9174160cbbd99a6ab54294b04927ff3d210cde189a77fd8263c4e338e0c32d0f8810d05401b478d22f8dc164241ab8be9d929d478df2794c75f687cc6f4b3e88a730af7bbd2792248781ffdae285c4cc13457d33b95fc6e9721651e952779b117a158848119fe62637176360c77e3766ff81876dcfaafed97bb0cd73083eb9a3dabcaf0a2c6710fbf984abb02e7997d67d5af3e3f6e28c59a818909dd90308bd8d43c")}]

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "aa2d2de48c37fe94eb43839f3c321a109d66b09c08462cd32b1aa2eac13f046360b0fded44e1d517a58eedc16983c3f019893b601cee971d83df46745a317e7cbc4b7ff5d45b9f96ab5a0e5250a654ca6f429289afcdd468bf00c6ccc81bc7b78034e486f8aee61044caee2434680e5f8a3bb6b8a5130986f43865ec7b3ac26ddcad266a69f47a09a2433a2e4318b5630810786c20d35988f3cd6b292f50f54d511217148e6b01390d64aee3dee6548e5f951798951af1cb713a48950eddc20872b130f9f5bb860358c53ac8beebe8a2d49c1fba8148c88c539f4517ca82e2ba7880dad33456216fc5ba51f0c318f53192ac002f42980b91886ceeee6b2cf773")}
          responder-keys {:static-private-key (core/hex-str->big-int "ab094ecf2dced41844032a4fd6a24c2ea806663b3229d39eedf066b4")
                          :static-public-key (core/hex-str->big-int "be4d9be6f5ca19e14e81340d8668d86a5d3e25ee5350f97d9db803f614ecab6b5fd176e214f6f4ed813ee8ed35f1c13c759ce9a55ef6a44b3ab96dd6fdba924361c1ebb56939bb1178eed7a4f7e95f8e717fa63cf377720815a67222b30d6c7f95f1acb6fd3e537f4c023b088343a80f94badf944210fd35caa03ca270b4fc9006e25231270a0511133f30975cbba2961d822345e0962a07b5723364a7bc8684b1b7cb06d53900938b15087dc97e616ed86d14caa371099d63c75fda4c826473515e19389fbb1b2f6b38e15d853b3d31b88778140d6f8eb1bed017e98bc7f8fd3eed65a40d4938794b737a3c2a19c53f3614bd5e737a76f24a1f185dedf281e0")
                          :ephemeral-private-key (core/hex-str->big-int "70c17bfee2271831a74719b0a652669f40c038fb8bc357d3ffde543c")
                          :ephemeral-public-key (core/hex-str->big-int "d76f7d64e433036c7ae3f6cbafda73e7b3fdb93aa0806083ffb0f73b6b6d0e0bebbba199a685a99ee045cfb637c64225124485fdfd45bacee06bc2d507ebdbeaa7e91cccad843995c571801e08b5dbde7d6110420f4fb723776b2c6b26d7471dea5e1137142f60c7ed6cba6e8396dbff65ac0d3c5b17000fb18e56dea4af8ac11f11929ff3fa7877064a816e47bb7202366d1a3a8a0f0761670d191ff23ba900aac9522d7a3bb91385493f91f991b1211051476c6f83fe19c15e45081c772a98c19bd50905df089faa25e1798e7b711d7f88d173889ffc557c1b42d8379a4d649953e7c46ec629789d8c409d8b7b810159ff4395f1862a204763b000fe8b3f28")}
          Z "b6336ab7f0d3a2889e0381bc470b4daf34feee5ac7ee2e6ea3270922addd758fcb4239ad2a392df58e335672ce3419df55c551899e16f741b644811897aaa8a90f1a0b7db0f9cd96a3bcbe1ad98cf7688b79448b055c3eb509aa78947c7da57a80413a40c81a10477a62caa6a4d4ff380ddb634a93a84c722850e621147e54fe6a431dcea84f9adfef327f61f0e487606e1fa84e4ee342cfcc3f7e4e091a46a410b58f259919ca59ebeed34778d94db8752ba6709eb40d76e0637455e6f063f2af1463abee31bf7ae04d6e5dae7cd8e69e5a3983c56b8f018e08caa40d4b5ae1fec738bf902ea3ee1602da3f045f3f6ed0e46975c15d63d723320e6b0a4b335a"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "824fbecf1935019695de0fac1490d5764090188d5c40a0ae74afe65f855740bf6efb088e1b4d4cfdb7828e14ff9b3a29a56df0025e16f16317284f58cb05e68d821fc13282b3827aaeab5291d7c6dc594310f9175b5aecd2225fdb03f1c545c0def920d6519da13ff5508dcd0acefda3488a0ec38eba14ba3b86a557607167f3e06e1b77651e83a23f66c92e04bc23e52caf443e0c7447b7d013122fdaa368873e037dd05f083ce7c3b84ca66db02a45f5326f888e6ad8294f4f7f56b851b3b3628ce892b6a79c964cacdb71918d38e158b89a21da47ff52a2f7b05b40da865b11e1c9a697a4e9aefc9e231696aace3de824dc8af8685751aea2a1149ab29798")}
          responder-keys {:static-private-key (core/hex-str->big-int "0ccacefa6ddaf9633e768186bda29fa5877f90384e27de8f4d22b215")
                          :static-public-key (core/hex-str->big-int "e0c4a545bbe1a58d26c97ec7f38b745dc984fff12b79b04898f89043e3ebe8c41498d549de89de7e229cc627ad39b9d501f139a72eb3bb8a2030763384dbc1d82a272e83356769e0eb6c4fd2fa7a5db329b635996963f73d9cca2a4c216ae9439cba81e575feb6383023ed15c03b04268eeac1639d017890ed85ece83421bb3f36d9e1d97dd1777bce6cd8d55576dd613c993ea820a3d1e9438b441a555a35342964347865bb4a5d78c0e9e4b494c017d0fd2449a85e46fde204b0fc82b384b19194f0c1c318ee737a914918763731e1da2f5dec2d45e1f56f63dc6f90e50b310cd3deed1d15e687dfbdc629e943dc685fd884602283c9cb203d8903bc7bb42c")
                          :ephemeral-private-key (core/hex-str->big-int "b27f8695495e8879d6b52746610420919cf53d02de2c5a480dcaf51c")
                          :ephemeral-public-key (core/hex-str->big-int "3552e0a1e246eb29a775ecac7359e54481520e32207a5ad0e904a9f2f89d80f638f6f1ab650ba2ff8804b1e672d5496f2dda00fc486f05f380bccefa1b01e2431cb460434552a894d6fa436dfd68bfa0da02498f8e813f95745d7310285e27ca3fef5106b1fed768e2d51a2413235607400644dc241a717b6a870f16dc93ba2fb48ab05d7676e824a5ea73ea3c9a99ee1b0b59bf5633ff03bc9ec53bb6ae95edeab7039eed38788ddbd23064594f23ca75e3339cd6e3c4aa73f719b44f06889a3927d2983e5f23fb63928a23548a61ab7cd4e633ec29ffb731153141eb16f6c92ac11368054d4199bc9b45ce2255f44a87ac27c2e03e2bf21ac45cd0ea1beba5")}
          Z "9c9b11d4b50959ededf9d6bacd874d4b4f03f62416bc701430f988ec80e1dca4a8a4f83854449ec6de3cfc75a20f486c3865dd142bf62f615acd86f4b1f56bf2a8d9b5a84dfc7dd26ccbe9bbda25f16f7bbdf6405f7beac8cd68983f7a8dcefb7864d0c746ddc2322c2b26ac31129a314779df69b90c1890502c9d923e7860ee2bec40b94f8b0cae8d329f7e1d7e8abe87c4cc08cb26489e34c9382a7ae841fa0c852fd98c7da9cd307cafdfc61bce0409716f98082daec04215c7d761b51dad15f466b57aeca581694a79c116ebd800da451f6a95f680136b774717eaf606f5936976d1ff14e81b4eaaca98401e643cf1be00ba6a616dc5cbed48827d96f8a8"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "56cf5fddfd373718daf45d2c155c522d83c85236deda598f3d1f941381f64b13c290acab6c6798bdee01f17a1dc945d5b6e3bb6ccf56758c7968e1beb06d0ac31a7700cb4e202d9368543e05058e08531ef86eee76a5cd915dee657fabac26f959f60be20de5d491ada3159f76460d474fb12f4dcbf329903000912f95cd632a37744dac5fcb01692c2969c755f3399a156fd3b02d715eeff6cae1c9526a5fd1e762609df005e6facd152e545b5e8f5a233afe2399d157b2050d361f200470da54099bc791d7aaa5c9ff2e855e4af33fe80b88865d36bfe8162dbec5b795e473fee99cdd2444c5f5974d6cd03394a614449ddb5d0b9ba0e35dc07ca8b68100cd")}
          responder-keys {:static-private-key (core/hex-str->big-int "d031c7126a4654bbfff8f5a3f35b7a8411aef0a3311845811c1984f2")
                          :static-public-key (core/hex-str->big-int "4c59ba7080f98cfdaa988e20ebde7c6700beda3418e41bf7f792c825b15e299dfeb6664ee9204084a534ea5371bb80568d6c82972bbc3c78ef5cabd58dd4fdfad755d973dd9c70877e343a580d110b40344fcdf37bbd65fb1313bf2806d2e6bd3c13cedce7049620df775a44c8fccfe24272ca0379a8a92bf043556a892cb081e5ae8bf62a22c3f93041fd6f475e001064b718151d7b3b6a1d227fb9ead7e705ef07d990adfc5baafab330cf17a878d53b5ba4ccfc0578d0a649d93d8afe1c82fa1e0e3f3462536a49523c8ab1a92a18b6544c58b4656943a58f05e57842047e2940aa060ab015dd518e4fe2750850074a483627a825e7baebdee1e37f37e5df")
                          :ephemeral-private-key (core/hex-str->big-int "6064932f72359b6663046dadf9e69b264fe5caffeab628e427d9a056")
                          :ephemeral-public-key (core/hex-str->big-int "2e2d6132335190e76c6cfe4d87472d885e8989131a2b55367e1ff682efd31eb948c85966681e82489f3828e3f1634c62d221716916f422706fbb7280656e1a6b850c865cf436041125a4fefcfc2083e019a89ff3bc44e12c7fe543daafc4e51e43ee68151f1ac7948da7cce58f76836b6e96e8fbe1143985cf841bbb1bdc910e76a3ebdd8a267e5e3be077523320d8eca8eb425842c9a670c7fc65e49ddb1a960850a5c8b1ae68e47c4438531d3072be01820555b334533b19c098acc40d20403b45325fe7f6dd5115a81595f98670e86d1984ce21453391e3b739dd3b314250bbf0dc5aef88f318d964f8ae90a1199f33d695306949e1f91e238b76856888d3")}
          Z "0c71597536fc7a5d1cc3a02c65982463efef458aaa978033bd82bb65b9b5b9b8bb13b53b2dfdc49194a11346cf36679b32a6af1a33ec43ba057ef7f6fac31b38b8383c20c57af399df6fdf374ba6aad06d7885700851c6a828185061ff94a6250d99df311e0c842e3faf898f5e6151c40a9f3ba92d5c8d5f26c92368d577cbc6d65ee716f9d2f5196c68f524c39680aa153ca0e31debd2b5afa5198c3830eea6364bac6a338faa446233dbaefd4182020cd434f40f0066833e7266adde062dc0577d8484b3102fa455f913b9d0187b3157b07e00fd26adba98f818d5d9a8e51a2b08f1ee52ddcc9bc61939bd1e05f3178dcc05b4778ac9071cb7198fd1926ca5"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "db074515c7b0a666c28b62b59969896820934141766025cf1ec392842420e6608246cb31aaa236ce610a44ece089593d17cf444098ed9d6fc9383114fb73152a1ddc1ddbc2d12eb4f2fb02ef89d95779832a5dd20c83905124a6c5e7ab597b1b0bb956237c5129f236c33f6e53d306b82dd05552f2b4b49762c839f98c43f836ddab78513d86eff400f344a3e3d2d081506f897795968fae6e7769c068c8509ae16a1896e9bcbc584f764a40becd1ec20c0a8eb3301815b78bfb52d29a5029d863a67522aec2af28d933d3181909b7122c11c1b742f27ff88198a46ed7a5f4b8d3aa30a7fd458f1fa894f35254613bc8c271dd576d963ef7497e28b94804858e")}
          responder-keys {:static-private-key (core/hex-str->big-int "e49c5a240b409f956440b79d5cd42b5b2d30f10835dd4f1fb66a7c2f")
                          :static-public-key (core/hex-str->big-int "d09482de7cd0dfb1bb1cb6f204f42bc8eba56286703b69f5a11e4c63c9ef41cc6f9ef41880bf79f6f9e6e7d7d7870ad6e4f5bc845a06edd2e81a8b793f1199738daa8b583677c95fa7be4d58d22472efd7cb9902051c3c26763cd52b09fce25d107c7201b50e43cc4df699e6a0ac5002933e7857e364fd0e5d14e8fb08780d824a85af74924f62a321399ba75d6bfc1c46cbd47479079eb5c5e2298cae8e838a0cb93289a138fb4bc6c0c82bcc8048b5cc6b9902c1df684320b650618407e063def3886d72c046988eb4dc9a6d73d73eb7e76f8b7fbf95b2cfb81637a658da84e5914346d3937b0ab555a6bfd1dcec38e000e9501289b1c363691615ecfe676a")
                          :ephemeral-private-key (core/hex-str->big-int "068cb07f653dc1e22ba0e6952cc39017cf642d3017793274df9d2efc")
                          :ephemeral-public-key (core/hex-str->big-int "3f55e0a28a69621f6cc088a8e816989ec7aeb2d477a83e31bf01b306c24abe5441432290a1a86b865f08d73854c04c9245c8c7f318258920239e9fab6706b76cb9c092b0542bff8f0f6e662afce77d82470593a52a8a940f841176451ae0a2a89e34f6e6324e7364f1e052f4da580720a016fb2b7a239ce4ef9d68315e3d60815408d9dd3cfd80c8df55720487867abea37d7c05f5348f4d5fcadea10818f4c3dbb5a7855164dcb789d07ef3ef0e7b9845f948af04a1765f702f912ea3d4e10b7f8522b9976fdefb22ef8e4691f44e4087466c094418ce79ebc889974717e3979d41f3afb72fd3931762a636415cfa7159b5e3653700b3a195c0d839b2ab426e")}
          Z "dfc69977b027359ee1e5dcb26453250b6cba77d3637543a200570687ad05fb74ac4599507c0da779e4f2391722b536570580f387f9d1953fbef55d276abe41c27b9bc7c8f996d5779bfd307adee560fdc41eda31b207066a893ec6042730e31430a43130db8660335b009d8bfd60b26aa1ccce28e582251b3e9d5435ddef1586dfa4e4b639ad81a562050e6bb842ef1b95788234a664468619cae729bedb5be1d3ee441eaf814c2c43e8e502646c7850070ca9bd999a7539d3ded2776da09da06962820fca4ad20fb241c76550f2dbe198c61443ed96396a1550fe025875d1e9a785af4e7b1ca1a1015d77e490477038d53929a28d81f8cd368c30e5b920249f"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "0a8229fe378e4014ac2e68ccbac1c737f614502cc8e7b51b8fb2edd1309b6f762c8329dde96be0acc5209a74653794ba2ddb94576cf6262fe3e428b3032560c10d1c427ae6a29020a2e82a7daf9040ab7adfcc79debf73b72969b58a6570a6256f82d85856c4496a46b5aa8fee56fedf1cf697ce09951cd4e9f60fe8ac714da8607d2d9d249e6c37c582dcf037e7959037808cc0f81571bd8f5e3f281c20e0ba5d3534a0e45554d0a0f5cc2228f95d6bcc5c7af1a9db973052e2f2469d50427bec63bff7e55c94a6ec96afc523dc5a504c12e30dee5aa356ffb3f0a5a917ec9bcb40bb6a92bdea33180aea7fc0dfdd36aaeed17c55d7d8b1f1eae51967379bb0")}
          responder-keys {:static-private-key (core/hex-str->big-int "c669f61ba110e43b8e135c6346d8ddf972489067fc885910e5e03e14")
                          :static-public-key (core/hex-str->big-int "31495aa9bf81c41930f6d7f18f64c564d704b61ababe7239f67762ac5b02b57ffea4d725c68fe906ec263250c7db21fbf0c89a714ed8fb336bf3d25da9bdab0bbf2f958166ca2361684367e26920b8b5888500f96f4a64320b8a8a4e7affc2635e78f593d19a2589e309c4558ec1c3c86f0f2f996e4aaeab4aff7125b304f1f628ce6a1f002d090a4b2249354acf621618f7f71cd46e9d7c0e6c61c61da7608f4abdf7a5baa2520497badb4f14241a382130d87da3f5c9f3694ba3d8fe45e28dc9b776e35fa9bb92bf82410b05771795aa548901a4c9818871ac96c247228648bc2de770333ed9b8b3dcbf828b8dc74818367d771290de073a41f4d7a128352f")
                          :ephemeral-private-key (core/hex-str->big-int "781356d4faf513c05f4133bee07c659b9e209eb0197600ca22a32167")
                          :ephemeral-public-key (core/hex-str->big-int "be96e0fd0b20136cc36d3a46774be7f8d3672c57b2239c52a2522dc17b70a4150543c0055ab9fb39c71cfaebd79854695007ed848bc0f0eb97677d53439c3a1f828299eb35ffaa88b6b3106039c2310f9b073e26836920fa3fddbeeb00bd4b432618b1156ac851d0b869562efb403293cc32b7667dc0af82cb6372579efd9d464e8f497b2e1400ad5ee300fa8c9281801ba6c7dced657de4a40aa1bfbe5b1f83c97a4938b72b21af96b5cb2071b37e6c85fbad96e79606a282e33457bf44c14f17b9d075d78454ae41b1ce7e657ece4e86b760102bd5e8436449d8d0bce640e4c21898dbc0d68bcce0c799e99291c3fcaa27c954004339ce07523e294edb4e5e")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "6d619fc6ae6e08761f5e8570288ba4738892b0273c4ec5725de97715bd23b48dca86db3414eba3f6f29cc942fdf5bdffdd53f5e6f512e45c93f1cb44a2b3cd135926e6fdc29604438ff52ce0b90381d93a303b8ae15cf46577a84e6c076e6edef3351a17eb3adf1d504cef5ab9d05e9da25585fb960486252a59748298c5bc46b4b90e364f2998395a46b0b0f8142ed7a4cdd7adcd1b66a84cf12f44d07c92a4f4cfcfc18ac689dafdf8046129408311f620df60810b8f329fcb55750d7fa89d8d5aa92d607085a1d505f60a892a60e81bfed09f6ec39de213d9d04e6ad02107fe8eaa0fb2e2674463c697c0119e799451ec6ac29415fcbc3b70a86c48b1390d")}
          responder-keys {:static-private-key (core/hex-str->big-int "71e6724b4abd95fa901df2269498e5e1a8bbf98791af13ec140f419f")
                          :static-public-key (core/hex-str->big-int "67750eb98994f23f996ab08d53a1b83c9d39f0b069bfec7b75404e83ee9e2694442af6bdb7d85c556d7549ea86c60c9cecef3692bdebc0b984617015846df6455b2d7b8f67b4e93306652e0c8518f10bb68f8a00c710df65c9b400bf8f24b6971040a373712c9a484081032272144bec73a107fc315fab410d76bebf042e42ae9071ab06285a21f04d01a9c353fbc20c2631409e1310c087de8997747b055ce517024847d13acf034b54565ebd008aeaf4ec9825dc2345f377d4fce0904c45b6ab52defe287b053bee58c5e8eb31944737daa324560e69ee1acd1ab7cab267be4eb7b35c0c28f922835a851d0759e334cf0964918c1b421d4e48381334e8d473")
                          :ephemeral-private-key (core/hex-str->big-int "69b86287ded9d87af9d8be9700d78bab39b7299d34b2c4c3d9be795f")
                          :ephemeral-public-key (core/hex-str->big-int "08ef5de810c33280a46ed5dfb20e56514ea902afa0128d875aee06b975f886d30698dd30b314796fc053c80966b5c23f7a3b3c1d17910fe093873cefa9de24db08a1f3dd9d97e08ffab2dcdd13901e872b4776902966d738e315a2fcf2d43e054965c77a3752524cc516eac0afedf4027d160fb9dac84b834e3e981642c8911d0eb95026448da00ecd154109b2f8029b70672b625ff067003658be4bef8ca568a3f0a62c248d082ae2c0e7f21a5ce79eaaeb626aaf01cb7ef7c9a32cb4139223fc18ab2d55ccc39c31ef5c66b02653db80fe2b25b3db578eabcdc10e119565a973e1ccb6ec8e936c366c2794325a938938a96f670d1148ffdd5be07fab8b89e8")}
          Z "8515c3069f53c260d45406c24af2ff8444dd0c0ee47c07afa54d52f1170b0315841f7b0fb53c5abb8fb05e5c483f2f7c1127a9dd158a64834589f33039d89e86de7fb5ef78895de02f8dc480a78e6710c420cb28eaf3e668247a21ba1e3d98a73f6406c3e0cbb2f8b70a08fff046fde89e112dc8de9f4c0bf4302813c00c54b82d8749dfceda12343e66dd772ff6b19798dc2371cf4afb630c37c1561878e1512309bd64f7fcf64ab91ce51db0147784adcc3c5c361856310b45b1fdef0e96ad28953a6db57fd8feac3bdf2786b76828d1b1a63d4693dac76a5d3fea97a1f54db8c9cac37cf909c9c24c4eab47be140d7cbd48821e59fa5ef3a60a88574395cc"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "5bb4ac3bf3f51031b73b1e11782a60d1f3a567c988002cbd494727f40c83884afb661e9a7bf1d3a5e86c22a2a19dd30c178c6a2cee33d0845bf0f141126e64344ea573f1989ca76264ed52fd3ac556685c4849250bfff8aa7d5d62d089562a399b55152192d9ab18c36e7357299898a088d5bd82daedeaef9bf77d52160e76107213d3f56e64e0868c762948375cb6a0658f27df9ea49a7a5559221985ea02ed6e4b16fc037fc267f015d80a19dff4fa49e2d73f43bfde93ad94ecd3103fe0a6ebe447a86ba1b5f2a5255a45f79dde52f868818015779653d2427fce14772b57ffd85ee3226122600b9fd3e4fc8d8c562b9c45a099a738e50e12cc425d058857")}
          responder-keys {:static-private-key (core/hex-str->big-int "8a12d5cb09818e85bf84b0912c8726d3c4eabd67b3fcb1e08139cf2c")
                          :static-public-key (core/hex-str->big-int "dbb338a5cb4a1c798c5be405e9a5c39f802d73e660ae2b215809fb4b8d470f7a29e86e51e2497ef03fa42785d7e7c34de18b23ee06b1b9a67f0ee8731939b562da76ce81fad15bb90b62de35e7bf6af9a84c90059c941b4545eaf721ceee6df7d1c8eee8056a208c38ccd77fe2a8fd76c25ba46c9f273425e5eede4c2cce54b3f8b5965323ff9ca6762d48174f05a194b7d7f35902126f801f5a336acc24d64d3d4d7487e99cb157d8bb4c75d47704f1bffa99e5d964e2454707b3c68a1304f6d12c39fcfca487ab24633d7f4a4eadaeeaced725b23c37d6ca57af4503e57cfd387e8e83b1be20fe28dd547ed59a0488b11f2199ebeb82ebe7ee4cc6775a53cf")
                          :ephemeral-private-key (core/hex-str->big-int "4e4e6f0fc693a06325d23344a260ebac04e0bc066ac6b47976a1106b")
                          :ephemeral-public-key (core/hex-str->big-int "ab431233626b1174f25547367c96b7b53a59f480881e5bda4216dfe0e2f8b2042c3c84c589bbe044dd667e38f9284af02d0a12150be1081ca975afd2bd313c5b6337fd8f5d01897d82351c19e4226cfe62d0e2bd4d50a62f10d0fe798d9f304816af254c5ec1c3aa1e7e69857958ecc26b2ceeac510844ef9b7135a1b18c31de5dd978c4d48c69cf330793f63d8471480fe515e677bdc9b8cbb2a062e509ce13b959c43ffb55f5c91d9a7e23077fc66144c5d0627e9bd47a6d9b0fd9526fdadc1df9706a4f3080981703a88f9af982690c996141dda08f1dc51d05c4db398723f27f53ff0f58cd681ec34ccbd294a7e8cce9115a79f6665c7d2cc7a2f51d8521")}
          Z "e38a85d20f7417809f20a5591ed07efa83e000a24ca81db4f8d3750357c483f3b075e146a2c97e9059bfafcd50d64e19a0e246d42061780f834a7a77292d7d1deb98a272157e7ed716fdde24dc7ee9fc498aedf3dcb144c521d31fb82a194c984b482f71a57662f2f6f16300744dd503cac7dc425d397c29d31bf4e05ea13de73e71f02f493797cca6f750a6832d152ac847ca09f9a5b22781db3d71fca454b3accbd2c00460b1af2f711b54eb3b62e7a65f307a17bb278427d286cee8f6655991a7717c8f0e0a05538373a4cfc84386d43dac1c1c168c56c00eefbc396344f77c5b1ba7c3d990ad0469bef33a310b80ef3969d7a073561ff86503529161bba3"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    ;; WTF???
    ;; > Result = F (4 - IUT's Static private key changed-prikey validity)
    ; (let [initiator-keys {:static-public-key (core/hex-str->big-int "3f780ba0a71eb94bf8176cfe9a4854b2d0d3ee5aa7c01062b73d2ac69d05a460d6fa4803e042215b12a9de517fb96bf17a6d3d7d97ef8964a49671ac595ca7bb9353e945d923e38a0cb4e851d07ab967af11c354292bfbafe3a9fc59c46c9058f30ea51b52f7563b70afc99e66171e08afb184d8c9b83b87e001b2241522421f26d94d2c0087086287d7c9ad77b8c873eee70f04dccb12494405363c19691195618d7f7207fa67e1ff374b487f6fa625704f2f0cdc6a18f6093502c0844e378542ff247c8b4a7d9dae984b633a27844a369ff78d5aad2f456bbbfc7a4178c37928ec48ad4a488a93ec7ccac5c464a5d4b6677d5520b061f7793bd723a40a69d6")}
    ;       responder-keys {:static-private-key (core/hex-str->big-int "af98260feb75b02fbdce4efc1453084ce1a9492dcd4305932bc88011")
    ;                       :static-public-key (core/hex-str->big-int "333365671c7c0589999ce15b4beeeb9f47866120a6c20ce46f2d2fa5d7a3659a6d4766a2325ec6bfcc37e5532923584c22be8c6832d043f1c17b7cfb751863d6b54614e426a88c7e4ff59c5b53a5f5d14b05e8ee88e3900014fcbc50714468d923d92d61007ec3bcf44810a314c245836e352a22ec233a35c62e821eecd2961cf8dd7030059901bcb1757360328b5f710cab2fff26cd2c4a0c3b4c7e14b41c215ca68f873d3ec5aadb60706f20dcd2585c197fd935089115e7b6e0431befcff7989b505e1d30c2c61e82238e296a77ae48a1e8340a4d8012423ead0305517f59395d3a4a7b3d4bc3f065eceed9a34d3f5abccdc491fe14115c6855a11e011756")
    ;                       :ephemeral-private-key (core/hex-str->big-int "979d53b6b4455a1d5f747b93571d43fa44b18acb4f7de6e75387a8ea")
    ;                       :ephemeral-public-key (core/hex-str->big-int "2f5b28b40fd5c32880729295d0ce842a6163d8985bb9ad09bd5f088906c107c85a1f375a92168c414bfb459f3b0896c31063c9dc1d2c1bb72bc28c0762e729b08902bd5ad1d6d4d55d8880f409b1fec5f92faae104035704803c33c2a96cc66bf0c54343f700e8c44d4a249b103310f3a211d20255fe5ba2ce841819c8760e6b9d205ad2fa1870fc48dd0d47ee1ad7f10b37fb3f13bc41f456decb0b4cffe55b91788c2fe46547978a269c1887daa90ea2dea40ea13a9dc59a3194636652e52a9f4df41a3aa370ec79eaa23ea56bfe1069a82f8150b79157625454af7d28a801915598021ab8ffe96c784307becdb9fbb3a08d0f3f39645ac6c89813356c4c9b")}
    ;       Z :bottom
    ;       result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
    ;   (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "1e85f3ff51604e5668fc056572d1cdb8f0eb69df24e321f324bc27594df8bf591775d11cd7c03c7449fcc7593243c790c833e38e2f83db8e9ee9dbc18dc8dde3ccfa93246d77a766aafc3e055d2248d185822d36f88bb0df20ba4985ae70202ab1d169e568e716b789236d1c5037597facdad6b567d5926ea9e8c38cc641ea7eaff4de1542036ccba01a069770079e3a74d297c2ae8301eac7825df1d50edd3134712a6b733932924913c45152993283a7fd3b8f7282933ffbd979443cccbb40eb39e9d94a77f1eeb9b9d99452039453de13b0a19fb64648c23169d34b2971c99faa894d22d632eac76caa0a4b576b58d2bad95bc68769995f9b42c6a8326f12")}
          responder-keys {:static-private-key (core/hex-str->big-int "a5940891a73eea3eefebca13e20d70404d5d9ab7ec73536976c5f8a5")
                          :static-public-key (core/hex-str->big-int "9f8714a049bcb537ad001a5985380d0889c18c46e0df5f6ed360801d3fd3937db04c9285ad7bd46ed00e9ebddb947d7f2007996ba1866bb52bc4ee8d56e309c6d17f260f1651de3ff7aab2039653ed44681ae446504c6fb1d2a353878b19835b0501666f1da8bf9bf6e5ad0b9ef500d73ca806c59500afc9190ac069dd0df5306ab1c8da1e59fecdda61cce599d5cfddca9d88b563b21578451a824cf4b29bd382ac992fdbba1631ed05c9e4d11eeedf933cc9440d0ed4a5bcab8463e9d690d7774fc4367f0626f1be377547882532a14cc8f8e8a799fde59828ffda5948a54464e2fa57604b65d52dbc45d4b10fbc02f81dd6e6648bad216ccd382f60957bbe")
                          :ephemeral-private-key (core/hex-str->big-int "a164f19ebbdfd18433a5090f9d196f6f2f711c61fc68c73b25ff29a1")
                          :ephemeral-public-key (core/hex-str->big-int "4cb60d5da09624bbfb8c10fc57ac67b888b091f3f1d9dca5888812d639355d43f1f658446e747362e5e83daf07d29e3ebdd39cda4d77d605086b6070deec720390a342771989d4d81f10ddd26795a64d02930db684a47a8efe6dce7369e946202196855b0c0e5b84a4af099ada8ab9d876bd929c02dd9a2e7d451f9623bf21dbb66b41f4fa5b9c10793a18f20d2422a87c88d82446196c8eac04f5498bb0851999934cd6a3f5ae3ef8f80724605b7443e7e20fed72f15cd1b91a384b4c17c88648456509ca416f672e96358032a3bb25a6b4b21ce314d8d6a60f7a960c538b8b096fe2f5209c3a7e31ac202866d4f5c1a58dd34c2597ee561e13afdeda2f779e")}
          Z "92a3cb3b7e49293c7fdbe7cbb351b578ab5c37d00948c3e4216f428075d94fd6e354404ffea1d65fdf07d62b4ba8cb5d3a09387d82ec54ad5c3c4170d8e14441e97291d21e94c943cd83330222441f5d7012f83bba07fc17913e69b8137475f25eaabf954b46212576bb44c97e6f183e7fe60b8a0f8029054c05d3c8da73c06ca9c00bdb7c8fe9a3201dd16562973614344d0d5857fba690215fa190effa33263151ca84540baa426de2ec36407b77cfe1ddc1d0ec97472ed8d155a7a67c9780339b400ddb16f2b1698aa2405fb57e748f52ba958e36d2b49706299988b27bf6e0b3afce828a17c582112366c4de7343c5ddcb05585d5c0388176d5e445fc7ca"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "878f8f9fb12f6ad37e00c88fc6512c931ebfb468da60bebe1cd8af3224eb9aea132263605b7f00ed3adfd55b0ed0c2f0743cc69c29d38ffc7cbe1e1db6a38fa466e8267cf6aa7cb3169693be9b86130bca7d5150a8cb429f7469f8fd8eda27049b267929cfd2fa02eedc1ec924b16640cfc2ab0d4e4a3946a67b9ab72ae050c1d4357136ce0832b46f12d70f508109dae0f5ead63f7b7c89731e43ad43ca7b16d3679e2d1fcab864df2fdb7efac188f0c8b3ed2e2741cb047158271003b35038f5b8da02f104e3e0c7d5c2e68ce6c44c7babf5055e160f25711bf503249e3c5902dc3d9b14ed629323838c9cead631e12bd96c557c5a664a89b0e5b92d6e490d")}
          responder-keys {:static-private-key (core/hex-str->big-int "390f6803e75e9956e3275a284a08b053ecad28c5e5bb2e835a27c109")
                          :static-public-key (core/hex-str->big-int "64cbc2b9dc854be2e7e6657a08814644b0a88249a2d3f87365643c3911ee828d52eddd254a4fa5d8b05ce1361fbbbb634b4e8ac1efd4b014c6a36c787c4a5d4dfab0b1e7f69e71b2a9d0a0df656870632a6bf4d579a472302177b21fec85b9cac9fbe5733a1b2c5d98e79452e0350afbae98a792ed2191bbf961f6e3595af6c7b5a9f38fb86a3b97c4ee1b2ff32ac48232260aae62653a90d76d1fb138571fd37148fb7fe89d751a2f09ce37e8bf5fc60cdd3e4aabdd73b2ec2f403c04d2e39892e773c9ac809036e05a314dfa7629252f5175c5aafc85b6ba1c338b421f924416f01c4b7b398155981ec80ae427dc97f2172cf7565f8124c92d50ad491e8198")
                          :ephemeral-private-key (core/hex-str->big-int "92e940c6fe8abbc8150a47b78dc5b99afc97104e8da6c9fedb10f412")
                          :ephemeral-public-key (core/hex-str->big-int "b01a68a05db15ccb46bc658c50359c466afa1167e60d0133c0d93ba510d9b7ac32d042782b9bb314aef5e9119dae24f2854c3a0532526877f6dab16bea1e716da4fb23070bbb7e44e68001c354508ee18312b1b4b8ddf0dd00f80fb4278bd41320352ebe994ea46113c6d1f8168013d183ee433f0738547252bb30caff136407e3835e8fdcf99bde086d19dafc84fb9482f86e8fce3eec64254331cabbd6a21ed0c9910062a48099fdd3831f7a5b3702d73769af5791231aa340103c86d1a17a58426f642ac5a1429283f550dc22ba69b5e77872d8a56f7e615f8b5262554cc22253a77327a2df4360f1b01a20eebe150c3fd3f2e7cea301523aaeb53eb86ef7")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "829976692d2d6e900826410cb702796ff2ac2b684de48dba595d320d9af823554284c515fcb98e5eb100b36e571ef0ae70e61a86f73758273d6897dd16607191d0276d70c7768098e19d48566c51ee491e0ab4e7a3271c0bf6f3d882ab18d8a630f5ec7fe75c1db83e2318c39b617853bd1aee1e63327f5641af34c4fd35218ca406fbdfb850c9cebd73ab9474554c6ef02c687911b4becbda5fc8b3bfc04fa972ee730eb05037ce248cd4425bf519915540476fb2922c110198aeb4737fc35dc09d6a7e611582bc81dfafb1e426baacd96e8cefb1c5df4e48c94c9a4a04eff66c227081ca03681872a3bb63846b7a357d087bbb3c68df8c3af931e86fa7cfde")}
          responder-keys {:static-private-key (core/hex-str->big-int "0202652415aebf82ea4fce187314af1244e62451496ed270b389ef44")
                          :static-public-key (core/hex-str->big-int "b9e9bb3a702d7ef906b063fd0943c5e3ac1287c250351c37c8403f87cbd3084f718f75b00eef713563e4c0b8d2ade35e9f532808aa80439c0c278a60567585718af21ea12dbccb127de9b03edd34898e18c1717279ec8a6950e98c7ce962c9ab701a2670e25e595cfcec3eb90fbecc502093336ed14df458c537473d541d29b2e4c5ae9c471c932b39609befd61ddb51688deab2b5c5be276e84f13124ca2fcbc0025e5480856692707c821c1b91369fe5c87462c917c2ae36a3e8a449c6727ba59e335833c0db19899b50d61cc6a6b3bca99ea9f96fc9abc648eda7524ddbea6bfc8271494999f5c9301d7010ab52d44711ac60e02ecbf0483ab4ab806fa618")
                          :ephemeral-private-key (core/hex-str->big-int "b6e2b4558e49e79ef4adbe2ea5d4af4b79c0887ea799f1c8136c413a")
                          :ephemeral-public-key (core/hex-str->big-int "83a70177273d8adf610dee8889f9d9b5a4e1706667b88831a106e5fb35302f62726cfce642897a5d3f90c14a4cfadf40f171144543192aa1a9cae5db9f1eb459f13b9fa79c402bbc59972a5cddbe03bf269177d72c979a0f4c3093c9d95331b057cde6d58c2b9a78167e732821aec4594a9c1a21e877253e0dafc836dffe176a833996ed2851fb9b438b43f3d858e8f4a7d350ac127ef0c2fad214dbda16e9107262350580f6a6a71457253efb1a56bd7da6213eb0cc163ed39a85a852870ea97fef0e1905eda59f4247ad5443e0ab20b2d26f41497cf0f37c904b3e264d81cc62e892a7824d9b80b7bc78d5d82a19686e04eab35861711e26cc188defb20071")}
          Z "0e52ec49962ca7397283ae07358e8b78c510f4091ec5bcea7c464eb4bf1c47137ff0cc844c52682664cb848594508498462f2e538006caac57bd5e351ff6380d01e62b65c9420c210663ec232629599130bb0bdcbec42c4d242afae7e8e974560e504c017ac2044b2d033ba4e69b06f85ff0bb6930e651fbb22bc0675261cbbf6949c6bb4539f446d862c2b550f562dd90693e6e5236982a18b5092c6b518451f5c7f8ef2a49991e0bf4f4982df265ef9dc670d91c1c8dd900b1d3f235d3fe5cef1545da70393e27679d689f5f226d015d36ec2e3800b4709ff5db5a6e2563fefea052dcb4bac7d69b98aca0071ebcd3c75b301e581cf11049de13d1597b6187"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "55e23446506002a731b4f4dfe5cfbc7c7d0100d4aa3a94889b1c1e35e0d18adbd39d2cd2a999e0505cfb463488e7fdd6d209d8087228fd12de4fcbb0498eebc3688b9254e4231b3fc93ffe99976e49ea07534b91e092157e04aa878d6840ca25838d9131e8898f741d287d076dd5b2e798018e5ee940500c3f7eb2044b8e935b88ed677f6db2e489adacdf3cd447036bf658253e417f65dab2d242110cb70a5764094b09a0fc3395a6291f4fc561f9b8ce11efa51eaef59e0d7c57b4da446b847373696238fd71e9c43ad412bd89cd3194622c4c06c4fe9799efff0e5bf2af450dffb96f67f29016fafa8aea8f8a461d522882e29ea9c92fe8a301995972d123")}
          responder-keys {:static-private-key (core/hex-str->big-int "89efa7da162933e49be532d58d55e1610caaa04223f0152190943696")
                          :static-public-key (core/hex-str->big-int "bcb52b09cb4538a055f290cac73f6d562f23891bf8aab954630875f01763e3be1f8337d9945e67257a3996c6995de47f2ed2f742ebf1de25e0ae30ef263b6eeddc5974a0734ecdafd3d36a513b8b97fbd884ee553a1eace6feddc48ed568beb6348942be3120bf7248f9c73ae3c1766502655f7375d9c9e2ce2131775f983e745e1cdaf9dc6ba226c72f3efa8ca879d07eb9ec2566bd1cd16d2d0f9a064f826c33bb265a5b5bf1966348e5b69fc7e5b04657fb9c6fc316b853e7bcd302b3108c290586409911cac87c19b8e3d31e59fefcfc254e1927f00aa0a05765c998a21b509b9c110918bee1a0593ea0355a5457829ce6ecbb79ec3f38a8c94d47553eea")
                          :ephemeral-private-key (core/hex-str->big-int "97aac60066dd7ffe96044430d6fcb7d283f1eb83d536055dfc06f53a")
                          :ephemeral-public-key (core/hex-str->big-int "5b5a854f654546cfbc1450fd35e98b5a481a32881eb349a321b20bac3082372f4495304f518fd4209be664c14610ba760431608a556cde2ce37282a82d4651d853cc5e34a0b774824cd6e851dc739af2c0291e90712765f954b7d38e2152f512a0b9d0b8419cd4d0b4c0e0ba9c9344519d0375a20a68929fcd560454e1c54f25c31ca6043b9831906f5f5aae0a6490e511d27a7b317159e4de6be3cb89ac3b614a0aac75fbfc9e2ffc914f050dfcff973c4def4c7e86f15fd8ffb31e7fbfe521015b9d9f6316d5a2160eefa2582291b455c4bc606db8a489beacb646d25b42b22b72f6e52f32d6891f2a1a4298282b18aeb36c997529613a0882916369e852da")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "bfb6cf26ccd0d5094a2d6a178479db3403cea4d133d960e35c6e0cbafcb27c1f6750c90004f6ddd270587073c93d4efdf96bb70d8a6878ae951baa9c2d7dc87f7344b4576ee908eec2fafea728a31d64df6c11593307a4f9311bf0a8379084eb8c3e30b497675e93c819e8b1c82d44338715fb38651b35a2aa0d0667621d8c690be13ebad8c09142d919174ae40ff95183867196396444aa95c644ac5ac4b079c954ff64f6c85f733d22fcedbfdd3b7047fd6aa003fc307b86b352461071246e6ea782b1d9b89c1566059fa907e68078918835fd011d32f82581d0b9aa88c93b5d6955c00e510375531cd589511c2d75255439dd9bf2eb8ecb46d883675c7335")}
          responder-keys {:static-private-key (core/hex-str->big-int "66af484acce0b0e82b20e8379817a002f9f8fdb0d1d4e63ef3c03be4")
                          :static-public-key (core/hex-str->big-int "65904590819a8ff161ab4ac20880bfd568d3579e4bbbb58325ec6c2fcdef928104aeb21b0264c1f0690aa7c105790467d38d6983826fb1a800328f8f8f0347150f3fe8756b7ab1eac081e44e1706d03111bf6e121eb35a728ed6fa2b3a81d3d3e929c9cd2b9435d1a629c4917057979a3b86164f07cfc7d03405d9ff6686d6a44a2233280e69b24464d463323201dafda20fdd3e18f31701003e49cb6f0e15b955ad59b00b0dbe7ccc9b2219d358241180d065c01c41bf0601e368c7aad234806487b132db01b1a50c61e0e5fc04fecebd98de720cd478f2566a47f814d01e68cbf8a9a328dc61909bee926096efc673327cfca3e990fbb5a1e8b41260081bee")
                          :ephemeral-private-key (core/hex-str->big-int "82e547cb5880d3a513f781d77b9cf6b86f7660a374285355d319d2b5")
                          :ephemeral-public-key (core/hex-str->big-int "d2909968d20716502ea2b25065bf7e1d64f6a68c93ec5e57474c20d0668ec9ede2746b6e387e2dbffd17a3220b0079503a3db3b8907621d2babe8f78b4ba507ff8c4e3d644b466db8c1ad1a69b0018f7232b12b52fbe496c260b4983ac461bfcf9243f380785ed522459549b3e9f76280d13e4d47944dda59da933fecdf204bb73ed482b400c4c4e910c8e279aeb0159947b2e11cedff168742d4f2f1986fed2f1a1b4111a576952072c9f75893777602cc37c9226fc5866fb6ad4bfdd1b86c88342b7df8d7627d4f3acfb7133509bf3e0b0f136041bc154e3b450429e5edde45d13db5a9b526d084e3f6ddf5ba87285b6df924375912b4e1564787aa3f37708")}
          Z "2a7adbf1b8dd5fb3331cbe450e64d566b5f5e33344e2b160f7e112d9ce8443b17d630b7232d7d0ea7910b8724f041470008d95fad2e1a0c37d107e2799b333005c7eed1b0947dad35e951eb38cc92d75fbe076cbc71694005811369d1e09fdf82816aab62d8917746e8d128955bb1b5a64e3db38e68fb7f56c27994702815b78c15099e3c5a5d6637a0ed67f03afd010645baedf5f04d8736be98e90b7074142160701a8ebf9a63a63a9285ad1af74d8931d765091c645ac62ab852b3593d151152b0c3bf8cae8d69b22233855ed23b217a236ef8dec25e806045582c5f29b4e8433db85f05c66408f5df78bc21777a5c549ae214721d2177b0776f23d5f670a"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "3ab7ba15f452db7745fb1cff9f685d8b83e9be5f8714d9640ae0082d779e6c19e49eacd1d0a85582ce3e335b569e920cb9de830a6ce2b6469026cb01279de7fd1032e148cc244de0805dde1d4b7aeca8793e60e824d0c422835c4fb388df99dcaa847937bc69150d61641cb06321799588a6ec576261b6fea6ec45c2d379e3de113b4ce5a232755969eadcb4f3dbc193140ea699060e53d297cd4f238bfe70358e2eb3793a7317b64f7e8899b59f2c6e7101ba45585575b3722a967b5e037b269c177761dc790c567b7fffe677a30007f6838999f7b9a15dcd692df142727af1c66e6dd7a8eda6db57be548c88268187ff4e89baac1a699dae723c23e11517f5")}
          responder-keys {:static-private-key (core/hex-str->big-int "1c0da729f1469f63e037e1b47a9c36102f4e302c98a43921158b7db4")
                          :static-public-key (core/hex-str->big-int "0cd2075716e200d7eed97598c4fa0d5d2008d8fc4672ea916a57f1b47dc98a503cfb4ab9cc061f20ea4013b74c39d8bd7492e0dc567ae151b8114e86da7b8d93be72d9bf6206d6ce345bde64167fd358159dd0dbded18a2dbb2ead1e14e1c082e43d9f7164788a8e04f6c1dc3193e9321bd145bd43097956fd5125ffb6609b3a6eb41d7c3cb859e1b0b4d877f88660a6e9a1655bc6f2807679d3fd256dda227620c7a019871775715cff32e1859d7792d3a4b60161eed752d6ca47ef6204843baff8c85c5cfa3d83a012f7aca48fc5044e307213c01df32033c0ece1f1074872f95fd120a386336d3a4de20198f423f2e083d2f474522232b46963cd64b4405f")
                          :ephemeral-private-key (core/hex-str->big-int "7e712d5c89792a1b2535a04eb852a20af50aa2f6ed4e6ccee2ea0bad")
                          :ephemeral-public-key (core/hex-str->big-int "4fdfdd4a789d68302fbcde5ac1f598cb819ea528421256ea3652ad40fefec5ad91e872ff437d7b60e5646bd097e62c7c08998ef7b83ff02b3110bae4bea3f43e19c46f8dce60f2e0b17e204e3f0bcf28bcfc44a8b6a1b55f4449d9b7d64e58e87d4afd9ae562fbafffa8dddbc35f650b5835636ab13f4bd316e0fb8065e7f460b4dc92678a87de735a800c4cd6ec0d5a8a23136fba0ac3c7190300134eca4afebde89a7fa3c4df1bdd49d32ebe63ddd89718eec3baa6f9d11264cf1d84e823df0ad16621a2b06f1671b003b0087fabb3b62df20c88372f8abc4f5ae7736b40f06bebcbd782e6e9a422fcee19613f7dade82f684ed49931f24f92bd9332c21ea5")}
          Z "4f7c7ee5d26329a05cedf90905ebef99b67ff25d26f2eb09cc9d59d596026e1dbd712a3641f7b3df673a4b2f2259e24d96b84fec95bc6574d04a321cffed89ef403694d7d1f5d55f6a185363ec77e96805efed25bdf133f3fcfa9fb455bd7b529a68bb1fdfad77390a51879916e4b57f419a0a1a5b378b24cb10220f8e38f565bfdfc50ec8fe36bc4bbcdcda72332ee0e1462fdcdbbc1612730e70d31356ad3f0957336c4a8e9c1ffe9a83b34fe9a3bbf317f8f9f2ae74189ef3d974d01c98d0bea6fc86653d19352d0a401f8fa260ec1433c9caa6d7686c8427dbb5024df6e9deadb7f57e1ee200388f654f48ff7a89f482f473c9e83a657f3910c9b7b783a8"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "b9e39b6a7e3e980435d2a72687dadaf7108b667ee4fc36fa4f71ea24ce80861779d03d8295734e5888c81e858b7326f2679b31f10feaa8a6b9d9be9b9a39d9b7d7b8770ada37eb359be8e54038f9df19ea1564054676cbd21282c9fc902603d68f469959132479e5b607d7d9aa67101ebe56701a8a03c604524bc9b649b168923d96494fd37bd9ce20b1bdfb1e9cbf402557fe324f9c1cd9af63df6fa8cbcc1dd2716ec3ee484232ecc4277d28a7d847482a165bed1793f61e9918ddb6ef7f93397dd310f5de2c9c4d58c2ce42b94992813067d577dc53386288b7ae4a7f3a3b9788f889e34c4af28c7902efaadbd5178f2edf6524cfebbd000a5713149d8233")}
          responder-keys {:static-private-key (core/hex-str->big-int "dc90adbc2186461c0c99df123df1572677122f55b165792e8a7df44c")
                          :static-public-key (core/hex-str->big-int "56c7556265ececa75a866fdea1dd7a52849ff8d98418f626d7e2431fd55b02712249124338ddd344e54d36e896c751a517b9eb8992e216fc9018a6824deaa32285dbd0900d786fe73dea8f0c04a5e8e7f2cb5114c51a05d11707787fef236506d708e5f02ee8983b8bba8d5ff1ccc3e1b35e3cde1357d0a222e68dc77b9c0593fb5eb8b4bf811646c69efff43af39cc772c6f930c6d5158fec512f6d16c508746eafe9db67d23248b9ae52950fbd248408751649e2f78cfb6dcf5ef7a2b5535ee75e8df0e08c2e1183000710b34fbb67d6a1223279399f9179c8a2f367ded7d54d26e4f4e19051f02a103191ccf51ce335a8507ca5b7a7a0d80a319ff4862833")
                          :ephemeral-private-key (core/hex-str->big-int "5a098be83a49ec5b5193951d2c945da90f1b9b84cf2631cc89919789")
                          :ephemeral-public-key (core/hex-str->big-int "67157ce60595cd7f8aceb7083d53abb8d9d749f0ed91329b7687d8e367e6aca02fbd693267879a68fffa4a7502f966fe3c9ee56c5a530fde887960f344e01514d0b75dc253c3cd484911b56339bf20b4d811fb75be858a94427c1073ac1e0ab3a3879c1bcc3dcc093626a32d594aa008a27a4568b9525725a84e05f85a598556742baeb1095ab0a26f1837d0bcfdd1f389b84340987a9ea83b4efb35d489a265a8dddb9f9446bb27707e056a031499df4b14e31dbd2072512c3ad16da22b1d288c803cb0957d3bb47a010d8e282ed2af2c0ce2a56c56292cf434973b08d5acb483c0cb9c1d7f83f3663c26d19ca900c8f738e2889a892ca2d7772b2773561436")}
          Z "b2ed3371d047fa18c68b3206774e470524bc17e67d813789fb6b7722b13c1edff70c4f1e927b31d93eafebcd08e2510f6e3699e4b0b4ddd1da3c73c6c18d8152b4b7e8645825ed1c0fa9fe2d8668b1162def7c6970770be04ef372a3c57175efb25a44729744c18b673f9395da57d319dcaa859dc9012d4fba1dbf281aff1cdcd8e9571f714ffbd0505fbe57fa4a167b7805a29ab5318a252315816d4281dfd48b8f1d7e3e61910fa67925744cd9eab908703b82114d11a15e6bf8b613158c5973caa96efdf3e0e601ec6ca02610d800ca92f7e4259711fa4619ebeb3bf76d491662addd791d1c82e59f87e869505de6b846b0a7b867c6888e59a2e7fce045ea"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "1fff0ee5fbe95106a17a74a7e6bcc4dd8ad2271eb80330615ee0b4a3dccbd6b2ebd1cc06bbaed3c66bac32c153bb7c452afe6dd2c18e956d870bfedc6cb7a62db5d8e20ae646a30e475c2ef0308bfd255b9b0c6276422d14ea558e5d1760faed48ccceeda065e4205ae7095c3ae68fde9ee1366ddd2347d523c132cac068c6c30249f0e19418dd2bdeb228bc025bb973a3f66dd155a004a540a679bbfd22cbeb46ea0bcfe33ff9eaba6e6373d2c40d1585bcb564d5ab86549799d37961847ffef5cc01a9dea73d1d675781247274eb98adbb2c5966e59147c5f721d1917fe2675e284dcaff6d618413ed185b1f864a7683cfa192083e095bfb9ef8cac1783fca")}
          responder-keys {:static-private-key (core/hex-str->big-int "df9caea3527f88f88684ba99c0f8261bcd51a43c4d57c4d7b21b545c")
                          :static-public-key (core/hex-str->big-int "2b615d7c775f92a36e378e5b83a453377e07f2b54b6d612214fae3d89dddeec8d3e977aff6126ffed0b0797b75139206b8565f4533cff9af29fe7fc8f35df3c5395140e0018225f549b329f7e4b5c3213ca1e4293e0dc6096d39ad15197a809f2698f0f9a9fb02d5d97b5401b14b34415718b9efa58eb804e7d731aab991fdd1aaed283480f235e7997dd3b827c19a914f3f0d16e55193dfdd203fb12e35cd281c5dda7851ff52b9c390c0e5d372640179e612e000c54e67e809ce5c04ba4c7d726787f338660df56b9fcdef29e7ee85a1f6be7309d3d60a9a44bec5a510dfe7ba3a9c81376397e9793ac27f259651e0953331e3cd12cceb213dccb8f8d0d123")
                          :ephemeral-private-key (core/hex-str->big-int "b6b3832a66ed0189e461d3e7c781dc4dabd5bd6f6b77958818ebbda2")
                          :ephemeral-public-key (core/hex-str->big-int "393287445b700689959646d1f96463bfe967268ea36a832e2df6eeaacf65458b06c1a368c8ad1198e75483822e2b8bf9103f01cccc98cf62b966ac4a10ccd16299198733fc6fbc37b37d496ada7ecdc6dc96f818923f76d5f8187df540a75257120870be3021f9b6e8dcd37f216a700e28dcb40bb79396cf03d40061f2f9946e601dfe2cf61398b5d6143bf3862d364d70a37f29df88dc7ddb90f8d3da91d96db3b8ff6a53bba8e4d6688d92a782eaf2125fb21d93173d734f15e864131698a828f21f7c56f54e820d372e563dffc921f335e82b978ab8ad8ca8a50fa3254ccfeff3877c18e3894089d47aeca9919f84c38b77b36509b281cf3b6613eff0409e")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "76b2647d58a674ff4fce17a38eea6c647b9be8c504da33f8ec11b27d190c7aea8b0760a0103f92d8ee1a70beb7963226072dc346a983dcad4f041012820587b7795ce77b2d8402f8833dc36f6c1e108946a9f7f8d8f14c7c93b948ff9f42dc461b24485dfafaf7da47433304a1a4a75f92dc8ff0eee285e39ea8e340350904ea154fe089c6e3c434f123d09b43e39bc390279442e3ad38444f5d320d65a5c769eee501e6b24afe841a4b35a94b5b87e21f0d78f23139a4f116f9c8178c0dca24dd404fd7373b198f26edd9d1c8798683be9968a9c7e8ccc939fba67b3754376dd3c75f9dc0bf3d703ef0f9be33a48be9073b6a93945e32760ee5c46eb6d7b8be")}
          responder-keys {:static-private-key (core/hex-str->big-int "a740be622c5d5c1f030a92b56778e4ad99850578395fac281ab650ce")
                          :static-public-key (core/hex-str->big-int "0a3c77cf29d88be179016130f6f1907e68f6fddaa6490a93123fc0108e15e8533edc0ece14db504d99d63cb965ef15eeaa6909bddbf3d3f5be7c7e2ac08be574f81a9c62a15460623627aa304266dc56321696b648a8b3f29b94fb4004ea7280ababe0e05ddba17b72c2a389186a7394abd14009ff4ce820d90fcd911e3fbcdebccdc217101edce60710ee1e3c94162803a766fef783850c1c79f27881e4fbfe106a75736d0f972234f29f6e9e6b3940970f76d84d393618ea4fb72ca4b17a36de3b699a145bed72b19bbf4eb41d22d6805ee11be304a3d82a92331961c715111bdc651e4af953d28b2ccbfe2302168651652f6aab450f78f2934de52bba79dd")
                          :ephemeral-private-key (core/hex-str->big-int "cc951ad09986370f25c2ac0aef53a41ef2bf7ea0af409faf4b50506c")
                          :ephemeral-public-key (core/hex-str->big-int "e4b6a8cb3217ac4ecd4a94fd4c98f49730fc29c1b9e4c684e7c4ae2119cd5badb4e67594999d196100d094582847798da534b7594c6da5a55c85d03bc4ef70f05ce44a2fd797ac17bafe69e14effd4485ebf585d2a0ad1fc3cffd691e5d75babeb20872a14e7e7df92fd1ef1b1c8e20f4bfd0f0ece801e58d8ce886a6d5d4dc831bd8695bec77321a3bb413f30b0335bd93cba1f2e9888ba931baa45cefe34725a7e2561d9cfb69bd9f49a0a9908e65a05113abc4b2eb1edabec5587ab885ba2bca1c28f2d0fa897a75caf893be6817574062bde5b8826086847e4a7c430820a4a188ab0aec6958ef3de25a59af469b930a521996417f9034b85715f7708e1d7")}
          Z "7df30482683efdda72020f77855c904818b21092f42fabb2c5cc215f823e6a020f26ea7790b83f4f3035be82121d04187d882777042734992596d1f3f9c5e630711c7ebbda63de54e382ee0e0754ad9331cc41308cca5397ade2bfb4190545f68a9291714ccae437cac4a81c4e0c0bd98f4ad514e4e80aac88c1392e79f051dfdd12aa587b84fec5418a2a609401cde82e98b86aee6cf1fa6d98502db1597cf34a08813e6ff34e417f7bc55aa4b39c84167b625ef654619b45d389c1810476d92a3d250eebb38e1cf22671d5159917b191ccedf7d487d6830a06230b9c752055d8f3a3bb4a3b42b2b6f76925bfc1a515213fac2e900c25bfe062f289743e6b3d"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "b3390bb568a5b96eb9bc06e2f5ee2a9b089c31db53405f6479380593dccfeb8ad43c951dfa42c7263ec9041463d4c976ce51d06bcd9c628db20aa13ea93c951e932ae653cc4485d018b27dd2c21d3476ce880d73bba4664ba12c173b6ca2bfdb445a152e9a596af4e5207817a45b403959d68a6df834ccf0144e1ef042a434f8028ebe7ad6069156b371618b90afefc37dd34013dbbc0d81f2ca55a8cfe9ed3f0b239e8d9ab15c2a95820f91f8d11096c0f3273147a0b3308d24ae2f37e6b5d660f4049a576396e7f72773e1e2e242b4ef885622524de78abfb6cc6a51a4acaad25ab7476584b091e2e8046248e9094a9cb877b9dfd29335e4161ee0fbf548c2")}
          responder-keys {:static-private-key (core/hex-str->big-int "8b010499761a9b92dd56127469f6d3300af471f6c63d2a00fd56e76d")
                          :static-public-key (core/hex-str->big-int "996019f53f64ee24f0d2528c2eb58e6b3caee5fd04723203880b6fbb2f5207f8be7718abc19b644a0e2b8c7033a899f6e90db96e850314ad72d8a539f5f0ca84038d3d9ce846eef4e2d13f9d9b5dabce756c89ce278e5c2efdbc3f5a7164f5b831d31a11f8425951d28891c77c8fa668e0507580664e4f0149d6d98878cc4a987a3c48bd531e2209c0978cadbe71a408946ed7f33636ca9a29c56801982bc6882d21bad4e6e00ab3cc5eb70bc7cfecbc5c06ea9de73569c59e6ba2fe2861ff6f4623e8d5725af10d1866ac3f23eeed837eec387ce35bc1d50c6d0b071d0b93a9209c82ea8050919ca5d12b7464e5e1b83957d5c06b527cbd19d431705d995029")
                          :ephemeral-private-key (core/hex-str->big-int "9b0dbbc423a956ec51e5bd346fc5dcb0f995e281bee5e3fb90b3390d")
                          :ephemeral-public-key (core/hex-str->big-int "9a6350909cd591dd3154116cd339c67abc6c284da90762472e8bb69d7c115fa1f3bf7d041294242782b3a3e73b31c89cd71ae1c43cdb32b4e471f82caae6775fe7df0ee33c8e2c09a9ce3dd477481ca0dc4b1130bbffd613f8cf08bdbef7ea286d0700276ae49aa9824a857e574c1578e267f4d231acf09016dd4ec3704a7d08504e92b7c17355a65a37f499c9ecf3ade79e559d155310ce67fb73fc69349ff4b6e83cd0a726c81540d8df0e14b28389e53868efd3b751abf006386535db1fd63aa6e92f817596dfd004739e6a30cd09a054149330f0ac61750f70df8102a491f2017bc0bbc418ba325ca948e5b9e4dbcd9f263f71a6be3c7ecf90d0e8a08c80")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "216b5fb219f82cb067bca81ccf759b57cc4eff7d54795e2a9f8ff857ce362241c67fd6db79c11a315d763c675f5c6bf7f8b603df71419a70304bebc9975b9a7619a20790cd9a980c4a3303f3874b1915ed057b6492cfcca61eea575e883f890dece180d9da3a9c893057fcaee8dce0588e7edc43bcc47334771eb18975515bf2f939b6614e53f7a50a58b77655848d80c6307fefef057ce75ad171812c4c2b60e72e0b6270bdc0f6cdf074bfb956d0448c509abbff56a2faedac80c8a74e8cb1eab1f7be4a2d76762ad3af9d725d88ff07c8b929d7991d902ec36db1875898e2cc885bbe37148932035ad789d919cf032c55c954e5f9af0716de226572c60364")}
          responder-keys {:static-private-key (core/hex-str->big-int "55d6b3f16c0c515407d19543186b92cf91c7eed3203f91e982d182f5")
                          :static-public-key (core/hex-str->big-int "91b27130e4ff80c0de3a2d9b2a7b3430129706bb474a629a5b0dc8d28864750bf00093b905c546d66d54e9f4e1f4e0d8e82712dd22c512500f681a91b73b35a775934a0a40d9828ead08e715d9096dbd4885b2916e7e067cdb4c68ec2ada9abbe110a51a7bdafbc4fb6f338cd19cd36c3de7555925d79334faff54e77b5195524101a3a514064602c767e4ca332b5e05e25bb048f22b8a40a8fc61d96ddbd13b6295bf9195f78b00ce424de170ddbf581943ada1f2f0ef51df66df8beb5e201a022078233fb0c4e5984fc731eb802263325e52753c08b367a8f2709638e5d49d3b073dac678b316686db10348d5584a9a91cb74a5204f0641feaa02aa81e62b1")
                          :ephemeral-private-key (core/hex-str->big-int "1e5ada862e70619fae53071321d85eab501a1c84920d94310ad80d7d")
                          :ephemeral-public-key (core/hex-str->big-int "90af7d9f0d46d90f43cb90e899aba7dcf5b4e55311b0f0ecc4204b97ac275c96618b9944a9df25e37037b4c55690e592430a42cf3614e3b70604523f3699ad67e21511bde3b572fe1bf933b3dd52a5c3c703f097f3a2adc47946395a452cebf2e669aec8a9672fd39dec6be3903286db88e37ab0069bfe1d124b42eafeb1f7a1aad0bda28bd33a02ef2758559ff7ddc605088c1e080b8375762418bbc52582a0ed39bc6a133f1a0bb30efa641a04b6c6f83c5cc474b345dcef930ac557344a6a6e4d2d97d97c029f3f7bd24cdaf55d687d56c35ec614eca7c2588e084a80b8ce19de13585a83a42b6f4b10ffab05c520f514bfafd52f37f508820b77003eda79")}
          Z "03cd312808f2f9538d3e24847b11de776a71712812b20cf4a5ada88cbffc18f41ea4d7a034c1508820831eb359b9938b2cec4f2404d48c5b81fb67a84e6bd6bf9091510e71f0a3f5469c912cf679a2954163df3d991e2a05ee102623a827f76627b4614541ab4836cc436ff2455a44f11416cdb5856e34f9cc9fa80470325270b7d788475ba6105e5cb0887129ae28cec635eb4f080f24b1f9026867117bcb75463a7efc3f0364226af472c5a0d792f7d17b6b6ab7b8e239c511f1e6b3f063f101a72f669e7e0f17c464e84048839f455ef1740f81c7e18a1786d4065d4e306be54641917499072849eed3aca79edc3cdb171dd79a41b855a0f33dd85b498494"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    ;; WTF???
    ;; > Result = F (4 - IUT's Static private key changed-prikey validity)
    ; (let [initiator-keys {:static-public-key (core/hex-str->big-int "a2cd7b7f9fd760c086ff7ec02c0c4235f3a396841b110958201d6e2082a4b6e7496225899cc9a0431efc32a9e2dc6261b8b205f88c784c7278a98c6eb9adc0a07882d4baaed8894020955e4e04ca6fdbe160fa8f9f176ceeb4bf5c3eee3319740ba0e5d8cfbb118708d885dfe4396d5c45090016cfe9d852adedbe770bd57bc1fe4a42efe2382f690e24d6361b9d4bf18a81a3fe47b0b2d1f2bb0eeaa9667066cd7e906bf077a486b09ad79203988b5690b5c1118d7451bd25bf4f8a0c8ce2438a47404f85c3dfc130c25dd7bb03ba8aa33287be20918f7f233106e9db45f743481479a1affdb914e2770c6181ac66ad0e63e2197cf2eca9634951a7e1110cbc")}
    ;       responder-keys {:static-private-key (core/hex-str->big-int "69cba25430bce4aea8218f57b32780dede2cdf39ec9013e8eb58f5be")
    ;                       :static-public-key (core/hex-str->big-int "04ed3698a3d3e675f0ea8e771c0c543184290b9362bb319ceb5d30dd643d9eda8ff5065c055ee4e76273b67d86a47a88301e783c6452b8d5df7842c2f806860797fbf0f9bd2ab73e3141ba055d15aadf64fbc947d49d2224240c23d15c4bd197013381c45dbe3b2bcc17ea9ed5934891da4c038e087d443b4a8626a71d76f402236fa1f2346ea13c4ccfe955f1ca54ad730a4870f814af71d68590a6865eb544597a16af3484da9bd70e9160272d36ffde4d71d98135721f14e02d4c93ef8e389a7b929706449efff54503ea2788025be7a1965ab5826b1206c3341d01f0fa5e015476dc0774267cf69fd80e362e1c2c0927e0e5f70c63ea262a8e227e9a1a86")
    ;                       :ephemeral-private-key (core/hex-str->big-int "1b72d77c829b8d8ef3c6e18afa49a36aa27c5f3f5a1b436e1ba123e8")
    ;                       :ephemeral-public-key (core/hex-str->big-int "9fde73c00b49e293ae60328e6daa9beebda6d3e270df3b2549d86542fbab121f1862fba061c58e5fe98c41bdd1d6a4cacfd8e1fbc78a4032517482e062021925e59c903f94ea0008f75974a88a6f812bf8941cc3e9ee7a3f542f34174c8087f32e6d7a3f3957c1787669b3e217560d7c261883b3e8d75e0b0ee1491d7a5fc18ba1ed8f70b7c72bbdb8c28fdf7975b441a29cb00c9af9c8237cb1c61afcd9133ad39096390294b855095d60b8fcc734f6607d6601980f95c0295112ef623c15f5000f61c836cf81d7158eda36137a89742d3c1f357eab1b9b1c64458c7b05e29255a1b7e4bc14e282b172c6e84f7437711f1d05fb61bde2cad850dd5c0e8da4e9")}
    ;       Z :bottom
    ;       result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
    ;   (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "5ee9bf6064f669cbd1d137ec9fdaa9f511b8dd14a656710e44e78cae20473dc5385790e83a253cd3cae2c2d1a26ebc18d395f98bba30cb6c97d08bf430673aaff02099d697dd02100b4cdf1fac26a7e474690f0f3d9813ec44e5f454b6d7985ab7f5a9313223b4671084b6303822080ee60374b3b1b71b123fcd47727e9ba1d09095103fb33a3e5a1bf71c8136d388622c6fd56f414bfb243c60df4806278aee0b31ed812681d8e840e38b84f1b87d0cf24a3dfd62fe62a8068f16d7d30eeeb913a7ad49ca6ce3dcebefa19d74cfade4e932b5c987db8367b4be5d280af34b12f74e39a7c0c38399d58c2ddb56268153a21a62ccb61e28d124dd0b626d1452b2")}
          responder-keys {:static-private-key (core/hex-str->big-int "7ffc631558bf18f09a29608c49cf7ae9094de64db73bd57d45d94743")
                          :static-public-key (core/hex-str->big-int "6ab58cd298f701571f4758847c39c3d531619b24ec9d825dcf686ae29b961113703ec53291241cf0cb3f130b93b8ac81d1dc5ac2d3c2c5ce732bbd323409753fe251c84478d1200d870e4651fea7b1bbb17308719395c378be00bbba5b091fe4f9a1a6cc58404d889e15422e0b808a8419782ba421c8bb1edcbb6c48f02a8dcb7e7c056bfcdb928676605616287f81baf4db1904bd9a1d26b444cd95dcf1acf4d98f74abe59b77126dce05206d1aa98dc628320d0cda67d1f88c7ecf0c76c347e97226a100dacd7951e89467feab1ecac3228ce55a51486c10e8d1c4f9fbf52e1748e6e1821ff63ace2bf54282a13e5dd069e0b2815f3ef66261a6d8b3b26d03")
                          :ephemeral-private-key (core/hex-str->big-int "d379692411b72c3fda54aba34285f1a4766419f089e9089de928087f")
                          :ephemeral-public-key (core/hex-str->big-int "006311b9fd7270756deafc2734721fc73d930e662a7bd13f73227fcf42d4abdbcc4af34236a4b13ef3aaa373e1280367bdc61b816955d360ed897bc8cc70c8af9ff424b977dc6d13f9aca1bb7ba7a2885a2ef75b3cc07922ef7c55159d8c88f0f1c7de4769fa025a86a6d15d9dab54d15934f21e295e145b1f7aaf0911949a2716decd753420a8f2358b91081ff86806f74daab7b602659feac88df6e85cabc0ebe77ca85584301cf10162c8a38510fa14e87fb115efd605edb9d0303562321148b367c6e340ab5b8511b29cbe564ebc1962557aeda185631f490f991b3ddb35d1a3f1720bc92361992d9f83fc1c78da6bd9140ea847526d900ebdeb3d1b7e6a")}
          Z "b63a99ee022ca82653393be3726100a90ca3a1cbb7c1f04a7946ce5b4f85ce9c8bcc4399f5ec1ed7f965d37286076d0283bbca6577f61b9aa669cee16ee0cb809cd858b9510677f090b6cd34835e0c8d145fc9723e8e021b02083bb31fd285df59bec421191c8eef8b998d38bd08d531f586cda6d68633f2772fd5c1a4d2d5899b25f9d03cdad48e0acfdac03542105512887c015ea31c252eba49d48e25d93236e79408d957c0aa4f4fcb499f930c05a63aea721bcbd4743f2f5615e9d1423f2e5d349e9363fcec95ce76864d8a63f53d44e1dfe2ca1dd3b36f6583e62c9b067b3fa55db0d9b9ff4d0fc2a6179b650b8565cf084194b9ab08691dedf51313a5"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "425ddbcd5d0f30275e84bf16e6a02235e5b9d4c8a6c9890e99349e867cb53deb74197e2c4a6ec0cffc6b6caf89ace3fe0d9ff52585545106f716a6cb95f57096f4d5beecc524642cd0ad94f637cbdbd1823c7c1bbe4f91859f50210f00bf233aad28542c2f85e230cf6760aa11492ff5be37f764d470d7bc05ed159ba4ff402f9d44decf5b074a8f888089a473209948c0d380201083df1f1963cbb37fee34f1a67dfbb2a512c4ff10597eaa6ded45994a261442ffee9e8b6bab94bedcedff37f55917e27b771d12a36257374beb43f180ae3eb3a7b1088c34a951cd8040baa7acf0d436cce7a9bf34fa03dd9ba94c8444d2ffd9236ecb31ce8c1eb41ed5e202")}
          responder-keys {:static-private-key (core/hex-str->big-int "64bc59face565f0d6137c9a468bf423c2e352b3659f30bde29c855b6")
                          :static-public-key (core/hex-str->big-int "66d6539a801f8d39e7d0246e2062da9d570201b1d87c3f5654304cfa6c12c64fea77efff97aa95c3591cc2853b1f2cc260a3c11afe1ccaf36a29cea42788d53bdcbc2bd06ab1e9241595a79785ba8eb5a3347d113872271fe0a187be3bbac7453a99d0efe29e2d73a50cf21e8fb2704d8966cfc088df7310515b8566454a55e20e7e53501ffb0f9fec409684cbe8ae56d98f096c65b2d9253a250c4b545755450c4bbc59b1cc78718f56c6c2b4571499398f43e0f29f65588a2b7ffd805b97ec24d606ae45c2f60905d198aa98b7c040d7d9d41a4e8c86c9e62085710e284bac85f703d4273b7f8a06e41fe3c78ad459c29c4bb37809139d1152c6df2c2d62b3")
                          :ephemeral-private-key (core/hex-str->big-int "c3f76752d2172d6a9894925ac828da0cd624a18f88f3b5460579b130")
                          :ephemeral-public-key (core/hex-str->big-int "5c2b2437e04fe1cff1a9c088203a0bd439bf4660c7dd752dfd1c0b2ea68411cc0034b54c25f6cfd3bfc4c245bb0dcc4a5214d4b52fbb2d9712e71de67580b7a7035efd06c8107e2a5fcf76f3e40d84ba5a12a8b69bf7e377688839b46cd12c441b335f8d4d364b6892ffba7eef1a8d819e7650b9c7b93fc022b9aa0a05c987ae0749a747279f6bde89a1770a9ed7deea84344f98622109eb387f76aa818fe85c801d41eb6d6507e572aae88c916daea21b2e7498c67562bf5b13090a707d3f36fe517ea61a9d78d10a6d8e118a1750ff6c1073a2cf3b05912320da377fcdce057f2589bb3a9a3d1f70010eb4ff4b8a3b0c18e393879cdfe6eed38767014ae33a")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "2ea96fff86378d87c849ee3e5b617ff5ae0a3f93502dcae3cd54c29476edbd249f834d82a240969132edc9de13ae7e652938551e9b440dbba7b9ebd63f129aeed92428d03ce1b9795263b0ea707e277e9d8e13119f1285672144f4e2fe686d5ae05b0aca06280c028b7ec95f968e8a9111eca848de837f4c1b2dac055f55de6684d225898181218a47d8d4c007c7eafba16b4cb2ec95847fc3512e61d27a49b55b95c13b6e1dad8ce73a9a069637d0e867a3a7d2a2b940cb7f777bd288ba5f0e31c1db2d2a799e11d4967e0811e663e530a145ff44b8b223e78e1de859b43ddc84505291554b394658ab73193a3e64a9145fe9f2929ebecb06cf6f7cf3beee65")}
          responder-keys {:static-private-key (core/hex-str->big-int "1cc9d2e065da72699fa36921e230826b6617c61826cc2528b98e6f35")
                          :static-public-key (core/hex-str->big-int "699b046a6867428c13322f5a45f199f7731f5dc78e04f732e4e8068e364e1c167499933742e5c924b171c67a52cc0a22748b4cf135fdc0e5d905a33a48e91a304e578d38bdd63ae8606f2ae6ec91adbe5ebbf47373e340392e4e10e65a8d1d1fd658e6106f7ef7f025929e653bda7024d93daaec5f4bac4f48355f64210d79588b1eb9b79d9d44d0556de47feb4d445a0f6865e02fcc2c1f4419679e0722020e9ca73d029fda464d111d3239c9d42fe395fc4f442851616560bb9edd8dd43c05a596ff1e1bb71409fe7a1319f549a6d435dc80d24527fa973f04c1a2baef05fbe5e39a839f99eb1a0c7c8b9e3bb69cedea63b35296e412b4af1dc55c2f6c3fdd")
                          :ephemeral-private-key (core/hex-str->big-int "dd27ba8c465f486d295accface9b19daf43d4b2650bc7029ec3cea31")
                          :ephemeral-public-key (core/hex-str->big-int "02dd8497af9db49697a2c2cedea2870e737f52b9ed43ab677574d907c3c22b03390dd0a7068b81a33367279c5cfbe8420eaa80e7ff69a80abdb78ad88276a28916d209ae39295c8c3e5f4e16ced0544567e9611b656cdeda09956a94e19465fa6740097625573ed4b05bb9071d705940f57b54447bdc6243ae784c1c88f24de2f3c2e488413da46570cd287ff505d3f165924293c9f407439fda9695a62c02264411a1c6aa5ea3d81905de1523c5096fd2ff62223afb20e7691ee6b1c64acf30b71894f3c7cc2a331dc382cce36931e5c88d3d70b47daac7dea5331aa10558f04063a6bcdaa383775bcdf5fd76e79024026894e63964e4823d59d69f82836a5d")}
          Z "a434895b90a07d5e7ebffb094a948ceae204d3189d4b6440f9f8bd95bfb5817f81cb3a8b7628818b0a8d4ec8c0b5d72071e0e15ea389772cba348b424ffcbb061dec0780a1d43c5a01f61ab0b2adc2cdedf4f0920afb654ac77ac046efd8453c356175eeec9c8f39b27fa188759e0c93c220b51ed09433fb5963ea7850d0747059fe12fcb4da58ba9b3a71a30f85789e9be02517a6dd65c95f015fc7186ffd421ff44d970ce120c0b290d9b42d485c1f8672ae8925a6a83a68aa16cc73ece8d9db1edab2a1b89b8bf768c7e2cba6bd5abd5a1b4b76ac782393a1a7d6d6155007ccf6cf953cd7734b3db198b530931a47cba31f8ddf1dbc54a4cebb8cad22f15c"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "532a398d73f14264146f49655597be6c349f826ec272cd16c18f688d82c1047f0d2d0ece277c1defcdf68e34fe677f7014866c37c9a5004532987ee86caf1df9fa55986c6aadcc61aea0ac7c3f2f0ff72c626066862f9ca5e2e31e0c5affbbd6c27d1b64f8a870136e4e4b45913a2dbd333c54f163d59ada502b057529ea2707a261520e7d7bd2d169d4c1af672556c711f92a98cd4c4c8e5f1f2adef944d907000ef71fe58aba400a6df13d1dc70bd8be3cec9887b7052f527bf8283ff92f03abf5667fd0e1eb7e875b86381013586f142cd6bddaaf5e309ae5172899aa53f82225772de708a3b993dba868ec25dbc0da48a11ac11dd11ca25424075c495690")}
          responder-keys {:static-private-key (core/hex-str->big-int "621674ae4a0355aa5d9ba279b3ce7e2b94ec881a1bd2eb4e6f3f72ff")
                          :static-public-key (core/hex-str->big-int "dfddd8afcebcdda7706d6dfd44839053a14ebf1f38779d8fe1eca059a0fcdc9c7a0129e94c76d1cbd9f210b3035431977734216da5959f09f849600702850933f068089f44226fecd7930c2eba253bb57e283ed52578f0a0fb2e1335a60be503fef899f9746b092603218402e2e154ca6c565f5850507c5b5de9f39620baa9cf38d67c39814f9dcc1c6404231fd4305396f07e819e68eabc16cafc96b5d00dd9aeba42a3c3425e39d74a5c61142b78354b9edbbc9cb3e80d1ee94da94f01384e8a296eec4948eae97461e07da2a119c90af39fa3123ead06972ce587d1bc5ad87836576bad1b1c9792c3acd0fa22ea1b341cedd58cab3164a5a8c49c223a8cf4")
                          :ephemeral-private-key (core/hex-str->big-int "c05a5976fa717ab8992fe510054ada07f34222b1dc44e75f714b6d1a")
                          :ephemeral-public-key (core/hex-str->big-int "715949026d56a5dbb0bc64289e68f2db243b5847bd265f9eded33660f764138b30f776a8c2311e7ceb4a9b09b049c842c7944bb154a293c1f3769975dce25c005b5a6b55be79a98376c4a1b04ecc71fafb033b1c0c45ae9ef4f5359f16448e81c7d8444d1f85ca3b577fba5fb3960784fd39bbdf48f1a10146eeaf36923d8f3e664c2f45aa0132c1915de8afb559a26a82255258de9051e96322103900b3df99e77d9490f3c37222ae8e58ab9d0e39ec72bc486879fbe10bea7502a9b803a68b88b61bb3adef9d5aec6e2519faba6807b7202c4c0f6b6597e234a8f41315773517ce6f0328830ba482b4450a300d182dac9f5a49d623885b9bc2f0d0c5bdf5c8")}
          Z "0e3723bd91f8d89c2fec41beba359880f9a3ce6258717c05bab287081a7608c90b46be958e615ff3d113215c21aa34bb21101dd6c7e5ef716188b42815b07ffc3b9e5923109bf0ad5b4e08b4a8af0b8fa0a28ee3b66378e41a27dc420d7a0851b5758520511444453eabc3ae37f485feb6ee478981eda00caa308fecf65af0d50fa3f9e9a2a1c967c6512cd585087cf874f29293b0d86f800bed6a54de286f56d9f0136509d31ba096493aa6e02ccd12a6b23ba05fa93e088a570bfbf068cff2deb6da54755d9766d0ed878857f1f73e212bf2f5c44bfa83eb07685c6ccc38b6a26ec2c189bcbad8e33c413dfae458e311b2f0dd71acf9883d3f5476335b56b3"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))))

(deftest ffcmqv1-nokc-zzonly-resp-2-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "95bd285d5a7e8322746b41fbe26844e97f9d99c64735e1900a161847474ca971ba0447d6e6d365f284150032f96dc56d4b36a9144750e3b71bf51e6ec915bd46d1909a27700abf15ee9eb2971e7da28c8df9db9fc3a024e82f393a18fca303e9ca51e4c3e5100b7daadaeb44ef5a938c429ccb613335626a3b21e9b6ebc02b74085f18f138bb149c16de86a3b7bbe8876244e4c048948948d0e89293fa921ad744c4d7bcb0c802dc20f213255cac26e31ecefbd141132cb84d7e6ddedf3ce6751f1d4ce26e7c47dcf063ff532db15b8724b5497cee9dc6c8bb7c074fe5ad2034a7e39bb3730351c16215679b8a1c7a40eb06703df174fbcc09c9901a6da8455d")
         :q (core/hex-str->big-int "dcde32eb07c4634cc0b6a487196979643ba3990951d881558c324615db53d81f")
         :g (core/hex-str->big-int "7c7b8026d410e8b39d620a822ac413285f325256a5704237b0aaad6da3e31109b50cd0f0fd949ced4d1c0fb3cafb274ed8cdbb33b5894fe9c9c810de3c227168354183f4a1cda6557d4406a7c65ed9d1b7df3a5236f7729fb56be855e17e7fe8f08513d0dbddb5adab82642702462b3cd95b79ef25d506264ec42e27137e61ba9df17cfa0a3cd03636a7ce1e448dc9708667e43b1a8f942a1a644d30839513f8781b90d3ffe1ab18bc4c46642bb5f39c5e65b9cc3a08d803a14956cfd13c9fa7dbf9342d5e7365704323ec87e3338c50eaf3fcab0e797b80267a4cc101e7acee6d42f3ab564faae02540f05efe8391cfc95edd366ee79d2975b5608276d6fa98")}]

    ;; WTF???
    ;; > Result = F (4 - IUT's Static private key changed-prikey validity)
    ; (let [initiator-keys {:static-public-key (core/hex-str->big-int "03312f8d4ffb98e6eb8f341616a55a617ad68e72f8aa51f3eb7882bbc024f6100fb764db21d9b0fcb7b50af64ebeb4a9cb99207f9d73a9b85932e1235cd2f19753714dc9a5632e0173e4e8992e21f53d5cadbe45247a0573ade7c67eadb1b476841f968275acd61cf92a268e0e1bcd2ad66249016b30a660ed2f4bda81cf9248f3895715d189e4f0047786d76bfdc8ef4eb6bd2b7fde70b533bcda0bd3c2c2979c410cd8a7d2550ba1e34e9eafba833c28e816418606f92a271fac5c4b1f5a02e1fed20b665bf401dcbea8cf4aa9ddeba157d3bb534f3f184f7763d3620c55dbcaa2c065e5b8866c215bbc411acae05ca1fbcdf872b794773a0cfb81049b553a")}
    ;       responder-keys {:static-private-key (core/hex-str->big-int "6bdc3166b64304f662ece40ade496403dd6b0ff53ec126c30aa8c3c3770a96f1")
    ;                       :static-public-key (core/hex-str->big-int "2095bcf16cb3aee3893ce833865fdc821f255a902b866e8c1c2bff97c145b4c45aaeb7d9c6aeedf68863b709c03caf0b1dc9be6c7db5f802f16bfe51ba8e29d9b51cbbf8aba30a10f8d6a76c277908e68695c87b219d7a911b6e95ee593656bd343bc245885ab6ce9ed83569e18cbee7dab64662d94fbca7085793b66ba92fbbf981ae55a7a959eaed037240520d16df5bdef084cbfe0fb7379623f7f7a665147df0b91d404ca843930ae4285221d92b9ff7c005143047c532ebdaad03503f6ca1d8d0e8f4672e30382d4df5fbec557aafdafae3e8f23a887bd1f6152a175457bee3fcde46660e96a2505bc3f5b189d4c9dff700b1bfa0f63493578bc37bfca3")
    ;                       :ephemeral-private-key (core/hex-str->big-int "66de50730f34cfbc2c69e7c13c143d0f444a03b51a1ffede9e594260d98f04f5")
    ;                       :ephemeral-public-key (core/hex-str->big-int "4355d180e7870e31185fc39efb3d887a483e8ccc29559bb2650f3e8049ffb6d61346351f9c3f58a0086c8370ff795ed9f0ffd49623c37629fc49c478bbff80771fa5dc08f1f0760556bafe29daab00c2c5aa421d18fe97cbc4ae0cc563486b04fbeaa0f04e10701dbb4e73fb0aeb3f1e1dd77492ff5c116d4e3ed41616ad3c394b15eec83569590ca1208fbfd073a8a3a22dd08d2143ba5391c3cc09e02126b17b48356dee612c68d2584a514074ab92984671371bb2e6329f79b14d64fee6896d6f506c6fa102291ee57b9cd4af3883416714caf2ecaf381fe34c717e085c8248a36d5451e3170376da732c94a0a406783d3b8477ef59459a16c6633e68c545")}
    ;       Z :bottom
    ;       result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
    ;   (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "4cc8fae8cd092613f7ce087e08c04f53bcb15ff3a992a16f3d333a0b2a23a40ed9083364a4e9c78a06411905a75bc8de2b63eee1334b1553837400c2d9a4be87f0733defcd1ddafc1832167ec495cb6a611b6aa2ea6f0b71d287edab2cd89d5c67a20280c1012ec2fc41ec0cc19e7e73151b84a0b58114a8d8112de52bbbf25aaf1e8135457bed0c72eab2f84e36dbd622f38f534f9dfc381281a7a012d5a8f7a5c36caa4120ddc0aab52b1e1a974aa4eef5c9592a68b0e3957a64f65f25cc55c50e370ae10cb006588034d71b0462597cd9c8754a82d866bf073eaf150fc0f64c245659941e1bf9db65273c17124611275468b563a72b20c9626ba71add58db")}
          responder-keys {:static-private-key (core/hex-str->big-int "4c1b211da94c3485a605cfae7d664312c19faf2281fad64206cc6125d387b2aa")
                          :static-public-key (core/hex-str->big-int "6d19b7f9c02394d8002e0fa8ba73c13344d5f0cc76924fc5a979e5fc45e7bf50d04ce669d5fc28b4ad5ccab20ba3860c36e5759d6104ddd316fdddcf6565d8bd395d38669ef2bdf4b9deafac4957dea085fec78105c917494f79e941234ee6b600dcb0a15a32f2f3d878ee79908ebf736924fe83f68add06eec184ff214a517ad03f70661619b2232d4d0b82dbb079bed70be2ad803fc53d5c40983a338c0a732b925fd0f431f41c907da1e7f3f6dca2c608b5c69b7eb064a961dae5cb8bc260f8f207f3d68df6a236dc76eab9e86ecabc627581910f047a5d55da00889f153086f5f125e8a2d7b194b1a2b5e448085c8459690895d0ddbbb84430c06a6f3c7b")
                          :ephemeral-private-key (core/hex-str->big-int "a900c7d8a2e3797413373b1941ea2a3d07d6a7d342cb4b3dc968cf326d0d230e")
                          :ephemeral-public-key (core/hex-str->big-int "25557d4cdd62644157b90427a4dfd9b8f1e4e9e3a7a795a90820c3383152fe620b442ea0b98231460f86fbf01fbfd996e1f9b419abf63071ea233351b775d01c6c7ae440d35f8fbe1fdfa0db100f65b36d6dcb23377be9c14359bf6c3208b0bc0f0707bb4f8d2adc1fc920d84c727403987a825eb60ba013ff532137da19f7933c22b99d98f027f0a116d722049fc883779617d5fe0c93535e9f6c80497672bdcbb4517880bcbc47cd1591c1cc32c5b02e5de128ad3966f0458c0a05f5d31259b3b3d421fcb4b97281cc63d0eb94827e21888259e001a40ed152627b72896b9fc005c41e73856533f5548d2cd91c28d38adfcf3303bdf959cb1425c719787b4c")}
          Z "793cf427b3d835e5f8f5067755bfcea41bf5431c53058d9e8f25a853a21d5763bd28e1a084a5d7403f1b262a4e031d13b61fc14a3bacf94d7db4a07b14e2e30ac04c60a3e34c75abb73bf30d1ed3ccf2291de028605ad2406ebd31ecf9a28dece3763cde7fe2067c430e937e09f5b493db01437d887628a33764919435249b8f00bf5f1e634851096ec89a53ae3e817d22b75834ef2e4fd397e89a21e48699a76c61668b21631835cccbf1c957535b3e0854d60ea4965438f0958f3b4591a6b7e4306606d6ea2f6b7e643025b3d6411aa851fe5baf96cf54e1beaa6e483734f7635387831e0dab7eb87a0903ea5023e1390b5f825bdb577aa5d995c915ae89c5"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "28237b93c0feeaa44afc4ef2300b7e0d2911accc6f15a6014f1cd808fdc8aa5a00013de4929632723541ce4ddb311ec52b043d856042e97d5ecc9a52fc5aa2f4ce316c9a932578d62d2e5831ae16f830e627146cad6e111d495d71d2d44e57707c498fddcb83979cf911bfea015421af77c79ed94a95e4f16dfb79e0caf12b0b6491dd4b458e8becbcb4a7c785edecd2fe5d5855e83204962a807ee56172eafab2ec54eb4a3e53d5497d85a53502e9199d4df36d267bff79c5220b72105344b9fe6e8a5e9e06438989167304009b717811d6c415e64e9f498ab8c078926d7c9aa8fdc4bec548828f7f27b6360a65270575bea64b9f93faa352d67b1fd3aca4df")}
          responder-keys {:static-private-key (core/hex-str->big-int "12d7f447cb5a5fdcf9f43545abec5accd5fe5ec11de456fac7c957a12eb4e7f6")
                          :static-public-key (core/hex-str->big-int "28d08e06b0286d80d065a20e1bc771926ed84f869b154f4a71be02ebb68c2b0621fceebe963dfd560ef1c2c5f13810bd36bfd90bc0209da0e10d3f518454bc8de902179c55108988c9f758aa88075010c4ead4cb1bb77bf4e095be5d80382816d5e678901583c8035664cd12f520624efdc0a7289f690bc68378ac72eb5f32993f2916f577ec50c4e3aeaff4662169850c069632b04d007a2fcca2530c080068b0f79ae4fe59e1430675ec69032e1c721500969933abc433bf31e4a2818598184e60b74836ab7f536f85910ac8c6c5aa0d1058dd5f8de23d5befdcd3f5e2be8ebddf86e268baa6cf2daac66c0a8823ce6e62b5ce62b43ede8c7987e6297c00ee")
                          :ephemeral-private-key (core/hex-str->big-int "55cae5577afbdab3619fd10a0d22ce44188f11d80cfdd487656d3fea1d3a38d8")
                          :ephemeral-public-key (core/hex-str->big-int "5e83bc754fc8656fdced1a2099548f7f65b865ad1980642c61811573dbed8d28c01e17a91c8ec3832bd7ac4643531cc1b19b6a90a76c14b81967107090cfe324f4c1bc65c211aae53a3fca162d71222e6649d406459edbe37a97758b28ffb4aa83343cf2d34c001c6abad74959bf142055818555cb1476d9d966a74519ea805b973f72c0ceb023fbf628f744961709f949909daefb58be11f0d4f0a4d0b300eb628e29f6e6f27b6518261fb109112460fb06bc61233a75a6424d79cbce8c406c52d63a6d20743aac610850766af73917b027090a22d8bc4697f60ae78309a6226d8d0ec94582c2d1f5976618a2a74861cab6aec280d2cba1c134f4e637b7f484")}
          Z "598900346b3ba4ecb69d0cf13f636b6807c4310871669cf4b41fcd8f90424e2853d451bbf29f2189abd91d9f29a5d807ce3b113ecab180770a7f536bcdfa13d6845ed0d414a3996300fe64cfe4625a310f51f2d30bec5f8a6423942207bf12126ab1cd055776b810f973a12e940a9fe8f9ffb5d224f00ebeb735e4daad9a65add69f7e60220d9f81242105a278717f58b9bb12baa777becef6251dde86b17ff32731cbc771d4657621f0ef53d6b622b2529e3a947194010587a06cde13744adc4eed34e43075ea018dc92bd95c0d0a78e38db22fb0e870fd152a27db8ff24e3580229f3a3f244b8159ab000ade9fa44394fc73d100c5b455f97c5e493e2d70a4"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "83b4c61daceb7946d763f5da320e58ecb8fb7bd99020117be2f5f957ab72878293b35ffeda2eb3543ef4d1fdb712695dc036cdce1cce56fa48c1e1f2c53bb9d7c5aa80df2b6c68a601e9b3e2d57c4eff7b9ab07b6a1fd1bba2a2f9621409b2b3884cba8890aa73681f618cfddf9329dc0ae36ae219ecb85f8dfe1124195534c6764b51a46dd8fd75db43d13340d150303f43dd93bcd406873294a0c20730f30d5db14e5e4e985d2ecedd87a9f4f1f682e24f59db2064f3f1e5f28ff198b36f03fc06c5b766a56f568e967aaefea01805dcc36d3050995f063f5b9366693d5be13f64d4133e58a716d42be5e49fc871b6a8bf724507d892e93e783673018fb33e")}
          responder-keys {:static-private-key (core/hex-str->big-int "0f590e7db83742942b93393baf84a599df044b42462598d50647a173cc7263f4")
                          :static-public-key (core/hex-str->big-int "64923fec3bcf6d96e05b7e2b33a003f7b3da5dbca0f67c76fd084f3a8b1125a1ac84a865407076ed03f9e44e61194cfd2ad69bc54ff43c43f359d6e1607fa3e852596b22724998449c1eb33bd3dcffa64a837c69a6389272cdf694628f4f0cd016e5bddf027fc729b9e760460508459f7488d8071f5637b1734acedfb4b76ba3355b7dd0c6400d0b04b2ee2f2b4cfe92d42398bc37e0e2a9307174502b3ecfd4454b4c72eb17c36b0f706e01bdaaa24a9686b1b2f833d5f3a45b7191263e3666674a712ffbb62ce83685c6a0e283105123de4a0250af9e2be43d3ca984bae4e258593719c310df714ee166dd44176bf580ac3e699c005b8e113995b20bf16f0e")
                          :ephemeral-private-key (core/hex-str->big-int "65a057195224e9eb550fb50345c602e1d3757aa10d0f6c41689a8ef8499cf0b7")
                          :ephemeral-public-key (core/hex-str->big-int "30dc07fbcf10df7c38260b72cdc6bcf025d7c7e8821b517de3ef8e51f6a6362e0e4c9f85f3bc5b687ee84c1337e7e3ca70adf14b28fb2ee28138a12e5702f4b62e2bb6d96886eb2ff760ddc658a5ec744fc7e62fc2c08de89ad5f2a57ac327eb1b421aad0c008a78d6c337136395bdb25fd002c59bec166a3148a748dad47bee0c5ded9c769a07e488eeb41c8b326378b4a681ed38c612e95b7e4929273ddc51503e447fba68091f047a28015785841476a36fb7c08049dcde35cfef6562ee30fb748a86d2f73add9a9bcbef3d8bbdc5839a8a1ae25b8a0d6a7a17a0779020b7385c3dfc949a8cc0e7bbda8cd6f8804e0f438e6682ddfcabada653706b994ae4")}
          Z "7671a3604e60e9ed897fec7e21bf38f4c4bfe3b0fb0d9829546ccbc1724d786fb9dd0084c5cf58d503785c2c539455460d05b8ace0c712fc40fc02dfa8fef518a8db1885f2e9e195d9c0139801611666551e60b5ce04369647e56c7ea32901f12d9612c14a5509256890e0e1d5413d73d0240d4cad7e4dd09d21d413cf5d4182902da3f112f188976eee7ac213390ac514d3bd8dcca5cc383aaeb8cd4433e52218fad81026370329fec2cb3cee233ac76a58f61684412ece9c77875a30a281b38d1fdf0fab5b444531d4525385be04f14380327a0556c5ee984aa64f590ed66503d86b95c826a9c3c9c09a005fe2bb6596575e44d69981fb7dccc2865b2da12a"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "1c8ead5c9abaecc4c5b88b54476ccac53bb38fe36ff6765ded00ac4e1c5e3c3cb01cb409b4ba1ac747a47072a493ac8b78405fe8838249c8f59681d6a59156b392c2152dbcb54ce01f6fe5ba68f19ab49d8537fc0b30ad4a7c37d05840a3698ec1d477da17174d9b8a60761a2767e68fb636729a694d7737130c3d45943f9cea6501a540d0ef7d296470f483cec6a516feb873af4a86a7c5bf02e1f17dcd39bdfd583b03a8700d3644a6e66297a49ed8ba68e34c100cc22091119a29cf6e523232db85b9363ff9f640a06d94e8a45aeff8730bdfdc6c967fa0346af25c8ee012ed109657907c23eb81bb0d1f155c8e6f27d740eeb2422fc16b4a498731802302")}
          responder-keys {:static-private-key (core/hex-str->big-int "cf188a314909365988e44ae48453d098a2d70ac913196049f1b646a461cc9f47")
                          :static-public-key (core/hex-str->big-int "599ffcbdf2524ce3ae127b8af4587dad15ac31de29bcbcdafd8eee95557ccc633df737e24a59860117479dca769f807462258f314b63e840a3413cbe8a10ecb1b1621bbef5dfc8bda48d108c035cc3dafed68084a3ce5be7c10e74e87e6534c5d0f67686e6617f3614cb688d3866f98b7aab2c0a7858bbea69a57f20079f79832416447d9373933a4849646b26016e4a14e9604009512b03c8daa5afb8718c9c7d05516739e34e47e34e4234027ab6b897fee08af6e45bf0a68e103ac7051d5ef025e8db1ee5985c2ce23535f6942ca8370a4e729b0719f9b215ddddce14b3bb3ddaa23928f115498aaf2a89596a80ab47b104a69f9d4163fbd9c6b9c5ab1af8")
                          :ephemeral-private-key (core/hex-str->big-int "ad270c52cc127b6c5af68cdf228cd22d62cc39c5e0a04918cf8365bbfad42fbd")
                          :ephemeral-public-key (core/hex-str->big-int "26de85f8d8e70ce29c1f6fbec48a3e4d1f90aa7de295a4902b36c62737d46da07f3029be5459c523e5af3ad2e14f6983715902979ba6015a4234ed89d962834e57aa20c81a862b718367ba295a7f09f503bd8e2867ec9b20417e4e6e13dec9f2885e39b58eb22d7576322ca16c5aee0db81ce0aa3a7a8a390e083eae3ec44c2855e174c5a3321034b2993e51990301049c4b679c6952881466b9a0d9aa1aec7a000e8044f5ed1acd7c196221dfb069ede89e1f187bdfd7e0a6b64e48b4cc202bd5a637f4efd57c59bb32cbe0ed6ff537a0c9c7842e342bee8c2f9babfabe63df0745fe5cec2098d323bd815eb70cac3aa0ec780d91c454d8db72da3aa1eb3de3")}
          Z "740fff1f77d17056690a873a85738df5644018cb4da3eeebbffc29ee4e1959e52a16491ae1f3417148da90cc23d78a2c5dc8b95415eaa22540a76b8d31fd4871247577c9c6d7fe493281a5834db7a070e6c606bdc77aba9f0c12a22e08987506d27576e3565efbe1578346e0d26d3f11303335d91a669817b2a86eb01088f400054020301a4d0e30dcb972af75a4c6bff76d8450ee1bbca5b3a232517ed7ddea22549b2a22be6d6b3587ddb889a011987da63edf0ce0798fdf8a3605bab22c095761f9ad400e3894b71a8fa8facdcd1fafed06d37e654a9e3bfbc7d2a824a6855112900aefe71e480334be29d164c6a382e0f7bd7ceb8a19b120c64c6f6c0b7b"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "5053bc83d8338742a436034af25b7ee2f2199957880a839133e3a6b12ea8de8f4bddf620efa05946b902ad4ff4b837d473e642778a2d3a9cb56da9c201bb86bf605ff414706d7370f0c4747b1054d7438c80bab9d7b99a52f1d29be3f48f193289141936cf4c1767686ae0aed76f03c7b48428b5e8ffcf6f6a7434b163b1deb9e4c61bd15020a440fe50a165dbdbefc81d999f8818191ddc136e3f00ff79aa81bfc41e25bf5c2325bbeea2874150103e4eee05acbfaa6dcd6db153188e5ddac2d7314e296001e4913464fc45b9031aab9d9e4809fd0c92050fc818daf96351c09e8e39db0a37145b0ca88ac7be8f003f3c92b9d21bdf64cfcbef767ea576e6cc")}
          responder-keys {:static-private-key (core/hex-str->big-int "053fbaa4b6cc316569d591c583be42c4dd43f239f275cca0bd18e96fc980319c")
                          :static-public-key (core/hex-str->big-int "348ad04c6531a7b397b6a781fba9536e2020b9c20d64d79657e6a36c045102b1edee844333c496b1651d27b1e4e5f30709ec90dfe0fba1720fce49c80e91494456c3d76eb0d69bc5ef88e30b16ac6c022c15aefffe1e4d53ab84e9d17e4f0d20a3cdf9d8bf29b436bd46bd36cb09e7d379f4b0edb607b27ce0245d01111c585f82e18e99211a8a0259da41df27e0ec98a50ecf970f12d70346360e54d58f3e78aea78b878839dd5f5489182b6c193cfb52c1f3f60f7141fd7ce830ad8b2bc7210102b769151ec3e04ffa1226281295b9b3251093751955af2ba7c23ca9f983479be8714edef264fb32f35b704422b0ba7c0f3ecf7679953588281223de2f443e")
                          :ephemeral-private-key (core/hex-str->big-int "bafc2c77d6572019556379fd79376a1f8fd0919a933bcf86bf4fc92f60e6f3cb")
                          :ephemeral-public-key (core/hex-str->big-int "908a13a933c695cb5dfd113e1ee0643ffe6cea6af797a70f1a5be7976146a4e6a99e3ba457a03226019bb7dff5550068b21c87bf2e51a92e1a25346bf56d807375fedfbb077cd063d38d8298302609ac10792af870423315f4b9065537fcf29b7a53f5337c4c62e8a28f472cfcd711b7e59174d37406fb21ad5c468fdbfbfdc80af7213d5ae6f04135639b23d1cc11426bf69076add2198775c86ecc7341f309f0bcc4dd43862f98a66c3589d5ada00ba99055e92ac102b336d368ae4e4c9e1e97fe966b71ab94d1ce2b4f76c77e721a99c69ddf8e7cc656136aff2d7d5e62f2e01aaa550919e0ac9a49903bc362681ac126956d5a5e89ad886aadce6a050769")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "3bd7e2f8dcecf352182cbd1c1e361589aff1e9e791858b5e7170f4b91a8902597b0ae0e24dcc98bf0375c7ebb0f577134e1fc2eb3ccc3ce473e66256b083e016de56db7f916468981bac2c824993880ec2ff6d92053b242b9bb5169ea84b431d719417f4977f372507b8866f780d0c35312a50aedbe9d64631f44a4932f4dd98b9cc7e5985162ccd3c3b9249baef15aec812dfae1ea573b5c92dd3194bbb39e2bf9d15087cf6f8d107b3c2e24ed35a949c12a72aa6e0fd98ae82013a0b6703cb5f11dd54ac61b62fb84fa176f3a0fcf045a28167e259236c5ba9eb15c907736c0977c002985ebd0b5cbf229566395148aa86964c6d76eefdc3c96642336726af")}
          responder-keys {:static-private-key (core/hex-str->big-int "195955ec7af6178a8be145771bd3504ded7c8f61858d29067db67ab1fdea638b")
                          :static-public-key (core/hex-str->big-int "63e7cfbeb09b237636c01648bec8f7e2abde529d35b8e35a454633aae1c012b66b5418cdf2c245ec1dcf8335131b857db6b334c8e3591320e9535090bc695bfbcb35f1450316575039832cf991cfabc28dc313b93f9a779801a30fa0d67597a3532ef15dccf63e152beac9bced9c6f9c8e0303d34847d53178e1c7f7877bc80f1bde13a2d4a2219aa041bc099f2729a5a16b189800bfe9eb1c7c5d907b984d6fbe23b4b064d82387f7b2ff074b74bef4efec3ca538d9de61df2b211a34c5eb0b35cf1b27001f09a38bb1615f8413ebdcf61a9cc14d919754c4bc07f4581b9ec33abd2805e2e229506d2acc0a58d0f1266f67ac5a42dafa5ec1c303c84eb4254d")
                          :ephemeral-private-key (core/hex-str->big-int "c25740c7c10484d8e340fe2b21c6d31c217f35e982b5977d5c946e38a2654bae")
                          :ephemeral-public-key (core/hex-str->big-int "20648307a6622bd6bb61718d7ee1b4ebefbc5aeac6bade827f81be2d56912f4bade8ab8fabacf3ac5288c86fee1174f1605a73f474b0f8b75c735dcf610a8b7c51edd6e22eb140b7f9f8b055986c773ae791ff1fb65764c96671a9476f03a9d3289a3e0d64eb6155e7830fa18fd748771feaff917b344fc2d1c3a8e0687aa432945863e797613581fef434a5d02a0e0524b5489bb3c05f0df78a2f3bca2234b232f28b6c519c5ba527a224735706826233e8c5c05332d0fe9f7e22474cc23ffd5d2392bac9027a5c2dae28974fbeb42fc5ef19a5db8c32f5b0087bbd0fcf65ae7f54d9bb213e31fabdf49cfcaf62d7cdcdfb3b72f82f9d0b33f0fe6a49a46383")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "0820dd358fb5a18cb90c91c2e7ecf5e0827c1a430e049eba866e71f45f2b9c0a3dea0540a99748bd7abc5d5048e0077ab5bbdd90900e192238f51a6d4e24c4764b898f2a9c1593454b9647d52b219819e69a4bc6079dd1bb0e557e27d45ff32dad411cf90e990039bf88e55d7492fa2c2f261d1123c6194eaaca5628fac483d888977b71bd0744cd36ce439ac12dcd6ce2368091a7279671cd7bdcd4ff43b9085c654cdf3fd84ca95ed5986f7b7cfdc8faebbb1e5abb0092d5fbd3f03b3c6009bb5d6d7a75d0a76e6efbe5d82c836fa0eb0c515e954d0cddb06bf209e6378eb014bd2bffe496da593672e34f55377d82440ec2247671515f8dd18cb03905ca1b")}
          responder-keys {:static-private-key (core/hex-str->big-int "caea25a7a4b1cb2ad43ebdd99b12f6f791cf07426f53ac53396d1a3befb5f22b")
                          :static-public-key (core/hex-str->big-int "6b877fb6a432fa6b25eb32e362c824a439870040e91284844d3713b5116f5c583d11711b5567e1cba9fe05f185168b1b7eaf617737c198ecb07c90ba3b6d8e9dfe7e0597a9d9761d2a7410c27bc71dbd84f0551f362a88f22ac5104ee4aa69001fe5313a7447dfc4e5739fb41eab609a1aef42949ebb063671ebabb94c35e2ec6123dd780a32030e7833b82a55e712b9d9c878d0b79426e2becc2583932eca518afdacdf231c29a913b0b9a8157328351c2168c4044d1064b0bd43b0da70cf488b1917e54576e686722fa7d5f62d231e55e47f8f56c6f23894deb64ea9ea112221b87e18cbdd4db247964414bcf94e650a0914548cb5a6055a5f052dde1a57f7")
                          :ephemeral-private-key (core/hex-str->big-int "b6f4601f2182f220e861d463ad3b45ef41603affefdfd5fbc3ac5f9b47e72ee2")
                          :ephemeral-public-key (core/hex-str->big-int "16719f1a498bbfb91839561836418bfe94f6d776385202fad499184b9a727ce84f459e14c8bcc983b480c1ef8e934c8c1bf5e299c8df5f118089a77acec3a4b1e552d7c89c431f7e3d1b760eb624f84330db9287a589dd294c57f000a010b82c666cd2672076bae657a32997e1ec0cf9844da8180791be5c24aafdf09ea56ebadfab009a0f0d86cbf1c66749bd848e68f8d6d0657aafe28b3106667f982c51b7d761d93741a6834e5d598e700de4bfc6dd5f59b799bcc19d3e2a5ef8c093261aa9e4c15e2c31a96330f5493f8fe3d174ad97d9de8f61f5be3a1ac1b0874f1be4711303599bea744486b7ecd3ceaa87e014b8fedc448ed1638ccb94c34820be23")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "4047ada6042be5dfba251a5f4b1c8689c95c877f3a7531b44d099fdfff89079427b2d5958cca7833f731e94dc88d5ff3d1b4d210c7a4a679695ebb8138c73b7542b03b6bd461b2105b040da9824c83abafdd85e881750245b5ba9b9bf9029e7a1374d0de0c21fdc92f260befb31f9b053cd97a32d2eba6aacfbc10129642d25d55c53ce1090b65004a143128caf658bfc7d1d11eb4d99e0ef195d64f16a21059ea19bfa304f83229067ce802976f96653ec478090b99c12a0693067f423e15a9251af836c3561781b3b93e98f70aa29b08cbe1e96efc494f84eebbd8c9b15efc96167a3700a7c4c4d8a46b20a05e845b4ce7c7f877b93934939e32516d0de649")}
          responder-keys {:static-private-key (core/hex-str->big-int "8933bd74710a227590e69c8c36de30cbec0e2ba1c400ee66146745aeb15b2b0e")
                          :static-public-key (core/hex-str->big-int "7507e683474cca5a23af1a9e953e3760035468dcce945fbb8130a197941cfd31e8304bf64cbf6a6bb729494a009a6dab69cd32d138f1db75298baa72623c74a59ab3f0e9b1b9fcb458bf6d77368ab33221a8bdf65cfa2e781ae5f242d7318c2cf1b285b15299264bdeec2dbc340c3631b6cb1e1e318b2ea569d650adf9cf2a12094082a56370b16e38e508058a80505f86d57d53ed13b8158c7812238efc1e3aed8c7a4892778f4f4542cee90bfe802f3721ca8ac332c8d6421b98f5bd76b730988d63d8d49ec3853edbedc6caee8576410b7522d0c4c232470dc39d7729b6739e03f412fb386204f21e980ee1e788123efae1fdbc69bcf9f4017e996e66e5e0")
                          :ephemeral-private-key (core/hex-str->big-int "d2f430a7b79bce18c700db08a78a10eb059c20611c49f29c8d9f1973db48d657")
                          :ephemeral-public-key (core/hex-str->big-int "257594a2b2b1d27ca8ba8f5f1d275af1b80cc3ea3913546136bd91abca2e49ffe1dc8d67fda3cefabc4773df3f489f28d2d566bbb5cce5b542a79ec8f19a864a90c047cfce47c6520f8169eff402b177def7fbedffe675c9524c8d077c955542ff89a9a5064d0315fe46882e2d24306bb4201b8b0e5b3b7ac56979871a54940905c794e56df37a2ca6fe595f6e4c5e019a628cca161a11ccac3d92667f1517a9e5c9180a0dc270dc87d8751df9ab8aa44a89b8dc21c46c1a160cc3bb2e76e630f225d62c7e2e1a9f739f638118dbc170c257b23bf92fc528b49ac52cc01e0f8a3d0e0afaf81f1edc193d49b3ace587171e9b03ad06cbe9ce5dfbca9033c3bd10")}
          Z "90b86854022c4227a5d3084c47c75b2eae100805d02f07e733459f171901115cf5d79431cfc1d8a680fb599548b64b816e59d0af92ca97ac8a8c3f2070975a41f95632bcbc0ce529a8ab72a3b008ea11941d738948f5255d17a1820e253a0f8d95a6c8c458a75ae33c97b2600dc95019dc90feb99f4beda668c97638d6c1d5b369dff788e75b882f985a168fe029695233e14cae36d6bf56f6ba5fab474aba5651761d20348329ff174fba4097a22810ec74f5097a49000adf3bec6bdb8a7afc08448b96069951cb6fd48bac794731a730c7a0469e41ba70735c834c32e68a2fcdf8742af7b724aa6c84ff2cec196524f2e0802991dc810430ad5c11c47ba8cb"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "7e28f619bf7f719d58ad53ae0b40cc0ee798b47fde1bef917c9142cf0fb6578ae23e5aa1dcb6f6b47055a9ad3690bef238e15246fe88279c9da84ec441847e7ecf489cbce97aff059debb39e91cd34893b46c8bbb43f2215d2d0a6f6109c32357b0b6a0b5664dccb553c91e532689655bd8b67cef037dbc87b855091d9d4cef66e57435e93138a5fe226a3f2a74c2c807d3518eab6687003245fbc3a3fa75e9ca6eb508c6b18478899210e4d3f1018f7208908beca259773e810e91e2480a66c277b93b5f686163d2b73d059fb1cfd8b10b9e6fc2a01a5afbd9f4a559fe957b70c51a0f04ed94e00997b65730fc44c460b813337166a8ec58a3be9014d8c7242")}
          responder-keys {:static-private-key (core/hex-str->big-int "935c888dcc08e1e5c5b62f559af75e1b243135b08b74f00986108a08f5bf590f")
                          :static-public-key (core/hex-str->big-int "0ac64ca2b4ec8cb14424372d442512b624860136ef8196b72cb2334bba070ca5b22142693640ff05c172764c8ffea3286951e446b8ad86b586a19a037be8125024f562b2a1c34ab406557e4f1c655e1133119c294fc6ddb3acdd02411f83f53597cbf3630e096f58f2730006f9ac3c107f428ced208a8635a1478de44d68ed6cb056b12b1cbc74f1c25c092881c33d098c6ea6613a49bdcc0e7cb31e9262fd2976eab4e50e7bafc10ecedeb73e7a70d6ca1d57c1e2588331f3ed1d4fbb07834a5d480db6fd553b425f60d53be1c344170aaf4d91f99ca2f2e65677cb306ecafec509a5ca07e1ae34c60e338e7ec338f8d74e7a0eebd06e1656e83b7dc66e19d0")
                          :ephemeral-private-key (core/hex-str->big-int "db84e5ce8f0aa2e93d4cdcd0bf24a0d35f3cd74208d2b2d5563462109f7a8134")
                          :ephemeral-public-key (core/hex-str->big-int "307e7b80d78c14fbf10b4d3a81985c36d67fa268dc410b4e95202fefa57a832ea2a9c13fa1acc5cd30750f02ac3fa25cc32119ef232b7bb36b566701c5bf4e6d5a1d22be723a2337943680c296a05e7ae10b27e002ab4e1c96a3adcfd6a07f0064c981549339c7b3947659b775e5b8d7801ef24bdb358bfcc02484816dc9d150677169ba8636d91c8c18bc98443c66fbfbdec729df5a19995e660882da6bce6f9cc09d4d9654835905d600f0f4c341d80d4f4edee18e8fb5590726b28cd2c857cffe64de00c100ad207cea2b207a36b64df3d8e4f0306eac0f22e50e40f2a4d2e2c0b1999fb5148cd0781223e587f6e2affdb623e6bfe0cd22b5efe34382ebbd")}
          Z "0c49a5b4dcba2ae5585ad1f9f2c639b9bf419312c6d9467a7b50e27d8011c1818c76859243dd712ee001152f48b09bc6004f9dc8c63f50fd482061b8712f6d61ce604bfb8755390d8bfd12f8f3d53ebd3ecad9f396c18b459cff63771d0d86cfa4e7d3a5b605df6cc7e093f12617033bd0197c661b6b62fa44e933360812e6fda0ee2f802299e6a3fcd051590b7a2a3041567be61217ec23db57c5e05a52a3b1219ac770c9091022c292ba393a350a0f318abe26b27b4cff027d72935cc484b278eff4b29d990d16a8f8704c323281ac9dac139c41ca7b66baeb73b4ff12e9dd32804c1b69fc2ceedb15a7ebe7fa77f90174fc8028003912fd18eb813de76695"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "0c4e0d5c5df4cf769d5622c0e72ea313bd62d52354fe4ba54b48c6134ad4647672d8c3a0a70640d49f94b8b0bc209d935d803af2e2333a095cc428ec97432a3c3724e043e3e20a7ddbf6bcff831ba3e9fa45c6008d2da7a5c6d425056ec1be3e1d1bb1b4c9de80187983bec03c34af20f8c1c62b5442e97ca34e48ee227c94ad3f7d940291fc74ed5155b0e5ea616e414458ff87415ebde12bcf4cb250413a33bfc1992d4e20b0ce02b060ede9b671e7aa4aac0858560eb5264239c4a4f535c5b3e677abe2524d76549c0897d8774268c1fccdf07635e8adec9911b02ca5b96456c89000710c6415307f331e4b3cc53db1097021ba8ea995a4dd83ff11afdd9b")}
          responder-keys {:static-private-key (core/hex-str->big-int "9265397e5cf15ecc96bd8e0abf181bd515e28ab631069d95f3bb4793a404a99e")
                          :static-public-key (core/hex-str->big-int "4a941ef5cacd640b32b0b5dda25e48a6da8b52c29c5ae05903525b6b7aee058eee3be4b8130f64578768ead3849483ae6425e5795ff2303cdfb9181c7929a3e0c891de0343b9359f7a3f755bc82ed10e321e43462ded13b1aa96e537040041a7984e2d51cb7c8caf77860253e2bc39a15ea59954e0fb4de0355b63ff7512b840140df5dd4961800c696b232bfb3862476489d7298840d8b5da4c2965c8724d026a016d4e5aa69e8a4117ca9e9c4cf2daa7b1312c64630ab05bdd940f64adf1f99ed61dbaa86b3e08d16f2dfc8c6079b10a733c6e6313fc59ce14022147b323ded4de62a800ec0a907e1adbadaa00e273c3147839bdc8b1deaf42206a114e7373")
                          :ephemeral-private-key (core/hex-str->big-int "544b29c3ed4182ca0606f4a023ac0aa0f9e208e6642819798dcc1d37cad59a2a")
                          :ephemeral-public-key (core/hex-str->big-int "52152bd94d703ef6c6921cf4b90760472cee0c358664db31c36a910f1d0fea28be4da4374c48a0d7c6f89da0eb8bc2a819907ca10500068679b125616a32d5c250ee82696b9dca9e4630c04c8de9843cb458149318d7fb3c81bffebea942a49e45472ff6fcc07351c5e256b617d5c4f9f78ff77dccb329932dc99d2f2d2d27d506f0762186fe72404e0f31c84aad50e646d1864d2050310921b78ac76f621fbdf0b9fe42886785227e07e6d78b85905161624c36045dcecc6e3a42a67fbcacddc19c8c18c24c343f4a7c982cce15f1db348d14216aa001fc51e84f375a68847dabc374f085699b4be14afa571c65539beeb8edfb3c7c4780b0e5af28d127a3e6")}
          Z "04edf48a45762928def393d22555a2a86b0a9a02034024a620664cf6731ee20f243bf993a090c6f851968ad6f96f5dcd2f59eb6ae178d728708b981736610f4f1245d7f716650d1a0d0cfc27b5cc4d1700320c984b47f9e926b79f1f05b5a80ad35694c3cde1d9633ee8af0902e7d0be6ff469f484bd782c2f6fbb2b0fc0bf9a3444cf3d379849239287f049bc32d1aca57a03a89510228ec577c8318808a704a873627dfbc2ee2e40d9ea01f16756edf4e0cd7333fc10236c89a6c8c6fe15f7d98aa8713f287cd96c06f0498982f5f8a012cd1871b905a6aa3f45c6cf62e5a3053395732c8d4540d36b58b6f845e8a463ad799019a57e341a0e47717c9540b7"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "4b7e68caf6ae183fe042eaa7834c7e75be1889767f8f89ff6338b0ecb8c3e354d614bde4cfe5719d3217e9f99fc528fe81187d1ac9418d0e458455c2355493aea549a6242270df7478e98f106434a8032b3d8c757b1cd0183f12ce265960ef840b53419540c30b7a8c064c5e2e2a39d867d76cbf9c395a5a81ec170b920b49f875e547c66a35d5bbe3476c542a6d4f460ce311bd95a06f5fb835b9a7f66fc530dfc808e1c71e9d3611febd002a20292d71fea9dd8ac2dfdc3cb8ef69e5c1cee05eb5dc80f51d2cbd98227bed796c442eff724a0dcc4c35f56bfc4f4532e4d53a78444d2a4ab2eb7af4f59611c0ed5c575b48e75ad1a898a0322f9c3b43826a30")}
          responder-keys {:static-private-key (core/hex-str->big-int "b7cb93a221397e6c59b1ea2d69736308effe296d55efa57bf4b3da746c22d13d")
                          :static-public-key (core/hex-str->big-int "5be1575fe33cd95a1a9be3b7cd97760fb48100fcdb6ada74716e7d57cad31306f3e547e5dc7b4b3b7efbe260e9b799aa3e9090945d17613ab9977527b4efe79eb303014d8bb13431daf7b82c5e93ec3b1b63b64767e86f9ed32b7c25480e4a927d6f4098ab807d9cf841071ef50ee6ea8e56f57c62edca06989052d0eb424796f54ae91dae3940100e74ffc8f07a3fc5ca3f64fa5ed8edbd1d5f2d8a38f0c1627d8ffe486ff18f66d733d92430399215b6353b9ff312a6c7f555355cb8ba328d1b23f64395b876d12f4dcb5fa31e359850d4a17a0ba9c8bbfb2304eb676eeef06d9dde39d73e4158b10bbe2e532345e06007c52930653921f11afd0717b9327a")
                          :ephemeral-private-key (core/hex-str->big-int "3de22789070e66bfea416c197513dc2a0c441a412018f24badf2bd0c2eedeac3")
                          :ephemeral-public-key (core/hex-str->big-int "376450b265176986a6251d35014b19f22a4e8d7b07a261b14e7caafdfae31d90db9f39cdb3351eb855c1703b5055cf2b8c2eaf63405c7cde29863cf16a5cf8c6fead4cfcb1e77ce3aeb9048c7fb2fdce7dbbaddb8410e073f298eac1b7c61f285308065c9c3b96e18918f18d5631e837e36eca06c3deab118d5ce0af0cfce6738ec2d39fb01589f80d4f96b56523b2f9ed3ddfbe04b8cee0988c062023bbfeb3bc76ca89b90c00596c8110fcb67553d99b2798fc82e6c46d347732c2fb8d6bac2122620725ce8c3025bae803fc5b5f60ab1928576f206725821169b8a5015eda879b341de5c058216f35a4cf04b3b8e97144033cb3328a58e48b1ff41fdcc6f6")}
          Z "11f54718ba3d49a6ceb06aa7831ba2d72c60fe8558b691f6a55d1b99efba06cf06dea78bff7808eeb5b518e72a3519531b8b0c4380e4b3d33dde56862e47a0d01f9a38dcff11d0f5341c315075d5709880e9a458fbf1264a02e5ecd732f45223dbf001a9144b03714b5fb69bb0586e66400606a41a4352e27535e20eff473f6be596b7f76bc616eeab1184456d27c9cf7b3fd0de21a74a8ce10ae9dfbb4936539dc36de676bf5d765f2d43e234b705039f1ce201460e69d2920aa6b3c6fc71e5542a9e254b76e24dd6d277d25816217dcc6acb79c42e37e05094253b8a288efb54f42201bd021362fb2cbeaf01aacc004ce8792f8feffa0283971e239722192b"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "8c750bfabfab4a94e7f09a9050b7e0059967418ed282aa53a818f7e3c62fdc907a6a58d8ffe29ba22a4e327d27a317349b7fa8caca4477237d4b2a1fc55598e19fb58a57913247fcf08ba1fce60fcca96d1dae1bf861e6195523778c5e016a28c1b3fa2c2cee5922427b4ca90df32a045742916f9dcf1757c473d0c091b889c74f50aa91fa6f3b081231a20314d2a7339a05b1e22f60f8dc0549d0930b2085555920848660d921eb10eb2fa9fcd823c3b9c6e5dea9bab1897312ef184735d6c953928d9a259ea0a715d43b561ebbc876a146351042ea62a9239972d867dc855f45bc20332595e084eee77bf1c2ddfe4eabc01ee9935cadedca784eb011b0f54c")}
          responder-keys {:static-private-key (core/hex-str->big-int "4146aaad16dcd197555d6777c3dbaa40f3026f73c00c5854dfd37bdd7f8ffaf0")
                          :static-public-key (core/hex-str->big-int "6c7139a0a350b596c56432241e2da74278f1c319adfb234193280d6f5dd707aba111585b2c5a3d4153fc357076ccd9a90552050a966bc84abc6487a53cdadad172c265647f6e13f4e02f16380b892a23be9db3fd33ffb512e2e9681429d4023e92f4c40af2c1ac54b76df8aa39a4637f8572ef8ab6127b6d110463cf2c796c89f19b03d98bdebed96d98da6d0914cdf3f3797b1c3a4f4c8c669f361dca7779ae9c308b4bd07ce2c860ef03c4d191ac7978d7aa8350581e1c88cb63a4854936f3668f5f6b0420b9e2fb0cdff0a42b231b1fbfce859f65f99f50f71e523f61b6f042abc5c09ba6943bd24759f36f6931f98b409ab8ef3372bf9dab47481adf0757")
                          :ephemeral-private-key (core/hex-str->big-int "bfe66db6da774e303ee77b8215f4bf5725c1992ab9787eda9030c039ea5ea381")
                          :ephemeral-public-key (core/hex-str->big-int "0ff8e51fd84c4d6eb6a68c37b6477025cfff21070aece9f8da15ab2ac8a99df657ab0dcb03e67ec21d6cce7cd284a1d398652fd50c4c3de454cd3473bc7f3eedee0f5c8fbcbdcfb51f6f6c1812ffcae9e4d3526130a435d16931f3cc54178678d993690bfa766bd88e20f209b88dede5c2fee91aa3fa87acfd20c9258924d4ec1e0cdbdd9364a46db3c4e49382890077bb67a8b9b0cd2daf9ac86d89f27068ad253c96b99876e904c11c0b5ffba34c387614e5e4dac7b52d53d49f0b6b86de58ee2542a63b0299f9b0c2a2894daadf6fad5baed57639155b0e1be15662300e524ac4872164a580931734b980f90cf21beb31f0fe5ceb98958685e8294e22f048")}
          Z "2106b34e443b682905968982cf34ca94b296cfe860f783b2895906355fc9c6e60e4bde9971c057168b84b14b5365497363322ada912351e0467691a20f75a4cb7c7565f472e1a7626b9ea6c54e236a1516e44528d77888932f220c186191417d527512fbf6851edda4ffb54a2c5dcc6bb3e3fb213c9a307f1b8aa176c5c5b8d593caf38c802b5d52ee5d1103af72cef35f1c7a5603e66a685f8133d36d4bf6514a0be1b8fea54e21ffa83d0415e96e749cd79726383457ad1969915883df2fb3db528b2e0a7e362a0ffd323e2efde17627e75dcfde822abd45e0985092bf3ede77a70a3349126f595407e71b19b56a6197365e63d20e4bfc0bce746846d0a368"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "8080bf929298225cf45cf7392baf904f2d2b18924a6e8b6b24e4205eba4e3d759a916bb73614320ec192421ca2602ce95bc01d28b29efa2e3087e1123e90dd4048140a0d645f596c5f405c2b1d616aa0e1726c34619d350a6425376f0b7ba2c6d950c87bbb293c878474f56fee3553ee97b30d1ddf8e1ffd01b31658393868cce318d04ba4ecfc51c654f047c74d0efff19f1bfd06d626de67e39298770087145085b83dcd5e6153f69621e684486b6a4e53ec13be9692f729430cdba73e91e42d4ef3a30f20c71865efba4bc742388b79ec88a446d57a8d9c56ad70a2ab84353d9be868f97a489b6e3533ca2c6524c184387cb7feeb374e39ec2b444c72b61a")}
          responder-keys {:static-private-key (core/hex-str->big-int "658f653436b7dc97566625dd3851de763f60c67709de3d6c4f32acc0757dca55")
                          :static-public-key (core/hex-str->big-int "8502827af820f706796bb6f1de236f99debc3a9b3081c166fcaf00687a2ed362882dd338367069c1c1dc5b88d1289919c36e2f3a2dedca9aff3ed91f2b70f3c80b3d5bbfe284615a4aa9e5e0ba81e898337b16e7d532f07a6da66e7f0de2e9e1b17bda4b265d2bc06961fbf3fa7098a1921240f094497454fc1f6fe42382e1249dbec815f2c8640a3af61c2cf1b2a9cc871c1a3cb596a5bcbcb3824fa7969ed87828dc4097507c749851061e40dcbb877dcd5288bb822c870838817f5e047f2dec463391f0a6e9b50de178ea5f63b50e84826b14b0fba0c069347e29e07d34f26237d98f6634e6d736c4ecff38912e4cdc3ca25995e28a148a6c9073126bc749")
                          :ephemeral-private-key (core/hex-str->big-int "af091de7b848f1de6ff47248d26c27f25574a0ab1ad76b554fc8b21df0a00ec3")
                          :ephemeral-public-key (core/hex-str->big-int "0ff860696f379062f1641941c47f442358b0398ea04debd64e810dfcce6b3b917f08feb2479d85e532471ee9789c666fb14549b3fc4c6bd8a336804e2f377935cf8fad91ad8ee4e5949176af527775f354031fc83acddeaf3ee081d71ad21f4f65813bc297f4ea6611265df4e02d80b66984db27552aa175d1dfa88f63fb2c279aba426ff9512d0e535fd981e34af61b5f30b985907dfb2cd6751cede8b176b2de80fa7bfaba3376740b070ed6810db001572eadb421ec919b18968c600f3e245bb503c6e3224c6690cdd5a6b075ce815f884b5eb52457a450ea880e0e6053b2c9f697aa0bd129bfc810150f1631aa905d3395912aff28c6c8d72c78359fd7f1")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "3e73e7dfc5cf035c3880ff15773a4dc1f2617f1ec9c420bd42b15b3ffc4aaabcb9a27aef0753595dafc2c9d6604b08a9f13330d2cfd9ba89c8fb52157b4b36395027275f67f1d5f31109ecf44c544ca4c16c54f593d6e1a1aae41fa8d4df251a066498f3c5b9ee239d454ae6ec3e9cd93dd8ad998f59fd5b70ffb2dc09c11232e2a1f0c8d4afa1ca4a0386773aee4c4a8ca869f90b7a8f2ed9c04e7179b25244674c1e3fcb6ae75f67948c4bc3c69446531dc6e4a0474265a3aaa9dc0dd118318eed4be613583500c66b2a975b5692545e11e9ca8beb138658275d7fc5ab3ddb1f09b78f064248fb22ebf0a5f2ba50812868226910dd37e229ceb7c7dfd5a0de")}
          responder-keys {:static-private-key (core/hex-str->big-int "3bcf8d9206bbbea8d1d5aac2c33c1357c940a940a66766b2eead17119a3f1f6f")
                          :static-public-key (core/hex-str->big-int "5a4c747125f91b28255528d478f0fc3ad167ed4431fb350fabf3e9591a640dc04701db94c72b113045753229891a0a9f0ee5eca8ac3aede9aa9206373ddbf22fa0a82b9d9d1b064fc796cae006acf6158684d36f18d3b5ff5b9b80258bf2f4fa2afa9ed60d52fe1c3e28735ff536417ec7c917653b18319fe890f8a47d9862198cc1515ef0f27180a022e38fd0442ebb8266bb284020c3477aaa1e9d3fe465c9cedc39b1e7c7e5220c63c88fc348c33f579c771b60a63bc56f0ea39289a192758199dd421a61fe680a9117217d261d09ddd6a15ceb08bd638fb2b311e6b5408d2baf3e4abe1d19d3743f2d7365394c5048080378c3c865efef469c61182be681")
                          :ephemeral-private-key (core/hex-str->big-int "9c5f37dd6b1cbd2afebe2f86e850661c378a5f96b7281516b4193c495218691e")
                          :ephemeral-public-key (core/hex-str->big-int "444d3127ce536de214e33c52a4f92b82db56ad53efdf4220b5acecf754ac41a3bad7c35ef535a7a77f07d9ec042e912681dc04129b50d26a40eeac0cd139f63468613f2a59c9eb1ee52ee6904f999cf00a3c18cfefba0ed941a2f3a03ad5b281f5015bdfe77d6ed385a0b1e4a42c158af61992781c1d1ece6b623ced90c4b47d474f0e5e2cb23b8db23cd2b2d6a214c4cf6716f1c43c60552661f2c5a51f9a0ab6f8b25e5015a0032043eac3bce316961011d9821db9829e655daaff94d6b6730ec1192ac8d3d4f2573c3038c410d5555b9bcc589090a300044d98382ff65792d22de18e369ee855f78baedd10aa24cbc889d1aa2555dc6453a8a5560694547c")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "21024a0e2770e85fd132d09e38df48bfaa027268021d3d62c1241cfb9d8674890b48f358ef9313c9bdb84ab4af91f325538dd92a18ccfdbe904eda0d4553fea145404fa3ded187291d9044683e9d4204d8973e8f10ad163b0a20c43e2f671b24ff8bc60185d1caa0b6a2069db9622258e431ad9e5f46091ed30c4a556e7b80b6252b9e1adb555b81a28ebbcee0ea0e25a36c22e676e8116716be9d3955348ce23fec095dde6a922d3e40b5e01eb890e25cbebd5a3f4c737de306820d1b89a26ada95c310edb6618f41fc40fbe8731bfab1bbb616c4064372383a14e12482972827a1035aa374d969535a1a7fd2229723bc2e84b75e354a56539872b1db474786")}
          responder-keys {:static-private-key (core/hex-str->big-int "bab5c6dec1dfe9bd5813dba665a7cf719e1332a9646de8579eeca62c5b21b0c2")
                          :static-public-key (core/hex-str->big-int "431472dafdfb9d3aae75b8268e3ca7e52b13c6c2537e6266b49183cfe10e5ab3630948b593cfd8e7991d6126694a064d448bf71fa53b92af3e06397ba4053742f3aeafd07a2cc6c5f379517c98088ff2cfd5323e6b1a28d9729e8ece67eb963ec29548dd4c9c143d512d99baa8820cfc1be6ee956024c940d8413adb5f57941dc804aa953763e5992dd1741e09f8892cb51f4e2f3e948a0af52724f7c344fbcace585b0c62218adbc01ff27a285023ee464eb0388c99151d54a460d38490838e55b6304f3608be58cf9d2a647e8627441c47ed234e88931466a41dc0056991543b994de455915972142265c488bd6f3eae0e6d32c3ce313f90d462b32a4c61b5")
                          :ephemeral-private-key (core/hex-str->big-int "3ca3c4e4221b25d6599aa65075e18505b98b7fc6da3b94b263aaea127ca9e452")
                          :ephemeral-public-key (core/hex-str->big-int "303cb8bab310bb0d2cdbe46abc79991470ed0229b1c1b7f7da532b9a4910770b9e940ebbb0fe0d719bcf49947b35754e6ef93d57f320cbcf7178580ec64b5cb25c85d03481c29f1316a9d6893c286a51e9a62e98a3445992ca17783dd6235d83a617c9c01de93e17d937d0c06b044fff3aac27ac6b8347c85d45dd5b01bab7e70bc65f1ee0e8baa074d5c259b4e42911623a5e5c82cc92b8ffd8cc38efe53b2841b8158e761ffb19ee1008f0d4dd9e0e4cb3843921c0f74881aadb064ec8b1d94bf38b93ff7400a42099e96190bf6d9c839478e7f05881905aa98453d29f6bac79eb8e4d828f6f4f328f9b92aba07d328297f1a4c44c10282859049a30059f4a")}
          Z "52d1dbcd9dd7d771057a6fbfad4b55ecb20daa39ff61dafee6f98b3b3519cef29f3b1bdcc99b438f3653fda27af6ef1d37f5a876cbade450a1d751ec1ea7e5194f584c574b704bd69151cdec013a3d34cdc7b073c6bcead2f00814cccc6031b16d3d523737d877b1df1b18b3bb66b259808f553440613c7e8a4a1ae56ec387b8c4dd6c2b47d2a8b8a436309320c70b08b2663d06da14065c6888acc4c9d0009edc20cd33836fa30f3a5282f092e32f9481f87ef2312d27154d35c3f58b4eda076feab10ed882c51835a254fc12a04e6bdb82027e8afe13fa31eb368846a7f55b376da86eee6e64d8da9fe70d85d850bd2bb6792238a6290235340f6d10438f43"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    ;; WTF???
    ;; > Result = F (4 - IUT's Static private key changed-prikey validity)
    ; (let [initiator-keys {:static-public-key (core/hex-str->big-int "4f67a9b732815237a1c9f072910d51ee131284e03fd75fd9a38e679510594001ec5e9d30df8b0848cc3d7d6a91043eca6ed38c0dbcdaac041327e50a070d831b3578b877a425956052ebbeedac9bb382d4dea24525066103b5ce8fd046ae91afcd8077cc72109c61cea379436cb6c99ddead255c15a1308e7f0c87bbcd00ce159a0911554c285d3cea338061f106e8fa9534213505a15a1f3a39c51f3fe6ab941937589e29d7875af88d08f0eaadb5f5e87796fcaeeecbcae30c8d16494d2fbcd53304fd29792e659504f7e7cf76b016540f023a6bfeb6c542de75abcb58897526193b390c990b5e24d5813c7d4ea3259cd3d20138441c29a6c981649e6dad8d")}
    ;       responder-keys {:static-private-key (core/hex-str->big-int "9d4e697898cabfcb889955ba61c1db573d3b46cf6fc55a12b0335b869132814d")
    ;                       :static-public-key (core/hex-str->big-int "4785c71bb9032803c4d2d8749fe8b9daf9ae0b753d76a73839ac256416776af621a5648bdfca8d95048f6c3c4e03b76bd33af64630b68f71143513f02b99cd575640ee491d0e2119c6a7d90bb83696c3edfa678c8e0203c77d4c513fcee27cebc2306454e2efb7790aaf35fc85f3a1e7ece62f25e94726073fbf39a307687776fa8f2f3e9274d115507ec38a4861b90be5ffe7738b48b31a32afca8302de74e843fcbf11636401b817e2ce6e3d372c66c3e53f63eb4511daf475ccc2322e0e1b38900fd4102cccf6e8111b609baaf0244d4a705679e937850cdcf4389ea52168d5155769f0a9f4bd64818edbd62f30dbc2bb6af12d6c19644f3ee63fcac1dba2")
    ;                       :ephemeral-private-key (core/hex-str->big-int "03b6f2233bd85742e4d524cd7982a4872afb82d790025803008881c2c05c20f6")
    ;                       :ephemeral-public-key (core/hex-str->big-int "1d13eb3a55f2de98d0e7b6cdccd71236de261d6dce460970084bb55a73a273b5b6d337555714301b2e40903489aecd7c9d926a28ad24684db381b0a6f87b004021118a4b01096ebfef868cfeb2a21bfe152ef49f72f58ab23d57126251f9d8d9ca78993a0e608e439fb221c176a68274978a869648e56aa2758149b7f4e133bac5f2ee0459bb79cfb11bfb83bc5178affe539f973b74cd0606255666ce31efba962d86f5e912ace9fc4d28136c5b971826313f4653d11da116fbef1aad57d5da59389c2117b4663946aa88473600f0e643d3c09f5bab13eb6ed74192a84813f6a742af91f1a7f04f7e2ba2d01c917b90a72c1048d5cff51a7a79e72aad423c23")}
    ;       Z "56c877bec2fa149b863491192ba7fd5e428d44149a625de429a26c3b4695c1956b0cb6a6774e32c5d7a6706ebda46552fc36def9387f1ec81c42575de5b9d7583a769298e11e929e5f289a8189ea9c0aeaab24f682dd830d7d9396e4bb4b170c22446f35f162e88b86e2ef9d628d8c1e702a6e1d2856f92094e042a7e1d017ed31f44b7d6c2aa02e0809a041c2db6318c2241106566efc67471f3af28c3678644f1a732b88c8098b83eb59d0eabb938fb8a75b823fe2931700843874e8346f633fa0bfb4e497a6e52c604697c8ba3b86dabca8d6758a6ec3ae736e10b923ceedbcd5a993171aa756ceeaf61bf9c2aea975d60b5b5c8cf2dae5eeae68a941fc57"
    ;       result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
    ;   (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "2f099311da5d62ddcb69b50223c5a31f2873b1870fc2cfe696958d86b7060facc1a8265d2780e0dd74e08549c215c8d0f1980512101ac2c650303788aab2bf298a0121ad180c1b6795cd2382a0d6098dacc8f1a1853481c1d70dbe603da5e8efd7fe16c9fe007509938405d34fa8c619623e200371793663574b59ab5a45c31deff2bff20b286da51cbde78a612dd4fe80a4fb91446848bad7cba6ce031bc2e307043a3916948bc5b577917e702e03742bddeebffa2e370b4949907ba0f465b56b5d60410678fb47b61cfea94af62e5489830d77a011f625e8a6798e55db44a00b33a98b4499ebe4daee8a268f84dd0707938505056432743eb6973106fd5770")}
          responder-keys {:static-private-key (core/hex-str->big-int "96c23562e13313c5fdaaf919375fccbcd627992917622f2e442819c2547fc95a")
                          :static-public-key (core/hex-str->big-int "3613c3f4a81fd8fba1748effc65aad3f13fbefa36cea110dfc6d35ee13b1779fd04b0a807685bbd1291c27bae790969cb254e7dcfb7f8be72c87b83bed3fb253d080c994ff23882623b4e3e7ed80158b0bb1cfffee88ca494645ccb796e3a86e23035512290eb4b8668ace2141cf2122aafe2731e1eb53fad6e52cc481ea27e796cf067994020647525bc222b098f815407989adf7232318fcb2a9f5b38236cf22d27bc709ce8d9e4bfb6097689e0c8037253e4e1bc617a1a9855019dcfb42f52c5742f82b5cac7afcf6a77945fe2d0e1a8e77540987ffbf8b9b92d875cca71436ee82366be6c48725ba52967266a13e71a6fb31dbcad3fec250005b23ecb2d6")
                          :ephemeral-private-key (core/hex-str->big-int "244cb81dd08a9175631399060d1e3eace49fc9d615c5846fc380237e90d01e77")
                          :ephemeral-public-key (core/hex-str->big-int "5597820c99fd54840dd35c16743367c78826e8188d8adbdf03491ff0ab16dde30ad929636fdcc6f94ba00f1236f694b1ba65dbcf07f6bb45e05b700c8cc5b0cee32ce15f4560b570a568fe9d8ceab3c303157e2cd23533e0851d7e468763c109ae384a939055e76afb0c21c42a1e8f5fd23c163a9036a2cd298e551c504602fee162a7f80bb3e8217d0a8e91b0e108049cdeb607d82a713c9dab9ba196a81cabcc1a146583acaa63a23c010b076f5c6fed06944429c2eac0ca6cf66315fd0a69711f390fef01d7d9e238a74f8aeb9c519fe5a280f972bda55fa418c19eaa2daa31d73ce57bf6d3180a1ca48fe8fbab5d0966c9172d10285b683b79c9662929f3")}
          Z "2a62d3ef9a0551e056f68c9d464e8d301cc540014be0046f8f2827372d056f2ff08a5064dbbef4af9b3fc8690bc0132db3120080b1d94271b103eb3d8634b30fc90d47315b63bc1e6816de64f7e2304f76a76f327787a9f172d0e89b8d49544ed8bd10cb6d6aa5404d09281cdc65a9b89fe961cab43d9e5f8a557bb00ace58ed20a01ac20e9c655c17d7efbdad51b6d2ab90a29467c0b65bc589979462378f83bf5be83610fb32d3eda51ff9e0d3478e4df7953382619289b0c879173fb937bc90cb49fa3087830200c058b09bb2bcae4c3ba36fd36ed76a9b9b87bd84a6a71de57f3d0d600611db7899b8d7fe501a79c01220888e75e3fd69b179e71dc9c1b4"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "1f924e408f8d48150e2249f222e4ebba8705cf57961dc2cf729007205fa74d1c6e1e39ae055a175a350d3eed87073c873fe8ac8f215da5fda3c6dea5aabfbece118adb1d079dc90bda568bfa92f74b01c0a320bed8b6241131ce58b93330443f88366d99ba6e2affc402e3581114ddf61b4781a383e3a960d4544db684ad69914b78f45e11fd882eed3f87720c99c2d40d9e38ed45a0f2b603c0e83d0bfe3aedd6afdb0e9028343cb767f725a6ff8413a0e3746f0d79c87d7e3f2b3f4d11b7bbd71568fe6d09a60d3a7684d2892fed7dbdab946fed54fdcbd435d2093d089f45d319d71c407644bf6ae7dbc8ff24ddb869672ba70f8289345c338dd52fe80204")}
          responder-keys {:static-private-key (core/hex-str->big-int "a1aed4031f267e99435b5e9c2dd5056b82767147960fbaf4978d8ecfb652fe62")
                          :static-public-key (core/hex-str->big-int "5edb647c94fc939546dd82fea16f96dca97de498b00fa406bcc80ca00ab41a72dd2426a6dffdd158681635118fa17871323b51b0c382620ff91bd86ee69f7905c1f50fd6cc6eb238cb2610a35ef7bf67c080f4fdfb949cafbc9ba385b2273a4be214ab658174b3ba3be0ef750c2bb90bdd030a2730c4c7b23226f1efb0cf4d82d2c32f38c5d07b43e4c28bd28fc672dac3f992d2f44fa8c51897e3dbc8d233ba3e7506283661253ec9f8af401632f43e74a89ca75e95622f14521537e687a84ae3a3c09e9afd1574ca00a3b88a1521d32e8a0c2fdf7a9b1a7ac1394462bba26fb6326db6695da66b9630a8f8eb21354f46a1c41ff7887013d5c97012143019f5")
                          :ephemeral-private-key (core/hex-str->big-int "97df329ef9e8f086aadcddac5e976c8ecb3396cca168ca3b6fe9702e20efd5d8")
                          :ephemeral-public-key (core/hex-str->big-int "10b4f59336d42c4688bb01254c23994317471cf0b595ebf8725fa4f2f904ff7b20b12b0178bdb8cc986fdd93b0ee23e770752d3ebacf40dbf86f04c337c10de61d28b2a22ad2be707142c7b39fabbec95e5bfe2250f86718c58e47b02067997a563cef1272d713a5e3cac277eac9f9735e93b7ba4d6ec8e0cefdf71341245389bd0486acb586cdb20095a145bfd6e2e811ae5a2e836d8d1e48a8215ab51db08f323dc49560941ab4a8b4c3f5bbda4b9e09e700a27b60d4ce9abcfa6412f5fdbe56d009eecd0a27880d9dc186de86f96a8a085771dfc894f954fff3587201f243eeb136d27859539d19a5f8edc8a3d7a1aff89b4e7f4cba129a19b55fdf8bb83e")}
          Z "3047a78d47a64abf9f2d883003595ca47eba5377d5d071dc07de0f1404d913dc908683600829e7c42be7b5fa2ff38ac7e1af3e18f061fd2a563e81cb18d442969e5bc4ed6d9196037f21452a8c504c6b19e8fcb39117bd523a132434ec08a0d27fc7785f9dfbc683c5916100afb0043f69bb782cd8e9d58620878816886fab44009ae0513c7c080a4398c88ba7adc73635c13853571c4627ca16fec89abceb3c09672d102c93791038608da1701675c5b8c2d51640db909bdcfcfb883d05f9e4383d3202a00b579a3444c3f79151ad460f59ac51c73a5a3ef36b05f6b4e2f33462870be0f92586d5c71e434a324f096eb164ad9952d6c1e57538ab45bde7335e"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "0bc5fdd360ccf1a61c72f3489d576c9ee94e30f03806fd2b79d531889874abf2ccbeb1743931a8536280eb6a252c9d65ef9453f909eb9304f7e219a5105d7d4848840ea8347e3c1ff99f1b757934ab5744ae679fd195ba0fa62c5ff8e7729acb5126358d462d983fa7c8c4f83ae0a4ff1c9f1809d84dd3e1769f38800a8dbec4cb2cf8fbcd31f0901bd7ef368dbd8412eb4b178568d6e0a0a8997110dc08ded3f1024735047a493acf0db35e5907af598c20fe41273e2ea49f85bfc5454f97958f8eef6a22595652097acc824590812ab76fb01182e839d18713ef42dc8e7c30dcfc8bf82b84bb13526bf1044914a705cf500c11728112021ee60cc354a90a8d")}
          responder-keys {:static-private-key (core/hex-str->big-int "cef29274f209ae6b1aae45ac687000d046e2f206ae4b35b6b7a0440eeb4c7132")
                          :static-public-key (core/hex-str->big-int "2163ee5fe7892383cbf404d7654b40e114aa3e28d2398636aa85274eb153fe3c6e4a5a4e3f94785eca928c121f89d04654cd15ec2f646bdc45f903de63ac61deab1696b57e1418211d869aeead8f1a15b9eeef724142e9dd5a8efcdb655c369f87d5bb7af4de9cec2cad2124b4e7a82ac7f5364af9aa10167347fce40dc0ace862cf202158df0626d5697d83ab8b4986197cf78a8f98dd5e6dfffb74eda97245bc9b4fbed570a201e5db4f64128e48196d090fef818d937cda376ad35e139be27ea74cac71955a4351a05633009cf60c2b8a79e3c163f36fbb83995b46b5fb880f73059c0d2462dd037e5864d768e3a27f02a875b0531586e97e2ba4f44aa3b9")
                          :ephemeral-private-key (core/hex-str->big-int "ba982604d3d14165f40fc29a74fdd4077a962cbe539d69805806deb805b9a2a2")
                          :ephemeral-public-key (core/hex-str->big-int "6767ccb65d930d1a6f51a175efebd22d7e0a20aa0716d4d867e7e196a54a6f2a3ac2969dc34e631c628a282504c128d3764d3db8d94d2a2a2714fee4a0cc249a3d81a1fab428d428729434b4b66ee7733f3c4ebd55b87e6e0533f28f336ef87e34cf8b32aaf7edfc65581c3e03a00c597d9c7a7d9c047d947ae7a7b925b120c59e29ba0cb9491bcf0df761c384a3ae670f8854356b86446b90baf357c91005bce0b503294a1729d3a5003bac0f141c13eca9c52237a3945cf3b7b19c8093e1474677a1e20a63385b798cbf22fe49f05010f3f4989df629f65d470ef2a16b3dde63c78153f24ad16d1061cfe0a213d740b5c666461583dbd55f9929378cc46c57")}
          Z "6f4c90dc82acde9eacdd3a44f7b5384d2dabd5f4f3b0660839a6f47226a12a8c3076dcd2865665f707a9b2d8c3208d151abb9c8adf6605c60370d27f47b20d319ff18041e81f5b53012c02ebf2ed94ce9b1dc29c4d744c3dc91e14cec578fdfdbf57ef7b933206e240ecd98547cd857d788510036d9b8e140eef3b6112e20fbbd3877ddf400436e48f774f021b7afcc0c9dfa7e644625d865b1d606a6a99f41bb737017e74179b92e7ad4f59a7ffa78cdb10c3b06eb731389508231fded2013611d7a500fbeaf421c24eba485399b713625548d27094599f2e5ebaeb11d90935b210154b2920e64e6d67328db8ee41d0ea69a7d0ad6e3003576551334e727769"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "41a7a21022de04695528dc389d588d9dda0e7cc102b7b8bc48847161d6a64efbd6cd8378b6173e04b356df12b76e75bed7b146bf25d0a5b6fdad4fdc5f5715630d28b9bdd812031a1e433a1faa48a491e4d964e124c25b5a728482a4cff6bf1d33d54e4f721d5d7ab6c2d7973f828616cb576ab956bb9f21a14bfe1c3ae7bde2fe1c479048b2800a1bd00dddee8b2dd552c2cae19ba49a440f12332f1186d33177d02016e2c0b01a65b58489fd406b8fcbbe25615cbb4e2b74ceeffaf9f958eeb6ab6395eff7efceba901ba193616a2cc2fe648fb0d46d6d711c6890998d7d85af951cc964b1300bc2a6b1f914d7f68300d081a4015d8b1fa11779cf991056f9")}
          responder-keys {:static-private-key (core/hex-str->big-int "95127f033404ee5d5230499613b8116d58c92cba932ecf45c093179d6b9beb2a")
                          :static-public-key (core/hex-str->big-int "65aa2f49b3e1a1c6c655e7f16376d487bcd7ee272a60660f4bf974591a4f860ab63185b0e49f377aa161755d56994f8d457c5ca4f9a2faa651d689809acfc91eab8538ab38bf75a19a886b1b787d5f254900f0b7cc43f84dcda894ed6540bacfba2441b1ecd5cf33abdda135030fe067e581e823617ab56290d9545455dff0d469eb597cb8ccb06c9e49c0939fff4ee71426e42e3aea568a62319bb9e88225dc4761e9400af4cee6b09557217c79e3b80fa9fc3bb489ae60168329e92ef744193ffc963332146cf35513661f8e1a816736dcb92579b3197fa39fed6dae7dda4ff070bcf85bf85df508b8aded81fe9e7f503a11370d9c4a2dcff6b30be417b67d")
                          :ephemeral-private-key (core/hex-str->big-int "9adf2639d4923e5fb5e1ebe5f3bfb02b03eed04e6afd932c7c66269077b6a462")
                          :ephemeral-public-key (core/hex-str->big-int "43710647bfd254b10ee6651d6b198507803c8573aa346f3d90371c53bb644e111601881bb7735bec43d9e2de6ebe319df4860faded2caa8b49b31ec76019a8e514de43031c520e262f762bb32c63a0aaf9f1f8c86854c4b0f3d0168e63dc83954fd8fb7f11c7de46a2460371cf0c19819af2479971eff56e35e6b2f96eb2a29434ea044494dbb35d190e977c4e21a4230192b40ea31ac401f30a32c1214578aad952f859276be6c77476ea70894f7476186d7cd9595112c72a87b8c882f4459bfb81833705b4eed4e182de3f465f24c882d9cb86b7c46c05b9c375fe088709acee124a623e6076b1b5a0ac37dd4bad2881c9cb47c2e060be4bc3f5aa86f5abfd")}
          Z "04d75c4af035e3cf235990240b24aba7d4499705826d42242053e58e98112f0763ea59c5ec59ccb74be40c322ca68072a5f05c357c9029a2b1cc8ab69eaf21332c22c8808255657d16f74fb48f825cf4d923e38e90519fc46468d393f2a54096bf46b8c59d54ae57694f156f59722e8f4575168f8d94364b2035352bdbda7937c0b1698726fcb7e6920583364c04366390dda7aa5d8e79214c15688b1126a13c44cdb8752569126415004c709219e7151173e3847c35388510b3091b91dc559819fe6d44bb4ccdada4a7eb7bdea39a8494f660e94ba6518b23520416c26fd95d947c1e2a636530b7a332eb1c82c4c75f3526ac2cb906c65112a508e4abf42c1b"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "77e9dcf973d24333f88f46743b46751bedf4733a74e7c0d4ac15326d74eab5ae3b92e01017186570d091bbcb4dc3d7b659c161b9040edfcf81bd434976ad41c97ca73d8abb95a490d4b8575d31566b1cc6c20e5054d9436158fc24fcbe0945d212c5b8fe1f285ce21b5798dbdf0461ce0b2831c1e06b31fc91e162982b03abb30dddbcff8e25db141e794f3cdd4f34e1b8c4ce874a3c880b309ea47bbf5e526e501a1b3ee93178aedc013c73323dfd4f112ff16edb19c7e3666e8e261c3ba64e4c509ab708d761f0b4ae8b7293f3b02a58d3f97ad9ffbea932661ac79cc5554b0bd096634ed58606b95fd4cb0a2f743188d5a58fe12f2d10895d531629655e59")}
          responder-keys {:static-private-key (core/hex-str->big-int "9ca7157ee4108f41ee9aa6cae0c6773d28ee0c7f8b9f5491ea503d6dedb97899")
                          :static-public-key (core/hex-str->big-int "4596a44d3090dcef9fe9a40140dec63e3a38b73ac3a75383ba7e92e1f512e820fab134f04d24b19b3a89314eb8794b984e86a7624c9eadeb9d879939e517fa3caaf2bb2d1b2f00e0899fc3c89dfce7164f0bd4ec8ba9955c0837a7eb0a4de863689838c25fb8e852cef941283fcf8dd7847b111b4252d4a82bd98ef90f24efe662c24b2414b16196d50b6f2ca26ee2b555df8bca4716b352aa95633ea91bee380758d171ed38b83772bc2664d134eb1c1adf5c1ae562f9368e21dc30b61366e416e27497924993d0f19007a1b237804dfc40b2edb4139e95c507768a118824df5a7be9f08ebd9531858d1790b62b068b52223e78f5f7de9f5ee8ad347ff69c66")
                          :ephemeral-private-key (core/hex-str->big-int "34a33cea523a666fc69cc3d0d1bd2ad80a775a19b457b78777e9a82ea057d1ad")
                          :ephemeral-public-key (core/hex-str->big-int "70039dd5b95e453811c842b60b0f19568454a25b71694f786df42b4a6eaa7cda6f739faba54aad702e6799002f189594ad412a664018977231a977871c785f645603d9cf5b8ac2cda81de248bff24e5b389d53294b8c31c83559c9433fe9c2485a6a3b8b5371257d94f49515d6640c8688cf0e55f2272c39f0cb27cfec6238b6bfa78ba6bf5411595d1e742132733b9a691a609c3bb29f1cae521ca8bd00546d2e5f00638e526e3f89c716ff32a24b9e93834e25e755e1e4b3b1c03d2c16e46cf67771bc25277b75d0ea3c577bcf63e2a5e5906620dbefa4bc090e9124ee82b438bf565a6ea84a0d219bde12bdbdb0bf4d111089d60103f475e0eef961f5e2b7")}
          Z "5d35e9fd5ec3caadc5a64974551d16085b1e9b1930030a73e96268783913914ffdf186f15c82aa828d9cbec3572d4a382830db87195814e998e8cdc0bc193a68dd7b97c8a744ed24373493c657602f68776e339a8b4c05a9e8159df5ca51d79f7673895a7cb6e969da3751fd576a21cab9c3e87f8da8d84030d29af7faa2c82beac7e0b5958402a68990c3112255453a2d9e8554c9bb9771b6aeaa8716549dfb543e1592b580d23863cc8bb81413b3d0e1ed68de286189ba306ffb833542774aefcd0e25dfa0ddadc6dcc6cab4d0988a2440c5a63e1825e18fb9052f05d7b9dce653331ee8399c5aad8a42c37b7eb21232511cd29abc3f5f16d8fcb448fc0e1f"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "3250ccccca678b8bccecb8df2dbf3e7bfdaf940ccc9eb4f11873df5f2455e1fa61804dfa173d1c560c3874a840f168beb01778eef138b3b254e06f0ed1b3cd265581b1bcf4805c7011e6ad9f5f175dfaf81fe9155da0464392ab2ebe1ed30735cb8e89a6319eafde98dc274b04ef6131c172acfbdcd345de0d7dcf389c7c70c855a7f67061ee116d06fd6bd00bc3edccc046d02f9e0fd58ed4e7b3759eb5b91c2418417fe37743491915b45e22983c80f2dd5817623dc61d474434e6b1024162c79e056838e0d8352f78a536d685f83dd9fdec585480fad14c3a3c978f013a64134545266274206232317f10764ba4f5506202006f49bba2a5bf76f9c6c8772a")}
          responder-keys {:static-private-key (core/hex-str->big-int "4826c96d24c5bff00ee0fe9691b0171e02b61c16348ec4a7143897eb86ea1c6c")
                          :static-public-key (core/hex-str->big-int "794d2af83165adc8de439979a02033bd027676bf7df66895279c8b4f4e55d7ffff574dd8c051c44830c5eb5bee1b82a65b795d22bd04b2a04f9221b4532207ee7439b423704c30f7612ae92f16fcbc794cf90c2e2ba8d5c5b2e53b1b0a83057d082c8ed7506627e2d54dff499e8cd73607b5c977118c906b2f7dcf19d987795f4ed05efe9e35459ac4db9b9c51ba9c04a4bc809177534c76b74e45e818a2e3b5c799e15f4f7ef2ea9ce62f267fb157a3157cf0155122d68da5e5a168619421c91292519521f1240f3f3db63dae5685e3321c9c862ad77293087c6e1ebe809780d646e63c164cfa29ab71c550a78b1cb5fe23140071eb6c050d94cce2543a405e")
                          :ephemeral-private-key (core/hex-str->big-int "666e3e00f3f32a17de783aa7ede6cf56bd0ab555f2e6ce872c67607f340b7437")
                          :ephemeral-public-key (core/hex-str->big-int "3d247413d40e6fb490f50d5a01727b22401e6c2acd4031559042818c73d57c1cda8e0228da76ff9f05d6cbaee4033eb0d03b7f32482fa66198eb94b5fb54f008c26075351a45017925d8b3af0d1482633640fe331b98a9f5f4cf4a3676431cbb0c6dc0f093d00f248931f88031d75515b78b5f8a7b7aaf6b1f69870396382c794a29b0d1c223bdd1557085fdca4bb81877e111dc177ff41495f980f85d54df19fdd70ab7fa2729b12d6295bc60920a27e031ae43fc1f9a93da28d416bf53606755a5de5a54b03a642cc6fc88a8fc5d2ddc9bbf8a4de8dd78de4e793cb9b219afe6fb9ec65db2b753906807dfb4b914ceec3cbd4a01123e11ced4e879328b6287")}
          Z "5d5d21ff93505f9c51c09969b76e838aca9a0057fc69707b8cbdc8dfd7b72934b25d6d985fc5bc18eee74755d255a6b555beee0ec9d4fc32ff7ceb8129508be998e18e552ae28bd31eb277e778eec4cbcfba8c5922858bb2de4ff0bfde651c413e6c584c8e08725b10c70e20504047dce39ae03475155d799b754f877ff315b28dfc9779c17988a045de6b5b11966121a603a0aeaeeffcc18f496598fb7b6ed217e3f8bdd6da9efb38d81503033c6c955c5ab53c5724d1da7b4f4e40d134a60a12eae12a4ce93bcd65bc26e47e15d03fca0103445709d1af886cf3d49b82f9f168119c760626d4e97d1c9e212b8de1b210a599b83df4af85de3815257e78ab61"
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "4ae6e975426e6386dc015bbfcc726e82be6415a81a82f1074edf919b04222cd9ba123a0d83cf28f2de9c7c6e3c6e3eab8769fc913284e941bcbd2c0ca06a0c11031ac638ef9127b7caf6190f8f8a8f0f5978821934b3127ff5209b77b9c5592167e69d67b36eafacd7dac40120de151fc339137fb7927135543bdc5cdf8db5380433ebd20d962b2a1a6173c548c9698c3717044ed3499dc59261793e61b6b00971a2066cb7b4ec06e8f51734762abe3af415592d544dfcf560b9c1e86c7ebe2150695afaa274870fff38115b0a7247ede53a8f090040640bc9878b7f083e94a2f5bfea27ec23184cde7f7d3df0ce6ae94632920c330c9a2fbb8422625f8bb758")}
          responder-keys {:static-private-key (core/hex-str->big-int "72bf5512d7b9b92f32d40c32900dee64b323c3c1c265cdc3448b1bf3d4e7d8f9")
                          :static-public-key (core/hex-str->big-int "1914ee1eee2cc1a665a512e05905c4e44b70a548b5d3ce1766cdad9514f24d9ada5d6e8a21ef8fa9dcca2222aa620fac03bb7bf6d626b694b4f464b0749434061687cfdacb6b1b9d1343eb8d740868e513bc25d41671d42a23f7cf806f1a6b67f2e3f4afcb58335ce719f1408665d9196c01e0841cb86cb91bbf364f2982da2247efc96815e87be6825954db623ac3aea12e9c4f08eaca27f124d448826d16d8aba35e7fb4292fa586f58194fbc306ef8c37cef28d7fd03f3a0ddd37fca570bef70bc5779f5522389ede192ae8739e1d38726a68a575a98ecce37293e29cb0496cea0dad442e1600e2871b06be40fc190a0d07309b976e19fc58b2112c0f3cb7")
                          :ephemeral-private-key (core/hex-str->big-int "7fdf4485e2da2130ac279dec9b06257e478cdf3affcaf2e06829ed346b72ac96")
                          :ephemeral-public-key (core/hex-str->big-int "32cb0cff8deecb22d8df0d34f50a61f592e6d70966c040e66ff94bb18dcc051d23e6fc0c7bba24823032ff6be2e2e6b5aeab77e311ecf03ba4bea1ca8ae0da3ef48ba8ca7da26bd804e26bb79649059600c47a45ca450ee42ad728e011cb0acbfcb8a91a668bb6f31a36098a673a1e4cb5b4bd48bf73877f5f0c0fefb379f88c8417b64d92d5b8e0cdce1d7eab601f22cd074548a53e801d0e9c70caaf530f32201939bf711e63590e0140f8d2e5a8b8f33c97e6c940a2e1bef3e6a86b2d6f4ea65d2cdcee2dbfdd36c4f9b74765bf1a1212e7610b9856140df10799193bc63bdb107e44dbca083d486547fcf19b12483f845ada87ab7063917a581376df1e41")}
          Z :bottom
          result (core/agreement :mqv1 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))))

(deftest ffcmqv2-nokc-zzonly-init-1-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "c120aad237fd11e9fe2101ab117731c7425f3de17f686155d922e106fa4c901666da20e0af31f3c5f331d241dca19ffb4d8a2a5131b3b8e141f73bf4c16d0ea6f43d8ad6dc41f5c2163a1d582a16f38c47f8133bb43ebabe3758f196a9b01134c172c72794604d2806c73b10ca35ef1808017c471bc2533c78a6b75dd5cb3d3e01eacd6c9f5f0f425788c63114ae2e2a5032a54cc06219b39465a48922b38dac28137868cb2748985c449dc96da187cd92460703f6289805f5a0c0a29c64bc7122a889ae3d74117de4666a1ed6d6c850cfa741731f8aa82f4bbc790f71d36ff06f7b5a461f18180fb58af99881477eced508647330a7da773abaeb1e0c662743")
         :q (core/hex-str->big-int "faae1d73793ada3b72fac4a0d11579e9945e1f26b9074a9f4a30c491")
         :g (core/hex-str->big-int "88abc4824517f4dfe111c60dbb77a7fce7844954e45bda8725c5c032c27c0faec4be2a42cab6f2d48462950423550759d7cd1142d64903d0010809159b9cd701259f90185dce83788f13b3d3685a42c24a48e416833c1c92e4ceb2bd37db75d1c3c89b751b97cf8a64218819c9c4ee2c3a087507d9ab2f0d0e41a636ab0feabd80c76ec559ec12d33f87b7bd180129bbb065a43506f765f8cc6fefa948b7f3b9359f9c96301b5f619f7e8ae48849d935a9b7be1abe3d2911d00f893f7d99ddf11e2d99aa6bd59b8ace5f518a4d1e02e44df979ebe467852e2fe7ce1cad5ab499f53c7424f371cfebfca4b6ba5084e86306fdbcae4941b6bfaf2140d17908e96a")}]

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "ebd38c47e32bd5578a37c40ce8cebf624793ce2838d1b19e74c9c8cb")
                          :static-public-key (core/hex-str->big-int "8dfe0f668ec54157ef06f91a3c5b2277aeca96a12bb4b19452a4a71d9d5409d2550d991176e65a159085dc737483878522a7ec28074e4129b8102459486e9e6de3e31ac53850e1d2d898cdbabb25603c33dd6736a618685eac156e29971327a6904f59033fdaf7f5ebd6c9f5a41bfd14c68b31fa35ffd1bee60d686339e95e25eea89978664ffe1acaf5abc6b0d4d17053dad6238f9496646b05ebdff21f51c267dbec140ca262689d576fd1a2a07a561ab5ff751b6dc5f75263ac9b169591d2ca211adbaa66ca464e2e5907ff3ac62dc29e7349eaa9678db73298b83fe21c4075b0a0a521b443f4255acd6ae8b99c99fc0e09bf14dfcc6ded40386e29289db0")
                          :ephemeral-private-key (core/hex-str->big-int "7c0dbbec0a3bdc3a835fc1bfb3fd8ea98bc312b96f43005eb1f2c1ad")
                          :ephemeral-public-key (core/hex-str->big-int "25a13d06f00aa4ed8f58e35219ec10b8e8946e194122a9468f8b83f5e96c4dfa5acbf821b369dd8b435955f5dac0b7e4d79d55fe0b45a3aea60dab9b09a58af6b5f4d088a81dc347d3442233fd393b2f193ffa66b5c80eba78d14d5aafddee629ae1e4294640f14765bb7c6e3a422d103cbed0075ad823ca5d65914b823d66fdc9797cb0af490ee2caaf2a1b0e646ff3cfe3a13af183698ac5adde3d95da5782bbdd67162dd6a9794cb5e9eac4798cffe32737d72e6f821a3b98c35e30cdf811755cd0c9670b37fc6bb6fec27f00592af15cf977596e498be07505aa981efd17ad8abbcdfd153e5ae7f9692cdde802d563d033130673263c3bac44803cf2397f")}
          responder-keys {:static-public-key (core/hex-str->big-int "37920f0daead61ff92f8371810855a75987be2823953dc9f87f21b3e6d89b89551a988976dee8f7cf7a024371508b62604d7d8640e9b2ac29d4a8bca1be33fda08349d950efb712e992926a11d44ae9b651048ecfb541aa471f7d9334ac80c76d6e9cddfdd95a35a07d546425bc91e74b51cb2c7a723e1854399ae329be369919f5ce7b72dd36b30d03ca32182eb270f0fe920b5bd432c1eb44e59a3668630a721bf06b60d3f4ef5a1710fc98011c4f2dd989473cd74b5170902ec4d69d7363ed5b6a31a369a818ac96f87cb01a0afcb102f331d49cf4b690a1b03338dd0c09ba1f8cb6a01bf2659e9cb6463c857af08d6d2ba7cb7f221947d617c0a31f50040")
                          :ephemeral-public-key (core/hex-str->big-int "9c4fa22e7ab0a09a13210fc956092d4b3d5f87d291a861c166a162bdb02a82dcb288240ba433d2291965706068749c7861f14b2d1c957b9be2728d7a30032baa3cab0a584cfff236ccb44f088209b8fdd15fa7cca70dcfcc0495b75c943633a16757b802447ac4e4890c7e97ad75af3310c96575331fa17bd142abcfd624563ff04c9dc52b8c216cedfa69d93cf4b18058d1e4b0cd22cddbb7686805ffa48b1a35b20be6171b9f8ac573c6d07191c101c12e7ccbf8346e6c6f7497f128a3093b7ce01c600ed358a4bd1ce8dfe5c3f9fca97db4f9e95659e15f8bae8c798fb4d2147b95e90f0901a535737135eab7234a43be8e10cf571a2a4c065e26171d3c91")}
          Z :bottom
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "030a001735dfd21690f3b4e6152d511471a590949c492bfafef58ac7")
                          :static-public-key (core/hex-str->big-int "b8da8de8292163c2cf54a50a3f82856cb2ef81bd8bc7f7d3c0cb103333a3290082dc022f90e45fd636843350001b6d80c4ec58cccda903ab92d34d1677e534d4234ee687232ffa2dd74c337558d4fcd2cf8ef8a109f892f26ea6bee61b1e282a6a95f2b300c97107e3fe81059d4415288e656e67ca9162436bdb0ed44260636fba0e89be7256786fc364dcf6835d13fffc933ea190addb53ebdb583b512b44dfa2a77cdcd84e17e86cda92ea3978fb0b3796ee886be5292fe4e9a1cebabf71795fa98e8f20ffba175fc9d7a6ac4190bc8d6488eb6e857c2082993fd474a67732971c636083ed129f192e5b61dc88c8aa5a5995967b7093c5563295740055af08")
                          :ephemeral-private-key (core/hex-str->big-int "2c02d3f62ef4a0cd7cc247d936d51772d739b96aacedcdcac537597f")
                          :ephemeral-public-key (core/hex-str->big-int "b980ab08317c880b475afc5a0373e70e207283c02a9d9a46f94cbc2700f92279d3679a0d3347af0d291465d897513ec1d4c0539a6fc221864c137a55d5d1fd6cd4d41787de797f8a5037056cacb8365aff56758d3dfcdceace005210dcb4bd7f4a8a291ba7096b9bc0d465b9cbdbcf8b00b017419f3aafea3d91575f961e4b7768d062de67d4d9147ad40ec630111642e50f733a89b5cc7b2c147ab7cc9f33b67c360c8efa1ac88d6d0137dd301c50bc1a5e080c38c787d52a20a4877eb5abe776ec905f528d48ccd3e9f6e67f6c00be357c74045265455f417ac4b800962ab1ddf5a2bf702cc06b0a3f5faa95eb545956ae5b2385191c8a9cb7185f87a5fa31")}
          responder-keys {:static-public-key (core/hex-str->big-int "99d4b71fa8fd512d3c6f9b0ed819c9a2b01987a40186e0b905356f196bc54095209ec6ff6c67744e50c87cc9bc61579bd404fb8094798b49d233cde388a39a52e37861bf3dc60639e43baaa55f275f1ee9bb7db4700866fe7390a2a444400507a3ba2c6c5d177b5bb666bd7018a58d40ce2a32d5a66bd89f78438e6b3ad006f740d3b514d9d131ecd1ecb4322987288c703dd5e136e61c317b133f5a30cae67ef9dae692edb0d18158e48bfa29a67b60de7eb85ee8d70d316ead749b6064954495a6e6bd7d24b8b419bc11a159ea93600c43d904f037c5092fbbf586fbe3037dcfd18b92c9f5e4a0b90ef0d2a9e579b094a26b5198eca74b109fe60388e8b4f5")
                          :ephemeral-public-key (core/hex-str->big-int "93193e14e6bd6d58cef96929cd31fa173193e148d0117e89cfd361c14a9c96329dbf972f7b1cb09e2b82478375489827129424bb9935adced8028a2067dc1beb458367280d07ba9698894cc90daed49b012284de7df350a7de093b133bbff3dfd4b4abaf00c462748027b7ba72e46cf4b3ffb4c3913f4a8bf8c33e47082ec9a6027d1b63487a658181daa432c4280f3d18e526bdff0e8745a1766cc51d0c70d1fe5bf9530b9226543dbbdadddd946e2281078340537b9266e70b6cf61eece75fe75af0ac7703b292cb50c57d11c76206ef28cac60a0457a05b9c306ee83523e8db612ccfc56f6c2998278b16a60729d13aa090ca0a7dd420225ab66fbb089ea5")}
          Z "a7f8d773c7a435bda245f4d3e3660569afc19cc1b85b26a81545995e5e63535085e7486b328176475598f7e5e1e02dac9bca4a7575637d2c32e17f479839b5ecfa0f64edb11003b388ac1b760fea29a57b6f1f6a743d6df0e19946188fed37b4206888565a9b3c2d82065275ddcacf5e9c2625d7db6080132eec701cf60dfccb42282f7e51859e631b1108899cf0b283680cdc84c0d0d892fade6cfc772c245183e0c83e6f0856b10163a49c3b0416f1948d92f3e3a627b6ae021a6708d02fd3d00f048a1e59e7de5cf68ead17dd0d494aac280ebfb9c4c3b5ffc0b8dbcdeec9e47b2d28134711357b02f773e3ad7309a4485d1a40e0af9e3d4744b18f9c4c61"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "b8182576e05ce855eab00fec792b6be7fc8f43b1dbc5c73d773b4459")
                          :static-public-key (core/hex-str->big-int "0cd5ee2427f8ebe94919258bedadccd28d1e0e7f825890e77376f67b28dd96f215f48820da6ea49cac18ade202d4ba16aa1a6d758d332f1e1b03edefb418416d791d8393abf42bc3d46c4cccb8bd5dad255b78dc10dfbd35516dad1cde628b1fd3883748e83b110390dba40251b133354e3622369a0f2a800983790be4cad4fca84c9c196c41dffe4297315e2f5d18975981786e06a6376b941e01c615aa6d35601834f4244df1ab0da703ce070fb0ce34c1503e36149a7a7b18f4b52741c4917b0d90185fb858b68835d11a306a3e4c09e4f80a777b396af9d017d6e02df6d0e2734d1b58bdfeaec1d6ea850e2ba49023f2c4878ad8ed3cdcfea94162480fc4")
                          :ephemeral-private-key (core/hex-str->big-int "3c68f84cedea473bae1eac16d2fa36931159dcfaf3f7da297cc8f823")
                          :ephemeral-public-key (core/hex-str->big-int "1d42c5d0aba31eaa7b3d5b3d4b639d66187cf5a348f6c36408ce951615893adb1a433fb3412d513dbd041d080a47a593857aa44c91b2b0761379191bb89c8698c077d2fa5eb1940754e4f809558da794e790ec26ef892c6973f88afa2fec4c071289532d7cc77dc45a8ac20a03dcd3f8e3957083ab7123066a2450f98d6b31887591f08396ab7871768e4679602c1c3ad02be2951745b0f0d5bad6daf31de879c2e11cad886cdadab52295c47cbdce2ef7760b44d95e8d5bee9ce66215cd426c59a29b184bc734a8327b41666b7a74d8522c3598135341e24234550e3385894822f5c16433d5ab612af90e6f23da7b22f8b38a0b078e6703db2b34638eb97bfe")}
          responder-keys {:static-public-key (core/hex-str->big-int "2450ca2da653a135b703c8ca0994fa5211cd207f517153bf4bc334a67d4db986476771b6d8a1aef9ce3b1ed2e3856568b3bd7e77bb25e7353fd901f0aea6b54ed6f99846028328dc265540875151dd7deba6807ca54d7976539abb6faf85dd84a9069efe80a728c77f85cd78e1d8407a1fe7fc10ff08ad91c9b5b258781d7c8e9e198039506e0e7baa03d741a019af29de1e744a1f54bcc5f2aff3f0c7b94d80064f6b33c68dbd21194f4dc5e1faf9b8b7c8776803fc8d938d4731f5f647c7320cd55b89becc4baa275f3c0e5199f47cc17cb744552bf4a269e8bd1263228363ad97a8b5f0565998f9ea51c12c9bcad7e57a0afde22a08ed4e84e610f9df2ae9")
                          :ephemeral-public-key (core/hex-str->big-int "8c517a2e7728c315c1b7c7cb0c371e043b8270638ce564b1fbd117419fc38b19579090b8b80a8cac0e0ac687438206b096d1985a559b52370fd0b2de04f3c24a887599560dab9297f6889d1d57709a8e3d091cc0d61921198b434bd552c7c82185f1defaaed4adf84a908932411c767e923f7caa7e26e45d945a0ce369cf7eaa394f61a04fef82bc2b4234a924b3f975cdf0d903e0fbe5ad868482427e39b16be0bc498502ada709e7c9afc1fd08fb184f19c8eb94be49d0b2bb164d56546a38a74429fe634291ebfefc1c5bd65434cabf9d8d6f540de8aa8d56680fb3a2e04f8084e1e8a76be2f1b191f541c27a24615f15cef5534027a7d88030acdd4161c7")}
          Z "653af1147d6096699df036d7145a8a5352aaebca4de73b88e6471881dbe5d397c9d4677438d350abdc13be8c650d99e2dcefe81b7709e93234b6be90ae93c09047504f2506750e0022b7cdf9e76683f7540d7e9f3bd31e95aba16db01c165719add607684af16af5f589fe6580181cc17391815a83c4b33fb0ee2a35ae2b2caae7f9d1a58194c898f2b156d49013994f20187c9c1a32e4e91cce405795f2a42da589440d949c976c6f6d8e1b6a91a6ec72cd96513ca0d085cf3ab06b6b5491b898487e0d240761ab009f1e49bb9b4d0792b89af5aa111198777bab83f1c8b08c7de7c5ea516c502622b3e52f1b9b400639aa66c6a4a8f26573c3add2f68131d6"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "3ce7ee53e06180e3ccb86cddd9069b80a8e1cef66e125019e7cbcdb5")
                          :static-public-key (core/hex-str->big-int "4147be90c923152afe6ad86b8c39699a1ba17fae7a74ceaaeb74a27e3e0980eb2f9922205852eab3def394171362a9ee9b7960204c73476ff33aecaf9d4270c56686ae2d7b5a061e48529a212b48e8cd732c50d918fb6964b763d7d45ba3ec8f504d453a0bd9dae01c9e65d02a642a53418f349e02c79e8dc5b64aebe62053c6aba079cdeaa74acce4572b67fd122ede294e24df0ab194cd51a5e631ecb5640e59d5252bba2647e6197bd7661163e7bcf3864ce99bff675e64548f46c7a089fff030de60e92bb6b7f1fb998a4d46c81e0a7c21e6b33b693c28c42ae6c4db0092dced2e497d520a91d6d6608a0e768282070ba167241c2765c0ea2d7c908c80e3")
                          :ephemeral-private-key (core/hex-str->big-int "88e48d8a90d7070f3e7aa838ea86cfe0eb86582146692951f2e0e1e8")
                          :ephemeral-public-key (core/hex-str->big-int "506eb051554d71ada0f2b77669ffc64a88c38318ba183ed278b98c1924537189dd7ca36a1d8c3ff3fe9edb5faf76a73f85c967e89ed6b00f278c1051d4c42f7c04a4ff6541e50b8752f28ca3bf16e4b3e60e1d185b2f634d251e6a023c49ef314ef8c2b5b310642aca96b0c46ca8a55d2e0e9931731727b25eea354abc439bc039f2ca66274f61365c3f981fb06dadee73d4b172025905d29acc7121eafa4d35be3075821e087a34eac30931cd2706cf4904dfc3ebcb39e6ab918ef0dfe987520c61f8dc76da0ae3ca7db45eccd1c5a3fc59006b13ea5fe2d311987f822fe1e81f13203f5c1d1e11bb78ed48bd60259add0de7069d16c0add732890ab244ec7d")}
          responder-keys {:static-public-key (core/hex-str->big-int "08cc030cf9dec5eaa0966e8eb723387d88d621623b75f1d46ab7a5f659531260f1759c497d6c2c00c87c1f081e2486f9ef344a19e8f80191955dfbf49946ce8620b879ab9aef08f6e00fd1ac53bc31150a0518c815f8f8138799879f775a090574dd567fd29350500352b7411dd115219ad88b926adcde7797ca7e1778ebb5473651a3614100250a60f8f69a74420f303cbe0485b91524c6e9ce425438115113b6ab6c43c935a19cc1459b17cf7be7643832c8d143fa349b5a6fe451d3dd21fa1b6429e9f4d4fba38c403c9e7dfe3092ffe568cee0f8f044ab8b054f7fbb11b0b784974a365f1e75275d37ae2e68e355cc0158922ae13b95c12dba951b8d555c")
                          :ephemeral-public-key (core/hex-str->big-int "3e7470e02e16b8d6f9909937e8024ddfad5b5fed5e244f2c44deba3069a9ff0bcd2ebf8b94c63963f360db53d6e07ca9cd5dfc401f82720a13f6a26bca12710dd718d1978c8c2ac039cf29d30a5e29359242a0b204538016d738ee2120ad0fbb8284d633a6557b1545486f906cf92dbfb11671f5830d770d473371d4101bd33fe9ea3c298f8cc2dc554a808b51c52b637f23f584c5c2df493768307d2e59ca40f9567bf5e3f8001b21f9bbd50d12b2f477859d6d1ff01cf0aa746cf7d608603c44072b0389f2cb0da01bfbc6e994f334273dd0d844cf9e06315b1ccb5f530759330ba18a9dc3deb101f4c6fb1f1d6e9faddc5d12ac4a81543268d9f14317c7e2")}
          Z "0c7160af497149ba880a2ab5b090fcf590cf0bd33e6ba1d190665322a67bcd08718216391f2437a4bc6a110d2e51c1866fbfd7c4b3af8e666ff15c10539d83aace757254770b7b411d132383fda79336af1db18604915a1593f31275923ef57057704d1ef64b46cdfa1b88abf77d493cc64ef205d6ce7508560646ee4b6922840660e74994994c8e64dd32a54e351a218fac5f6dcca49ce6d35310222372e8f606712583be2795abd4c6e924da6b4b1af95ab31116879fee06cf8db86ce2fd7e12f0b17ef09749264e2cde976ebf699eb06dea802c84c24b7c1ca1beb9f08513f8180d2322e752cf6f612331004c3f16fafd0d2cde54c03533c052787a6d8999"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "a0fe1edd4fe3b3b4d36c61b3955f0e52f6c682558a8a967804901da0")
                          :static-public-key (core/hex-str->big-int "ab9eb394d8b328094daf78943a29473ce7a5c6dcd9f047b244238c1c36e3c94eb5931eb71171cb576a8de0c8fabaeacd72a724c3f742b84cbd8a11745111f9329ae685689f68f441109136245a137c3d5594ad9c63dce2e3d55bb782c963f683ad4a9b4d98c6c4490a4b646cf6aa5af3171c516925fc60549768b37082a3b14b46be427e70fb0d452bb0a6cf1e79d96fdf7161a528358f3a10f3bd354eda558fc6754980d8ef0c2749234251938216863bdea4eb3c70528c433a997efd6105083ee707652c7754b485fb7388d1be01352fe5d68e583843931b66cbfad20762528af2b0a52359950a124eb4cce3d23b95baa0fe92ea6d4cb1af6f197caa10ab33")
                          :ephemeral-private-key (core/hex-str->big-int "d57b1e21870d54473c9d0d51615e3a1eb481cf1b45e5ab6e4ca43710")
                          :ephemeral-public-key (core/hex-str->big-int "18560f3f6d76650fec3f99147f5986d84fb946488a0c4bb8d05d7b3e4d8f8a669f6a1ba11af5e708d392a5657b00463bf318b3f64bfe72452ac33a3f2057929190e583a8f779f2bcc0cf65b630c627ffd173bc0750e4f7de5fbebffe86baf143500e97e2cb154c9a7904a7ab50e460144c40305cb55c4a491f4c7ad132a6369b3c9678d3eb9959c2789f6d368f19bd60db1b8a7c4691492f8bf89e2c20195066fd56adbb01a6ce8bb034793abf20802ed5b64bd209d37940a44e1b70f13f486b7145c888c01123139fed0928b28d59ccf2c7ac72fd91ddfb7c376ce1873d5e8171d9a6ca99fef0b951b8dd8cd982c3ed53335cd0cdeadaafb8393557a4990989")}
          responder-keys {:static-public-key (core/hex-str->big-int "9965c9f8c709d792a207a180fb4a3069c482c63abaa26edf923aa121acab32232501bb817ca9c01223912ccd68d110d233e4151964ea6fb52ba3d92c7506342981da23510dfdecc33fb9e8a1e855d87b50361439b66f590ca78a0113190c61d37cee4b03ac30649b01d6bffbdfe1c3fac09dd83db64abc6012ca5445659da6a10d759f80fe2bf4d9e2c9ee1d8e2647718e4853dbb0c7bf7a58b4dc90c9eefa54f10501912abfe6728dfb9772a63070d259e7ebfd0d9a3b6a6e820bdbaf6cd5dd456941c944d5d63932ca23cbb5fac2ab4fd4e23a0e402cc6633876544427123861dfed6980c8b27c2c081725be6b1c886a58d99191d3102df7bfea53b5fbdc77")
                          :ephemeral-public-key (core/hex-str->big-int "0b9d170dff70f3fa05de42dc6d306df592e75c4e96c2ebda5a596fe6a56cf46de23ea26d06610e0be58295aaae41e218039a62f4ae70f5687baf8bb8f5472bce2bc5a3554a691e11ca7732302d5522f38673819c7efaecf070c87ceb7c375efdceedf3c266d68947f7dc9c6d72b6242de1fc524af0ea6738a80b843a3c02898884e353e6d0898583462591a608db2f1ef444f96a072f9bb1511b33f6f82b99a46f5873075054b0c71063e8f0fc6b549f4a70144e7785c60abc827854281cf0747420325f721d73056fd1cbffaf03b718e49ea9b7217729a58dbedfe5586621f8193f2d28aec570fb9c25acd57a0b7c66d5ef32ed52dcc4ed917e1b3c6eadd4d2")}
          Z :bottom
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "f2c566ee526512dd669b75a74b60e9ec87964f52e805ee3bb1a70181")
                          :static-public-key (core/hex-str->big-int "245d234940ea46a3bdad3a01f5665f027224b2e70964d85d8446fdc37efa0eb3dc8020b9c186a0c756701f76f8d65ed71f811c7d669d796399a5b458954fa438384d550a9b8f124790fbbd54223fbfb04e0b9d4178e2332e5feab735e29968dce508cfddf85d36f4dc6f267061e932a5d2bc48eabcae6924f44f8a4a3fe4e6cd347132320d3fe19580fb65cade9071ea2225e146aae5b9e8d9c8aedb303a40d56daccd8ea7309adb943338585de714ce458d4116be18daab27d8752d30edbdb0690d8fbd884614f412bc0d649161989689d646773da8083fba42cfb271308abf53683285ebf04288c8556728da3784822d788d9fe1d47eabe5f2812f29a57932")
                          :ephemeral-private-key (core/hex-str->big-int "bb54899346260917d38eb56a6f1901214fe0bd7edd19e10446b8d2ed")
                          :ephemeral-public-key (core/hex-str->big-int "56f9fe3126a77e7eeeb8f1e3dc7db0496a20244dae6407c608bc737c17380d120c199a0774c826cff765cfea3ec4437bd9dbe382561a38adb81015c54dc06b5b96dc60487fa04741301962d6426fac37b52293bca93b248802e785680190b3d9d9c38a203baee922ab65e1a43ac71c8ebca6f66c4ddb67ccefe316bd92be1fb6a4400d84e724b48e3c5e58a27abceed2177edb55be3e3f85a409eb84a9ab7a66391f4d1b2ca074fe1bd56b769d65269ac6a6e1e0b76802e02e0792068d0d4da1c4e5aee471de8e7008066d7a15445464c6af82cb56634012001612a43eca0df0ceaef3d03382230b821ee7cce6f8f4fc14664896631cebf9d51b1d0594ea3b88")}
          responder-keys {:static-public-key (core/hex-str->big-int "2d0b6332fcd17c236d12f855b197571d4f4bc4f19df15e34bae9f5076856c992007f724b4ac0974c33cffa3be7580525ce69dcccc0b75becda89cdc3d7bb23d116fcb84b47b267378c7c023c18a6f74f1aa4ec6fcc00851bcb8b7ebfc2c1b78802e159db5c9d8f3e2cbb036f93bf0751236675a506131026f43306de798aa17f089c03e3462f58578448145c76a23b0279180c017b5f169df4007753b37743570266ac2ceca7b6a34f9b67428560d19a18d34b20269cdb9719c3cf8d306e7e69f5fee575c3e6ccbf0fb40800f30a0977ba1dae30c42b4a92aa1d5a7eaebbec707ca9ca83f95dc01005ed8fdd2b3600e510bfee39aa29ad3ac55938a8a5c8c389")
                          :ephemeral-public-key (core/hex-str->big-int "3765101f7d4aad5cb91e850e04a4c20816fdfc05a4a496f4a189510aa940fafc4d40a5201cbd6fc030f96ee7ae3e9eb774f408680e91f639d620b84953c1c40cc18e99f7bcda140feca293bbb2dd9e6a016974e20e5a86d77625e3468103970d55d490511b989c93b5fe09f6adb671bde5274a5d173ec352ae998061569028456855967967b8944d2c13a2a4b3d540510127bfaf3602905d3f6758701ae2481e03f1d5f1ca076c23407d8c672dafcd2f524d6458d4946c5ce8534fb594a6723342ae37ccffcffacb09f0f7fd0a44e1c4a1246b0ca424d11913eab52fc62f2e73eea9423f61aa2093b512ca46bd179ce4b8a9061df00280960c54a1fbf608a9a6")}
          Z "39f0b2e6729905da96fd25de02c7c63c9658bf68ddafadad0792f6c28df7c3a079826d4d1df4d8314ed303f276207703c706bec298fafb54077cc46a8a1245bd8248185855585131bc384be7d9880d624bcccc59756a77d40fff22a5d6e6543fc8ae1b34dc5401a8542548704eeb35796fe9ba45d84ff4af0cd042b3ad01e49f6ced1a5dcd0074248018d6783c809ec47d260dafed9ce2413bf13d9cd542a493208fc672feaf8ceda30385c7e13fcb86de2b49aed42846686ecc3e9851ad23026dace5755c4a10cd46880894371f8121162b15e9d904248584eee3fb9164d11502422929211c0035112ac2500483ab6cd61037475ec597af0af93e3c48571a13"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "c78d7f8a80150aca62679d9e3899d7dcbcddb6c6b42498335f53b209")
                          :static-public-key (core/hex-str->big-int "93859692a5ad5779edaa075ae2e7a08c5f2b11a71140579a870087356deb6d61f15ce2166ca2eec363c362e06f8bf1b5cb10d6b0a24de94e1569da699cd38d7d52e7fe073704edd02d885ae8aef0bbe19fb47d91b64d93ca2b8697d94c3369d09b380e1d486e73a043dbe5d5410363e04e1592ea4eed559764958df9878ef55bedc0d58621a82b40255b53a3e70c5d8bdff5af14c506ee57620be7ddce86ef7e72f3ee5c6f9b33ccc2a4fe6ee99ce8305b0a4886050d5522ad23bebafa83cf1eee5dfba322e7a71a3ee8f7877433c177195881b2251e61f476ae699bc7216bc93ab4fd94110cbcae7bc8fcfc673231de6ecc5c612791a3f589c049f0476117cf")
                          :ephemeral-private-key (core/hex-str->big-int "913bdda31e10fd6180c7133926343dda9b59d9cc98c361a182122cdd")
                          :ephemeral-public-key (core/hex-str->big-int "b80e22131b01dc8ad0caf909d149802fd3f5a7b94caa76b34a868bd17d63396a1d3cd45c881c4b2251bcc0ed95b9d11961d5282eafdcccc4e73c878a2730bd71e377172ed87dbb16319966d7664b1141c3d4316e26f4971d75301ad7d7899a4794aaab3ace16c31b2a527f52e88383a577eed121889cc481360e68ce309795fdaa4a1f278b6c083c96c3c6caedaad9576ae411ae747e59d9207c9279c699b57fc95094925ad812874147bb5825ad74b8437074101f553d6ebb1d85bc1259cb60f9f52dbe2385d660c6a52a347751a638bbfb1662a387f3f57f613b60f44890b6d08ee82ddf20d9b59071f5a1a1eb99651c9661303b55826f4c3c0ed3e0bf2c41")}
          responder-keys {:static-public-key (core/hex-str->big-int "8776d0a968cd99cdf76d34eaae08cd9beea387b6cc5e249bdccc1d7fd517b7e080e7208e1278ef5c0fbcdd48d0c75eb8be9beab3ec6f6abf2713db6f36cd854614d9bdea8532f9cc62d9f421fb25c980ff6a4996989c1332615c590ca30ec378f1d1ed746762afa4cb5e99113d176edb81f7bb8a45c31ef3136feeabaaac539848442616572ae757c8518d5f40a1ff414b1f4f7121eb8f9666cd64f5ae1832355add7bcaa499e168ff87ae551213830387e4891f2f42b1e4ca680297f0ee4abd8fccb8bfebddc1b706c0d181a6e35304698936eca683027b7c00ba360af9ed6fb5a75e376defd4b14f1f1f8577722f054bcc4bc4289c5ae15d62dbc0fe26022e")
                          :ephemeral-public-key (core/hex-str->big-int "8edbbfd126de764e57d72e36ea932b76a8cd6d14cbb1d264ee6cff52c133d9d93449ff0257a9a53a8a2a9324425c89a3d0ef56506b86dc3a80fc57bf85350cf5954430466ca7941540329bef879c43714946c5e01436fc778289f5bbf109adfc509b2bff503f24bd2880b8617a99336c83f985a8bcc96b1d33df20c224614e1a18996ebf221e8a0764a77a83f999b9c5c7aff39bce82f8687c16ca93b1c54a127c1f76fc5cd4a986226cf35a0c6ea39b473572b6f946dc9fb0b7fad40859e6ea6ed604843327061bcd24a194397fd842eb192ac2bf9a361a0027a0a9ae4621d4f3c0db26dfa42b40eeff0434c1f39ca2141c0ce8237abf4bc674a7dbeb1a6f33")}
          Z "718931dfc7c6945d41afc67eafaddc9e41d97fa5b53e0ac242b4b867120efb8fa07c29e13a16cc86c8ca2aa306442a345c9fa22437177217e6a6542468ff8f1dfb070835d5347a14338bc298642e47908216bf2babba1f17a4dcbe17ff1df5c69ae74c25281d2ead24e8a965910efabd6325ba210fb65add79f4298208c04d28ece066ce8fad5f600e03c313fc94c5f885cc4ebcd35b93d4302b11b245de35f7636c37f9dc3a933e130771fe57b7a900a53276d40c2c8914b30775f9bd9f84f052672c18168f39c19005943e46557d5ce4c2a4de943737e1f6b98b93e203b512e07b63f770a58807602a3807b1085ef56ba4c2a0229eaf75cda7328421a69b5f"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-private-key (core/hex-str->big-int "4fd8d148c51a373656647fb41ea374929be6e4252971bfc40e02c3b0")
                          :static-public-key (core/hex-str->big-int "190348ec963ea4df40d12dc1fb488edcb70e93aa828dc2e2fb70e5cd1d84e8dd526394a530aa7e20105d7872b3dc35a13c4b98c7b453b1a7d8dd5df42aac2e014fd4f0941fce28c744d5518a71b0be2eb343def74ce2fbd68d143947c369d5ed4b8cf536ba2f213aa242239702effabc5ef714758614577ba894c4d4f400a541583143e6a4d7d094f9f3ef695daca740b6f7730742fb619128e1f9fd79ad90b3495b264632dc99bc1cd2acd8103917ee9688b007e25548d0e76f48526eb88ac5da83435135a79148d6ffda877b7f20c46306b10e7607f34bb86e8988252d94699e02366f5a94a9d9d41ef15b3eb07d2303ef9e7ddd412afdccd2bfb0dbbae07e")
                          :ephemeral-private-key (core/hex-str->big-int "31677b46dc55c0b0aa81861a05c59ede867f446e5d7d67beaf38cb22")
                          :ephemeral-public-key (core/hex-str->big-int "927010a999949ac35f85cd34993332acceed93100087315512e75a96483ec7da1be6b3d23c028c9b676ce1301f8776d3a1864a79cb5ff2dbf70eebc26fa07c6232ea30651e55fdd5c0cada68799066bb8352184600cbc0ffb2002f39613b5afc18a8dba6df95d3670886b6eecefd8f4554624d6e9ec464e9531d892bf6a3e2080c4c4cf9d88eebcf5ce0245e3259a520a9f28b7a288a1ddc2c9779e9c72147b99939e2bc04bf304a5253dc79a66b28e9ed123f34b145f695eaef2a3dbb0251a7fa68923309e0c80d18ee83171eb298606eceaddae1ea8a439921f41e8132d69bc3afd2744cfd80fc592f0380e97f354426b211183501d97c81a97f48be76cac8")}
          responder-keys {:static-public-key (core/hex-str->big-int "2b7dbfe6c6241e7c89f2975355a2fd0534131ae409594502ade21af187f28d5c5a223768ecbab5f1e6fbb38ea6c923b5b9f3ef271cab45dfc624a384809bc086dc1803179ba9393ff5c3929e7562cf7489885a520adeee54a597fc28fed6b667b7563476b8dd9b402aaf3887594d18f6702ba2d379c1c2f37ac8c8123f38002ed3476618611d45efaeaa05532ab9f32e8b1420fb00b8ec51a4835e2b92c44beb7fb0becc9e8f3761092014574dcf6e85b2700641994286f0859ff7235690a7abbb6d3b00880b78278af497b5a4e31876a3304e32ae1c6282a1cdfc075fd3649b9bf7ff97b49bbcdb6b887a8a15ad9ec98cee058e6489851ebf81ab9b5e4743c9")
                          :ephemeral-public-key (core/hex-str->big-int "7c7a9d531f237f48e50e608855d2e3e6e32d714881215ab4719572026ac79f0aa55b08270fba8f5e9f0391b06a034cb2079054b76570ce469258930570db3140218eea2d6372d09fd8ffb5651e0c75c2af4e201853831a5bd54dc5dfb375ba58cf75239b2b1884c3bb4c19cea7d905c3b621610b213c9b8d3800f4eb1a9ac979b1727be202b5ee83fd499ea0e29424d13a2fc727e4f8f86ff5883921b9ffde7158b9ee3e2539ca450549437fe793bc9e8acf64e19e7316fecdfb64d6a90721846feca77f19a7e658a23d6ccd6eb76d82491ff50392fe587ed9c8256ef29250517762e6ff5c7a7e56915643f91db6778342fdcdcbefbfad9bbb6ffface88b58d5")}
          Z "34e20bc9872113df432219b0c36abea6c4d808f8568bed164f97c5342494d93a492f62a4d6d436c25e836c523e8ad92effd603c8789675e1c075945f89fd393ebe12e0208f1ff4eef8a5d490956b9d8472bff536928b1495818b32076ec6aa539b22504c145d211529266ba88affa91b6cc4393ef096ede18266c3655eabd975a512ddbcb7acfc9b2abdf9379ec40c0040f563359e001c7f2712e2a9d01bb0d2580bc2221d99f118ec090facd1a0bea2f1c6fd76bd7aef8a3736cfa13ec1b5a5020d6c6c9eb7c726bdb45337dcc9261b66aea91f888281b3ace8d4d0868b944403b2357f6e4407357b97af952c37324e6692e60fad831ccce0690b750ea8e29b"
          result (core/agreement :mqv2 :init domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))))

(deftest ffcmqv2-nokc-zzonly-resp-1-test
  (let [domain-parameters
        {:p (core/hex-str->big-int "a9f1c70bcd0ec0f60c58d6fc6460e60e95248c7a5d354740c3740e8035edcee8bcbb1e8916017c21a57a121e6ef08793f7b19d8ef8c59449348e47c74d86876a34c37f5c2b78b58cd868a1a2eb54e00e1479e589a0d0ea9e778b3769b9a9927afa6f64605fd7691f450e8dbbf11c4c2312fa1e3ba2edb3381a529a7eec45e1c5c9471d9a175392787dad34bc6cbdff4db504eb107e17d74f8b37ca5cf6b1dde781ee65d3a44515ae386441dd8d03e73341c11ab4a19b880c3afb495a58515191a21827186beb198c672b84624a2ff93bd54491e7e5657286e9a1ea6f35c8baabbd6e41408d8c9504442292f51cf73ce0a56455d6d7e87db3fb572c8933e92015")
         :q (core/hex-str->big-int "dac27e8ae2ec5563163692f34e2d30974e36e95a4635b30bb6076b51")
         :g (core/hex-str->big-int "69d6152dee53b4692de7436bc942ee844196389b55e698750b97e06b2c245f77cef56345fb87467c988cef79730e465fcaff4fd7cc3d74974fff33dbc3f7366d7c7a44caa17e478312ad17c5de7bbe7bea536a1dea1741464f6e7eb3bb8186d1e5a378839e8a4b60a20f8d7c65c246ab6402f69f91eee57cc18a62be96bc94ababc030bd1af13fc2d54398e8841a940f47c39ce5325b10f782dc9a7048353179d5beec91e28e6be178235e1d39bcd6e8bf78ff73490f7113f0f7a51b5d39b6c0339a359ea1008803501f27b6ce5919e180bcb13ae0586bc2fec02151dcf349f81e0cef8e3ec6edf22372bd23e8ab35b433a98ccc9791b35d2efa55c38276ac31")}]

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "5ece1af258f7af0ca69eff8a7fddceddcdabf91b9fca4b7cf0d622912a224299457ea043a5f959cbd2f937375c979a5fd3f4c63e8d838c538e4431f45449e82af5a01486f9e352be1313525d80a71828ba1272cbc9d33e8e004c34892002bfc7d39319f9a82eb448ba936c299d02f524fed874d2143782965612ab6f90749dee658de9bc3e546fa8d7edaeff6b7093876dd50ac69222d4001854696af5293c77c5ccbda3f7dcee2164af8dc2fa9b119fa9a540395cdcdaac40665491332504aba8ff2c1e7f27b9fe44ad85e218acd7c4d4ccb6b1230819968edfd9314cf62373e60a0ef738ae3c9afcae36a537136b304a776660f36fde3c49de87d40da1b7f1")
                          :ephemeral-public-key (core/hex-str->big-int "58df71b5052041c56756bb0b2cde1bc521be00dd29a1708e3f0e38f6a95136f5cca5da0aebdcc86f9c4f3b463e2354f861e4b9cc4a72932c52dfc4e5414c959958f42280feb2e52f9e376175683821a2de53659b034158ed3992942b7b0821b21d4c7abb0b60129791cee9f9dcae0a65a521aca4b63a35967a34ffe54beee9a4a50d79512e3637f14acd559c1592f6129f2aa74fa6cff5d0b4528d8e4fb16a0ff350340b34739fa4193c491d4db5f2228d0afc9244efbd6a96023a7ff66c68e533b4a2115db6178073b786813a6ce10b3498ee5ea745b1d747e6a9be76e64884595046ec8d25a5462ff34aede7621390cf4532cd0670c933749d91cb3a6778a6")}
          responder-keys {:static-private-key (core/hex-str->big-int "8fd898848fb7e1b211b729287ea418399f28b4c529a05502e3f204f5")
                          :static-public-key (core/hex-str->big-int "4b82dbc91f48fa138c70b3584d060e545d1ad051af8a4e07ee591abb3699236dd6ae0b69331d759fdb843fce8058aab037e09c2889d7e9c79d5d3323798e73e824153d9e3c4770528b264de4a6aadf9df5353a1ee6b7967c91ac04ee47f6133130a71e517cb71e8b793a8370b60f51e3891f82e5a4a7537e1e926e7c197a139f2db9a8309c0ac1b18638fd29c77043a23fc3ab6ff2a19ae7a65ce54bc4266932cdf8e4887edfb91e17477ee26f79b10f6ab1519e61f9382b6d73996acb8fa5e601c4ab16944cd8861cf645d57a594e00de98e6893d8442a8e9b8e2025103cb51babe49fa0750a33bc6de280a3816b4105d4976d23b07951f3a058074adf12a47")
                          :ephemeral-private-key (core/hex-str->big-int "034f1fd01118f93d7029bfc91a9c72456d5ee00c9095a3d0b49dbee8")
                          :ephemeral-public-key (core/hex-str->big-int "a91dbde163eb53e039d0fe3a97a1f1f9ea5b7161a4b6d9a87e2c72071469f34341d5a714f8ec282377fab0eeab3e164718fe1cead956aabe858a8f16ca518026726c67a286243a555c42994e1cedce43573887f9573265ab74cac5d05d8c6af59e11724cfe9ede70d8f07f6f74fbe774653c043d314f7dc64c271cf222e6b931a623d452200681d06a6b2d52b99f6dc0c624eec935a970048e5c3322f659aab8752cbc60940ec8392aa1b1d7477eebdc15eb1df8632377c1c4b438a2105989b79e525f4d0b88f5c7807387a5379ed7b9c95a1d4b54bbb0a9867206750c584322aa1a926969d1ba12ccc36dd0992f94759a4e05f61f47ae1e855fdce13c675fad")}
          Z "0835b9558a90d9cb68ecf5834c701439c62f66bdcfd5cd45047e60cd646f2aec5da3b254789eb7be2ea9ca8eda1078dedee0d8b7bf502153826c6e1455b6ae377c0ca98fea83ebb03222f4a9b7298363d14c3603b5bc4822b742ef8c4e07e58df2a626ad3f3e98d9120dfa4eb9cf28d940992ce3f99fb99e50d8c352a90a0795460c563b6af5498603eba3b75729444d8f9f18e50c13b951f616d36f913e3a273250d67463de16a84c8f34442f1400a786167b202d78ec3898dde6dc9142c1b0f57e8c6c14b096c71b94c7299d47ff7c105241b61e14ef5722b2f67906125a6dcca89d26a6fb235c3e2b29d43d1fe493dfa5ea592335ccdc250e2ddbde2874cd"
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "a56522014afd257c20920b11f8271c99cd085e61b1c5493807fc5f47b8c97491c496bf7c5bcc127b6ccaed56f5588f3914c7b2be9289f49ee8705cb0ecb239d65189d68451efca10ad2b82467637d51cf058f885f58e7764c991d0af0d2ce2b091d10985b1eae65a2850fdb62c86886e28ae61c5ab2f1b52eebd9b959a9e718fbea495aed5c02e840c81da080d3ab1925b52a5984ef6b90f0be58457f610c096759cb484417bd9724a7ff0830bcf4e71578f43db03bac441f5c6662990659c12589da803a4280d0237cc8ec7db8bab740254718e167a4e6019f29f4555316d5cbbb8f606abcdbfa9a6dd52bd95aed66b6283a1c69c43a5cfd85f108de1849f9f")
                          :ephemeral-public-key (core/hex-str->big-int "58df71b5052041c56756bb0b2cde1bc521be00dd29a1708e3f0e38f6a95136f5cca5da0aebdcc86f9c4f3b463e2354f861e4b9cc4a72932c52dfc4e5414c959958f42280feb2e52f9e376175683821a2de53659b034158ed3992942b7b0821b21d4c7abb0b60129791cee9f9dcae0a65a521aca4b63a35967a34ffe54beee9a4a50d79512e3637f14acd559c1592f6129f2aa74fa6cff5d0b4528d8e4fb16a0ff350340b34739fa4193c491d4db5f2228d0afc9244efbd6a96023a7ff66c68e533b4a2115db6178073b786813a6ce10b3498ee5ea745b1d747e6a9be76e64884595046ec8d25a5462ff34aede7621390cf4532cd0670c933749d91cb3a6778a6")}
          responder-keys {:static-private-key (core/hex-str->big-int "ab754a991a5b75181569c1940c77c1266f04eac7f61a015739a140ac")
                          :static-public-key (core/hex-str->big-int "229e0f8ddf9bd4ccd6378a78dcefaca5415161cf98c4b2678032ffca0a09024656ec216235f04c6156abdf3834e2cbe337e257492d3f7eeabf79657e92f066e6d7d6e74737900c555fea4e3541934fc87527defa0203e0843dd40ae9d7bb921406bc42182397b8265d69ad0da0fbdd732326bd81028506a0cae05a2fa695169d04f3f5d2585e6b66dc2139ee8affc34ddaebbd3dc2729200fbd0959e4b2d6bab04bea415ca84709e59b5fed7a9c12e92e79127b00dc6d48324ab78ff80122320721236e1f4bde38a596b22db03a9deee1d9a9563515f042ab5f0f20e38d43a1cb825d9480571ed2b9dbed7ce16618afb984251231fbd39f73637ee037da9c9d6")
                          :ephemeral-private-key (core/hex-str->big-int "8b79aed2917c542fac1a36923d8810c577a95a16f9dbf7e8d5b8075b")
                          :ephemeral-public-key (core/hex-str->big-int "748eeaba1a4aac0ec8296556e3aab794a4f15e5122a727e989049107fca6982d4ea4073b9f4040d555c6dab4e4b8d6563bb37058182788905f916eb6e319ef3dead1c2ff5a0927f01c96152c9ee38aeb34f0d7119c21e890ba1c510de08d5af10bc8891d943285f85a6319bfd4480ad641fa6e25c862a244256ff3beb690c9e8756c11b6b3cc396d3a591c23bd5478c3c13413b1919a85932609f6e1270068e8370bbb3cd6dc8d69f55f95852c42bc9df8fb3cbd2f2b247509feeafe48cc1f7c01835f21147353d1fb3c0e650c0185b6d56d5429216cb8807210838294c5ae3a3da088323b5ef04a2706c88934f8ac38d3e6fd91f54ce70e96e5a1c92e39d15b")}
          Z :bottom
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "9bacb2846b6460f1cab12577c406d458df514fcd72eb3a35baaf43e54b10f65974b7ff58f0ca14f4db6d8662037c0d146fe3763b8a006ad1dbacbd5a97f3a826cdbe06f58a53a81401fd2f82150870a193af6ae2526888c823f13021d522102c0a04e4402728ade9535a3fd5368f063ed1d176b6c50a8f442b1b6b6f570b102efb616bbcbadb12fed6cf6ee3315e97d818faaa9806783f5cd8dc4f0968a049823177e42894de578c399fab552235f2fd5969c9e91e68d3cf15500dd175363321cd6bbc901b82553eb785b0866ffd23f88a2c6dbcccf7ade49d1b009350030e30c748cefccb2c4d0d3eb82b3484879276e20eea0a370bf777f78802ab02f87551")
                          :ephemeral-public-key (core/hex-str->big-int "1176be3eb8a021b973aedd3f1907c4e2fd919b6a3c6d0f8524e07e349e108593c7573fe10d13dc0c27423b75422703f98b5674f0fddaa8f59e25ffcb1bacd4e3b0d274a6bcb66344784fdee60ce0516d4813db904122807f0e68de298271f950fcd739ff5c1a62373d26fdda2e469e5a5a3609712c11229171063d9b0c6d7158cf181d8e587cf6624f4da81d228eaf6a6d6d71e125705569d9382f94a971abce97a27bf2169c2d87864e21da8b5b0813cffb53387a2c9ee6b5130695ef0e8cdde96c16ffcc83017eecffcb2eb6cefb40c81ee611f3e7ce6de03582686dd2da5c7c4d2dc3cd107d82392a273584ef2cd16e2e9aa654ea687d5d399cef13b03aaa")}
          responder-keys {:static-private-key (core/hex-str->big-int "d603d89d154a461b535cbb181fa03515282963c2fd8481d0253d7b57")
                          :static-public-key (core/hex-str->big-int "02f104d292ddba887bf24faa78e3060c52efb9d04fc7393727ba52506de9d4484ddbfd61a05f3c1f6c0555be48e9628d074763a7f8365342f7a3b75b1cf56cb383bf5a8122e1c3c2f4008e87ec1f08ba1d1dd92f1ef86e708a2620f73dc31e731f66b0c1d3229acb33cea6dc21f2b345b794a671293297d39874849bf0a821396cb2ddb0b686bc2936b64f6228230339ec80880dfcc14b1450403c2b89aa53887f1a511dac688c18e9a466b72332ec12c40a698a7ff62eeff7708f957fc23d04a0c5ca16b290cf35d4cde5f5275b74149f1704b5001b1bfe0386dcdfb9ce26b6c3f10862a3a14445e9a2d541ae73cb06230c6134c4f1adc8c826698f29c80546")
                          :ephemeral-private-key (core/hex-str->big-int "16631058d5339068a49718b514967581c130a3d12e4d6034797d4783")
                          :ephemeral-public-key (core/hex-str->big-int "1b32348811e71aab170a7652b071d8d0c0c4c2b48e59d38ca17281753c56b721ab38ed4523f2bede54f57d086b5f805fa46609e159db8aeaff127f57ed0fe7080c1eb0e4cabe1a221a8922ba85d025bb80a5d10f8f719a2d0d62e9660a6c4f07534275a0b5de32fe0edc82cc69515a4c2cb28b87b7c9e36ebd034d9fb41af20cff6ce686ee308c7642de39bb3d00cf80b475d5e8f4f8dc99bde3ee125b49289b8a466b83f531f024a626ff42929a94eb8f0aefd3062c30ace3b9d5849433b8182cf68e84a85160be553d163f8a3b92bcdace412593ec65c9c28f29194f4e475be6ff751978cff4305bb9e5dae7f88213ba1da725fd6ba5027289c92c55502ab2")}
          Z "297ebc1b28980883a8c8d149809c18075328b7758f93f800f765ed1744a7fb7e873dc836cc60cc4a20ee1199814f72366f94ac5b40581675ce4ccf5887ed2d49f1de0a39194d8b19b565250c5cdbbccd23f0ce8a50ffa7182fe8d28202db2801622c8df05eb43a3bbf35bd6ed7aab1f10e3d20968f69babf4f49cee04486b512c0b7b74f756cb1054ea34f2d4a6ed2720a332f31a2b037c288435e894d27271293ce5de5bd0728696fffe8367f10bc7e4a398444ebde2c9e356d42e24cad2d241d405dfb1932a3be30445717a7c6ac0fc188f9f579ccca7354a711a9a5728127097340cb1e5a9ec046a00330d000c3718042ee5aec68af3ec86c7c82c2036fa8"
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "9d80ecc7bf4296fd88ad149c7a2c0d16255eada3c2ffa778529e5a8453ff5dcf4eca370113a93bb69755bb3351a574c12d6f0f08ac1d62d66de6df2ef08106f6c90eff252d2ea2672cd101afb6eef9602b2f11c217a7b75b061dc42436b918d6254740483d8f1d4e90659196b2b6c6dee98ca27827c00dd0e6bdec8dc93d45152707788ecec7e56124637abc222c1c028af9f291843bc75fc6f77a977ca338656ca0c4871066248dec8c9f450fb927ade2719ef22bd0f39668b5b4edeac745f00e1031f5d252a76112bcf495e57b4553347ff22494341aae0754c5cbefe1fd43ea074b9594e1cef9acba8d802b36d5d7911143898d3202b5c2a9ff1abb61fc58")
                          :ephemeral-public-key (core/hex-str->big-int "9e67e2446e1d09487062cf8466de6c93ce18c4572517740ea98dc3fa2d30b61c78970f46085b502a4b7e05fb7e1a4eba46bef0db0d13236a569fbd65ee82164914c0e3226affc29040c2ebbabc0e84eaf0e688dda8a6826f7e9ea69a3569de8ad94a4a4b369a80d96cda3d7fe7e2ea550131a00d138c9ea9cca96b798834bc693f6a2704b800c5278a2445ce83489d0a58e9ad886f0416d1d905fd11d05a3af865362e14aa597841e28a43d396529fac36ed1f8704a43db9e0ef0619572fc7fddec7801c0765978e78cc26dadf2f9c8a3f366567bd976635c5e93def281c3a2ce3c934c67a1a8117597a9ab8b4cfc426e213acbebb8f852842e9dd753e341db6")}
          responder-keys {:static-private-key (core/hex-str->big-int "53c53f85ed69c350479a62f4366ba36383a6a76db4703f59f2db55b4")
                          :static-public-key (core/hex-str->big-int "549dee675152ec89eac73ed621156b914aeb7a3e3b3654500274bd09514c81d8ef73d8164edd0da968ab1614f79ddaae06da2846e9ceba3bc1fa6ace1aa68ef918521d664aff9fa6239b2863313fc176a7b495c3c4f21ee83f2aa82ed5332d48afcd9ee0f64641f048a843ff56e1f77df0c0e1d50f565729e7d31297a36510c9753e2f81cbcd862bfc3bb558367c1d1d1a8471ea4b79509228a374a65aac05d0bfd92737356d046be56381ebd26a51c578972631e31746f4a5aedb73d93d13df9fb2e4d680e76445ee299c3b50684a5fa37748f02d2d6525aa8e478e7e50f43e24df4478b3ccbd30a5432538b85f566b92924c66728225c7208d43d1d4127955")
                          :ephemeral-private-key (core/hex-str->big-int "ab1572688c922567b2d6a9d958681f3144a6d9d915771001e098822c")
                          :ephemeral-public-key (core/hex-str->big-int "4a357932b68630793fafcf3eb7352db5ef46df665d653a6eeaa4a14da5b28d12b3ab35b497e1630f5a5963b3bb6b132671ca5c618c44ae6e4c592dd14094ce34c717c35763066c8eb94520ef0f762b2cc3b989f204052de763568c299dd654a3ae8808c9b6d87e8fab0e66db558021829447318497dd886de9b625ab3081dba96851e6cc11f4efb9c2420702054cd50c8ac01e686bfca79afad703bd357d3f257cd856e5a36fe195f962f7fb47cdfe936ae7e380001c57b3859425f6efe5f5593ba6fc3c989e5a6a3ea585fea77b4afbc69d431a8114bb5e713fe5b70523495a2b6cbd356699b1a789a06d1d8ef1f26287bea01f824e7132f0183f2766d5f6ec")}
          Z :bottom
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "338c383dd8b6e07d93dedf6313ab8b9df6f31cae2439b2058ed5a6b67be41e4d2af0086f2ae74bae68c2fe0725dcc694d9f41e9da29250419520e3f0c21269950d3a4f0063dd66528f4f32bdc852b103fbf65256b57aabddb06e213a4a2faebb0338608583ad9b207f1afe80f4235484788d03360b9fb8dfc171ffbb7c512dcef67931d94f662d0f8435529871d41c85fc0e10e7c7f8c15832a982e7588e45c7d28ecc22d1dc792a7f2192a7287eae37855cae62dcce6e55587cd504e8c4274fcdb60c5987c950c83d23227d54a5c8f54352a97bf73b6b35c7a5c1bb35dbcc6dac436af9a03fa5f4e7b3048af144499140ac6f9916fe51d1d071d5c56e3d6ab4")
                          :ephemeral-public-key (core/hex-str->big-int "0f5ebf56f4f9ed2562ba419c90f30e22be789d6767d472bd87b763966a8e448bdf4dedaee5061b345e7504f2c7d6fb3b1fbf5fc9b9f331e65327a78674f032b24161a660ae5dcc884c2f0fbd9ec784f802af7907c333e5040eed82c42210e8be6c6832c728a320e59baaff6a9388337715cdaed989dda3455e2f541bb4ec9aac6c711c5f7d1746ab2dca7204c8ff723374d501a79252420dcd8e3cd564f7d328656aa340b7b3b704562557795cb26d3320cebd7a22205ef8ed301db35247413dcb68f8f3ed877d6990c310782a664868f9aa0dcc35ad86e777907fa6e18cc21e715a1d1dce83099f6891362bda957b2de80802038768ef8fd0673783257fdd01")}
          responder-keys {:static-private-key (core/hex-str->big-int "76f59933bdc61169f6e414ae9cfb227c5c8aa003b7ca914a44e24bfb")
                          :static-public-key (core/hex-str->big-int "3c60b8985c0307e3638a8e91636b31d3d739d3255187539a6bb4c9f99dd926c663b9bf2707183bacf3912e86200a9b62622b39d2db8826d8121a0a8f21c9ecebb919d85cf5f6e576f880df9d8f1ccc3e33b1561e0987f415e1176dd525d6a85079204bca63eee66a7ddcf6be6a755897179250bc1089fb5aab737c9e12b0878e8e6f01f95df0d493666ea58ad15faae6b09413c46cfe5a0e35cf3b663d6bb3373b5557418cba3858b5f44f58b4d2e2eacbf123fbbec48b9aed54d29f906162b55e7e8331aa28885a2710da7786754028338113935cadfcba0344e815f83c454d30a88a9fb17c8f8e39799c9b04a271ed9cf1dc917a8d139820ded33ed4a6426f")
                          :ephemeral-private-key (core/hex-str->big-int "169bc2df48ce2911d2e7bd9603b8b3aabe72664a021f2034fb959c29")
                          :ephemeral-public-key (core/hex-str->big-int "1d361987e61527e2ee2a1a3d2073d6fb3510994bc4bfe0742a0aabf83017f8c998f6bc60a1e2430bce440a9c62b0e2ec8d9ffc45bbe7d22bffdf750018c43f2234fe860ff0bdf923e4f3f6ee3eb3758fabdde0ac6a24ccfb956a01e2ee6bc603dfd55a02aa8e490036031b89241d675dc5773a2189a1c98ac628a0f8681568ba42f20d9ffe4d77d9a7f05128209bb32bb32be8903896009c4760771a5d209995de506ac3e9298e03bdaf7cdeac161551064ff29fa436edea8798230ee31d357cd34cadd585b7be781abe9bc01cf2d894ad5d96e71a1b71f5917e0a65eba2c506eda320261b9e2c139af0a475016bdccc5658423cf54186512e86d6a2d6cfb793")}
          Z "3148b462e868344a80efe0c31192578edf3485190072eea500ede01f28537df7536d9ba41473ef69043c2cf59fe66893788632981ec11123a57bf6e782dc295cb3584d19a2636fd669aad21cea9879b6a8705c9c2a71339e1e962a422b12c48c8ee33628171b40d6713d6bb99b51b5e60c5c70f0e66e2a16e84bb05de4403655c61480398ff37762ba831e6fa8a53d090cef2a3469da1fc1342c1c3257cdb5684b7deac2d5c2a5606c61cb9dfa0916bb5d7340db806de387b811642025f580efffb5605e8efecf9746ca49943d7cb2029295e2608f9aa2dd8514efa8d30d2f42788a5ee39dd85ff902718cbbc1a5ca5ce0d17337b363d29d40561e9b75b52fe1"
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (not= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "95521367f9d860cddafeab2b2150b59a1614d42635c2504e4353c34000aaa2761eda3d2147c8ef41713e3d55420f995901a8a9e5a481bc28e129a6e07b47701792c5f87b88e20d496ac56bc54548b0a5eb1b517ea3f659569cd2d594e590ae7f9cbaa4df4685e2debbcb8a8297eda92706f7620dfbcb955f185c58b576ca262a9a5f70acdfa04c9467c46da5e186b8edba60830f7ac7c9c5dc9ddfcc7bfc411cb92c8f4c878f5a61c24e5199e0e57e499a399d14c5b0e07fbb60dde3d805ae9c8f2e3691db75f54dda0d3fb2830a2d90feaff6cb27524a1ea2e2aaf364d79cac31244a92fb68d5006dc0f7254a5e10d8bf2cf6e18b6d959665f2f1a16319bdda")
                          :ephemeral-public-key (core/hex-str->big-int "4ebbd69a77c19d4bc2e88eca7deec7e9763cccae272ad2a3679df09d107c9e79655bee57e838f5370e697589d1cbdb411ce1c18b03e3526db127d40df9a12a107ca7b93cb09a1131a8e78a4eb4fea77e39ea5515540002fcff400f0cf6aa9cb77a737a5d5b7d29bc057e548a3bee8786379fec8152861549fefded87eb457caed4121a491401cb4145c78c3ea49bc2779f3e269999252dcee54830e850db6744b7a97ef4acdc62100bcba41be7e2ec0dfb7a12265e008bc9c66e39fda265fb474e34c5a43423fc44792a18e5269c1a00e7972905db7f382eea7a5e357bee4967501ca439a2ab66fb0d5a4a9d4dee7d37f9c05172796d8ff5880b7f628ccafc48")}
          responder-keys {:static-private-key (core/hex-str->big-int "91968da543506dedc888c79dd9b32231a1c637a9c1823f0df2cfb1c3")
                          :static-public-key (core/hex-str->big-int "3cdabfe8f4c3d0fe79da9873a3470a706eb4678d7cb31117b06f61cdf220b57892eddd3d2263660c663c0a4e00d430113f0b963a6b409a97840c7ed158cfba165a2c645c72941d40200ac06884750ba35096ea4e6a032d9f26881638448aa34c30dcc6c37f5825359f071b954969343371c6656d6ed640e22b438eb45fbeefeb9430107d598743aca2773d12da74fb38229e28959ee1da1da2bebb2a297b60976dad552da8d9aaa3306b3c5da20a1bb0eb22540e65dc2e16ec962434e4458285ce8caafe0baaa0a4a6929c865b5e2c156bd0481438c5e5144dc6113a8e69b10507791aeefae9820ad0ef8d622d77ddf941056c687aa43fa33f751337e6337686")
                          :ephemeral-private-key (core/hex-str->big-int "9b0b77fb7375044f6402aba74de4b5346bea39732822f7778460c1a7")
                          :ephemeral-public-key (core/hex-str->big-int "8c5b1f22d645642ef6797dadab6fa8c4eb3fa39ecc3ea2409861f84ad35b90aa5d2f234732ec28206524b26ad3475b1713ee8a6c549de91ce33464ed0366e548885bc9c5be7c18ab866debb5c96a7e08ade65d8130c2f38e0c173aa2642697487d3dff3aa32e207cb35cc29100a6ef6373ff7e86d61b11890643cd38885d58fbefb1da27af222c6b59a9644ab4c8bcba5fb721efb4fd256d4e709d6d938c7c9470446a03f4d23ca26c3d0f04c24573406b04693a5b023bb387ed9f69b1597aa046dd1fb38fe465cf77e13b70a9d7fd685e6409bef77c0282d8da627e63363eac2f85d8073e8570ebe2fbf46c520714e03d1586bc1f422df8836fac62df7e6791")}
          Z "49fe97c642b1945e18e2b45b73e988b9961441eaf299c0c53b61bb802acd70eed128e5a6ea13c849de74428672a1a42296816783d1ac479f802ff59ff735f3d1754d2b906742e58a7269dc191db49a8cd3e5c6711af53bb49ea8b8f9f2ba0c8d8ed81cf9c42f534820589c3dc104e621cc5ad9a4d2e0a3202cc649e7c50c2b2f8f7f4a53623d4268095a3c2e26754a700d135c82b87e1a473ce3ebe5132ba2291e9ad118d41b0e7f8aa0427ce127f29f539f14e70d1db5ad7a1b04b3e2e832dee4bdb28a800ebf9318174aea67aeab9e5d0216e8e3264361c1ab158f4d5ba2d521e8b564210dba8d9c747bb09b60929415d4396b6386ef49cc4e6934726adecc"
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    (let [initiator-keys {:static-public-key (core/hex-str->big-int "17acdfaab15ecee9bc48a022dcefd9ee9be03255ca15f9fd4a05ab4ad50064f70179d980744b37c58300af3f5cccc17f8bced22881bd2ae8ae6976e11028ca1989a93911cbee3241bd1f65cfcac0eba2cf686929ef34af0dbdc4d9354b87a3545838f378f301dda20298b72e35a9c1e4c8182cc414481ded1683c2afe84aba2178427e11f8f90cc5744939bff7344243719f6fe6fbb903233440f2570a642000cc2c139e09f05426056dd235b056863caef43ac646c17c0dacac3646e600aa1b3fb5feff59c5969e13b99185fbe5f61ce11608f0e88c64beed21f7f5a13fec7affbbeccb62952b9a4fa459f49eb45e0b8d864cee90963f325322229d2d26771a")
                          :ephemeral-public-key (core/hex-str->big-int "453670193a443562b87f6c777fd646dcc7994031946c8557fdc3bbd1fea5e5b757d3a17e80f6f808c4212c97ded91d0dae68a69957ccdf469b69fa7f3f02f171bfbbb2c5e27b0a85925c4aa077093e8c1bbf9025e81f52f1d30bcf8a1b57eea7b3fcd793aec75f124a78f7c2a1ec04b3bc4ee60dc5fedd6cb6c5c50b02a9c86662df61990ceb2c371daeae309811637485e85524af49095fb6976600a0fdf9187abe77f0ef24a9a1598b1b04c94ee254e38142d8f3bd746a13ae4c9b67407f8643c37549822dd2ad38b9190e11995d543786262a8e34f1383f9fd982c52734e71d9deabd2e191c56313b95001ec72478559f402eeb64673dd1c95424eb36b030")}
          responder-keys {:static-private-key (core/hex-str->big-int "2903baddb272d90cd016e9b16713e48c52a39e77d8990a30a5105cd1")
                          :static-public-key (core/hex-str->big-int "18e90c221100e7716b67b94a41ba9f2e359b17691c865a654aab51b7eef82244f2574fc63a42621ace30f5b27ba5e949e547a6c79f81cb8ebb3ca13de1a2e2013de8671a3c27c493a5965a5346c3fee4a19347fee0cc44087b7d359044413eba345826e9240bd33fdd4e67cd889659a5bd9ebf4e7c154a0e536daf6baca3e3a5040dd690aa1a0c0e492a7384b733268639b2becfd8e898dbc2c644b5778040bfef725fa149f1ed772886db024ff632af6211741981633ff46fe866a1960e3ee70e276bb0a0ffd206236aabc5977c87e3742390f4849b306f475211499427c98bb8f49b974c9bdf6971f3dae5c35d74398961bdb7290cf1a40bdeaf6a516c536b")
                          :ephemeral-private-key (core/hex-str->big-int "91bff834bab087ef596ce2f14f1f8443e719534ff0194426decd2d6e")
                          :ephemeral-public-key (core/hex-str->big-int "24f569af795994bc00afe359f8a299d4e997a2e02734b4839661a32f6411b16b9c72e10c97e2a81e70621cb5adb86b916cae65b3333a63c5117d0c7b13aa8f0c3582067466d9fba7e0138f289ff3371e4c666fdf300c3e3cdbf4e84e6513ac330a57320eb94b5bfdc6619de453efac63b5d471b3d409d7dfc90878235d6c61588dbd4adf8497fbbae7a292efdaf8ecab5a46cbb58a2cff852f33762bce636a34112169a423fa961d97813c23a5bddb7b9d54318cde04f0a32fc146637b1b2df53dd2cb1d4f5f39598aaee01cc203cd3d201cef41c59775c8624fdbc4c586771b1735684d8a57fa1400dffdf0d69119314a803a9d1493825d6c3af871d079c5b4")}
          Z "53c40ac8cfaba38ec42b4d6de7cd11c42f5fb6a5fa74b77d0d8952cd262819348838be2126f0b8720013dbfa2d76a0225337333ee34a64acef0a5a5c129c3225675bda49d79e3a0d39cf1dbe9a657d998f4fa8c00a57990a9c85ee862a54f017b44e46278ca5c7c07f25e5bc4941092d1094ecd83ad10fb56aea35244ce467d7bf35021e7426e07dbbf2d414a09d71f05007cd408db68713e935b6bda5f8bc5ca967c2b271bf112798a85821ddc9c1647998ddc74b7c20ffc88c03411478e0e1ccde8a2acc2f040e2c3309c66d709a853b193d3e8e5ad89b84bd7f0ac49db5f5c196b7f1791643a84dc1a18fc0adda947244b9c2b98ebdde1849f77a7c837686"
          result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
      (is (= Z result)))

    ;; WTF???
    ;; > Result = F (4 - IUT's Static private key changed-prikey validity)
    ; (let [initiator-keys {:static-public-key (core/hex-str->big-int "61b33a64ce9486f3205f11d4f508db7a993d342f28b714ac96166b878589a3dfc251d7760331e6a757c28e15e32085a427780c20edb06dd725a398f50d0340a7f7b2d9729234d9770da778f52deaceefc962c4bc609aa3f4d9b6a3ef4f85cfb6b779e9b69c80f7d58286fb408d24590e425059b15229ff1c98604f675e2e470c6da8b4ec2088f5a5072d9630f0305b09c247c6a05406d143f6bd46722d23669b349cd11d9213acf56c5a494db4df6cb44aee431b79ea20ddfacd158932f77ecc3f66b48f729c534daeb9ce26c81892169354dde315eb79a4c9a91ef21612bed874dc8152681baedf218375c4bc184069c67babb4a0f41b9f5fc640646d45f06c")
    ;                       :ephemeral-public-key (core/hex-str->big-int "3a000413cc65c6bd8acfab27d57916d18828e9f8fe3d001c3b17991846fa198b471b13f361e94cbca28640baaaf173544a1eadd736dfc64e893e107f259c33281c6d78c67dd041df0a822077aa0e570a40abfa96ad5fe1eeca4011f88fce36a9c1e065617ffc931875344bc6ca88302f084b3b81c1f0fdbbb840a5ebdc16300c2033862f5ee558bce4d7997132faa39ff3fb08cb82e86b8fb2b6995b4336bd87a06c23cbeee7fa07c386e215baee3610d09c1e60bdc451731600b61545ca67d98d425f23f098895711674d541774205715fd7c397d5fc04cdcec3935747fafc4f4cb55c291ec1175f8d91e2ba9a80feb299acbfc46811eb3a0d6ba2ee96f0dd6")}
    ;       responder-keys {:static-private-key (core/hex-str->big-int "9f27c5f8c47685d235c41824558619684932b5fd07b80249678b334c")
    ;                       :static-public-key (core/hex-str->big-int "192b58bd095823905320d1c1edb878cbf9f0c700d853cf65d2fe6ac6077e95cf773095aa7b5f5a8dbe2b53fe49e6f0574d43f9efbf9ab0809dc934e3a3b3d88f454d2905de916b0ec9adb797f49bdfd24da46dbf9546df02aab9ee227a200b50e6d470dbe8c71772b1be9ca2449d09545bb79c0b0d0b08937c712baf547e37a073ba9d5165f6416a335f824a4f40e04e6b671de7cbaccf9751e0d3243d3d5a577fdd4940d2ed4b2ef49f15b95e5b43c303532110dd1bed526f2ff305fff57a2fc6702057dcd418a4f80773058a76b52f73d1f1566debf69ab40c602c56ec69554536b39800d79ffe2b4e77cce22f3c12107363b3765881cedddae251beac2b30")
    ;                       :ephemeral-private-key (core/hex-str->big-int "aae5c28c6fd4ce18f47218e3f191de11cdf0684780221d4c13ce61da")
    ;                       :ephemeral-public-key (core/hex-str->big-int "5136720a518b21ce723218a48a0c4e1859162290d4ee81d99aaf9e6e17192dde6834ceedfce4c4ef8d4f761ef2415c47b31b9112cd0f4d43daf253aebd82d46f46a6520e8afe7b3e95fcc4e31421fc6951dcda53cda6c74f361ddcd51659aec09f942d1f048f2932d97db4c8a82bb3b108c46980926fd473a1a9db49d1dc84171467aafaef4940b20de0614007440f69a0d603d6a44cfb97e2b458b76d833d6e52254260d78e8d0ebdd7a0ae57673e9f33e6319f932650e3b1f8768eb74e41479282733ddb3b40cd74751c613773737abab956434b3806db896a046555102dc630041217c1724b5debefa6e481561760a1aaf7d65574def19316a06ee041e246")}
    ;       Z :bottom
    ;       result (core/agreement :mqv2 :resp domain-parameters initiator-keys responder-keys)]
    ;   (is (= Z result)))))

    ))

(run-tests)
